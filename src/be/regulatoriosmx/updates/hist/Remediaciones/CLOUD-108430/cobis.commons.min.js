(function(a,b){if(typeof define==="function"&&define.amd){define("cobis.commons",[],function(){return b(window.angular,window.kendo,window.kendo.jQuery)})}else{b(window.angular,window.kendo,window.kendo.jQuery,window.cobis)}}(this,function(l,n,d){if(!window.cobis){window.cobis={}}if(!window.cobis.userContext){window.cobis.userContext={}}q();var c=window.cobis,a=c.userContext,o=function(){var w=l.element(document.querySelector("html")).injector(),e=w.get("$log");return e},p,r,f,i;c.version="1.0.0.0";c.modules={CONTAINER:"container",DESIGNER:"designerModule",LOANS:"loans",BRANCH:"branch",CUSTOMER:"customer",INTTRADE:"inttrade",ADMCLIENTVIEWER:"adminclientviewer",CLIENTVIEWER:"clientviewer",BUSINESSRULES:"businessrules",INBOX:"inbox",FPM:"fpm",WORKFLOW:"workflow",MKCHK:"mkchk"};c.panelTypes={MENU:0,FAVORITES:1};try{c.containerScope=window.parent.cobis.containerScope||null}catch(s){c.containerScope=null}function t(e){return'"'+e+'"'}function q(){window.Date.prototype.getSerializedDate=function(){var z,A,w,e,x,B,y="";z=this.getFullYear();A=this.getMonth()+1;A=A<10?"0"+A:""+A;w=this.getDate();w=w<10?"0"+w:""+w;e=this.getHours();e=e<10?"0"+e:""+e;x=this.getMinutes();x=x<10?"0"+x:""+x;B=this.getSeconds();B=B<10?"0"+B:""+B;y=z+"-"+A+"-"+w+" "+e+":"+x+":"+B;return"/Date("+y+")/"};window.Date.prototype.fromSerializedDate=function(x){if(x===undefined||x===""){console.error("Serialized date is null or empty");return null}x=x.replace("/Date(","");x=x.replace(")/","");var y=x.split(" "),w=y[0].split("-"),A=y[1].split(":");this.setFullYear(parseInt(w[0],10));var z=parseInt(w[1]-1,10);var e=parseInt(w[2],10);this.setMonth(z,e);this.setHours(parseInt(A[0],10));this.setMinutes(parseInt(A[1],10));this.setSeconds(parseInt(A[2],10));return this}}function g(e){c.userContext.setValue(c.constant.DATE_FORMAT,e.dateFormat);c.userContext.setValue(c.constant.DATE_FORMAT_PLACEHOLDER,e.dateFormatPlaceholder);c.userContext.setValue(c.constant.CURRENCY_SYMBOL,e.currencySymbol);c.userContext.setValue(c.constant.CURRENCY_GROUP_SEPARATOR,e.currencyGroupSeparator);c.userContext.setValue(c.constant.CURRENCY_DECIMAL_SEPARATOR,e.currencyDecimalSeparator);c.userContext.setValue(c.constant.CURRENCY_DECIMAL_PLACES,e.currencyDecimalPlaces);window.sessionStorage.setItem(c.constant.DATE_FORMAT,t(e.dateFormat));window.sessionStorage.setItem(c.constant.DATE_FORMAT_PLACEHOLDER,t(e.dateFormatPlaceholder));window.sessionStorage.setItem(c.constant.CURRENCY_SYMBOL,t(e.currencySymbol));window.sessionStorage.setItem(c.constant.CURRENCY_GROUP_SEPARATOR,t(e.currencyGroupSeparator));window.sessionStorage.setItem(c.constant.CURRENCY_DECIMAL_SEPARATOR,t(e.currencyDecimalSeparator));window.sessionStorage.setItem(c.constant.CURRENCY_DECIMAL_PLACES,e.currencyDecimalPlaces)}function u(y,e,x){var w=y.path();e.$on("$locationChangeSuccess",function(){e.actualLocation=y.path()});e.$on("$locationChangeStart",function(z,B,A){if(c.userContext.getValue("flagBackButton")===true&&B.indexOf("login.html")>0){c.userContext.setValue("flagBackButton",false);window.top.location.href=c.constant.HOME_PAGE_URL}});e.$watch(function(){return y.path()},function(A,z){if(z!==w&&e.actualLocation===A&&w!=""){window.top.location.href=c.constant.HOME_PAGE_URL}else{if(A.indexOf("container.html")>0){c.userContext.setValue("flagBackButton",true)}else{if(A.indexOf("login.html")>0){c.userContext.setValue("flagBackButton",false)}}}});if(p){e.flagFromCENToDesigner=true}if(x.getGlobalization(c.constant.DATE_FORMAT)){n.cultures.current.calendar.patterns.d=x.getGlobalization(c.constant.DATE_FORMAT)}else{n.cultures.current.calendar.patterns.d="yyyy/MM/dd"}if(x.getGlobalization(c.constant.CURRENCY_SYMBOL)){n.cultures.current.numberFormat.currency.symbol=x.getGlobalization(c.constant.CURRENCY_SYMBOL)}else{n.cultures.current.numberFormat.currency.symbol="$"}if(x.getGlobalization(c.constant.CURRENCY_GROUP_SEPARATOR)){n.cultures.current.numberFormat[","]=x.getGlobalization(c.constant.CURRENCY_GROUP_SEPARATOR);n.cultures.current.numberFormat.currency[","]=x.getGlobalization(c.constant.CURRENCY_GROUP_SEPARATOR);n.cultures.current.numberFormat.percent[","]=x.getGlobalization(c.constant.CURRENCY_GROUP_SEPARATOR)}else{n.cultures.current.numberFormat[","]=".";n.cultures.current.numberFormat.currency[","]=".";n.cultures.current.numberFormat.percent[","]="."}if(x.getGlobalization(c.constant.CURRENCY_DECIMAL_SEPARATOR)){n.cultures.current.numberFormat["."]=x.getGlobalization(c.constant.CURRENCY_DECIMAL_SEPARATOR);n.cultures.current.numberFormat.currency["."]=x.getGlobalization(c.constant.CURRENCY_DECIMAL_SEPARATOR);n.cultures.current.numberFormat.percent["."]=x.getGlobalization(c.constant.CURRENCY_DECIMAL_SEPARATOR)}else{n.cultures.current.numberFormat["."]=",";n.cultures.current.numberFormat.currency["."]=",";n.cultures.current.numberFormat.percent["."]=","}if(x.getGlobalization(c.constant.CURRENCY_DECIMAL_PLACES)){n.cultures.current.numberFormat.decimals=x.getGlobalization(c.constant.CURRENCY_DECIMAL_PLACES);n.cultures.current.numberFormat.currency.decimals=x.getGlobalization(c.constant.CURRENCY_DECIMAL_PLACES);n.cultures.current.numberFormat.percent.decimals=x.getGlobalization(c.constant.CURRENCY_DECIMAL_PLACES)}else{n.cultures.current.numberFormat.decimals=2;n.cultures.current.numberFormat.currency.decimals=2;n.cultures.current.numberFormat.percent.decimals=2}}function j(){var e=new XMLHttpRequest();e.onreadystatechange=function(){var w={};w.messageType="isAliveCheck";if(this.readyState==4){if(this.status==200&&this.response.indexOf('"result":true')>0){w.isAlive=true}else{w.isAlive=false}parent.postMessage(w,"*")}};e.open("GET","/CTSProxy/services/resources/cobis/web/security/validateUserSession",true);e.send()}c.utils={getGuid:function(){var w=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(y){var x=((w+Math.random()*16)%16)|0;w=Math.floor(w/16);return(y==="x"?x:(x&3|8)).toString(16)});return e},isRunOnLiferay:function(){return l.isDefined(window.Liferay)?true:false},existsContextVariables:function(){return window.sessionStorage.getItem(c.constant.DATE_FORMAT)!=null?true:false}};window.addEventListener("message",function(e){if(e.data==="isSessionContainerAlive"){j()}});c.createModule=function(e,x,D){var w,A,C,B,E,z;try{w=l.module(e);if(e===c.modules.CONTAINER&&D){w.config(["$translateProvider","$translatePartialLoaderProvider","$locationProvider",function(H,G,F){w.translateProvider=H;if(!c.utils.isRunOnLiferay()){z=c.userContext.getValue(c.constant.CULTURE);if(D!==null){D.forEach(function(I){G.addPart(I)})}w.translateProvider.useLoader("$translatePartialLoader",{urlTemplate:"${contextPath}/cobis/web/assets/languages/{part}-{lang}.js"});z=c.userContext.getValue(c.constant.CULTURE);if(z){w.translateProvider.preferredLanguage(z)}else{w.translateProvider.preferredLanguage("es")}}w.translateProvider.useMissingTranslationHandler("cobisMissingTranslationHandler");w.translateProvider.useLocalStorage()}])}}catch(y){A=["ngRoute","kendo.directives","pascalprecht.translate"];if(x){for(C=0;C<x.length;C+=1){E=false;for(B=0;B<A.length;B+=1){if(x[C]===A[B]){E=true;break}}if(!E){A.push(x[C])}}}w=l.module(e,A);w.service(c.modules.CONTAINER+".preferencesService",["$translate","$q","$http",function(H,G,I){var F={};F.switchCulture=function(J){H.use(J)};F.loadGlobalization=function(){var K=G.defer(),J;I({url:"${contextPath}/resources/cobis/web/container/getGlobalizationInformation",method:"GET",params:{returnOnlyData:false}}).success(function(O,L,P,M){if(O&&O.data){if(!((window.sessionStorage.getItem(c.constant.RUNNINGONCEN)==="yes")||(window.sessionStorage.getItem(c.constant.RUNNINGONCEN)==='"yes"'))){c.userContext.setValue(c.constant.CULTURE,O.data.i18n.defaultCultureId);c.userContext.setValue(c.constant.DATE_FORMAT,O.data.l10n.dateFormat);c.userContext.setValue(c.constant.DATE_FORMAT_PLACEHOLDER,O.data.l10n.dateFormatPlaceholder);c.userContext.setValue(c.constant.CURRENCY_SYMBOL,O.data.l10n.currency.symbol);c.userContext.setValue(c.constant.CURRENCY_GROUP_SEPARATOR,O.data.l10n.currency.groupSeparator);c.userContext.setValue(c.constant.CURRENCY_DECIMAL_SEPARATOR,O.data.l10n.currency.decimalSeparator);c.userContext.setValue(c.constant.CURRENCY_DECIMAL_PLACES,O.data.l10n.currency.decimalPlaces)}c.userContext.setValue(c.constant.CULTURES,O.data.i18n.cultures);if(O.data.l10n.timeZoneOffsetEnabled){c.userContext.setValue(c.constant.TIME_ZONE_RAW_OFFSET,O.data.l10n.timeZoneRawOffset)}else{c.userContext.removeValue(c.constant.TIME_ZONE_RAW_OFFSET)}J=O.data.attributes.clientCtx;if(l.isDefined(J)){for(var N in J){c.userContext.setValue(N,J[N])}}}K.resolve(O)}).error(function(N,L,O,M){K.reject(null)});return K.promise};F.loadLiferayGlobalization=function(){var J=G.defer();I({url:restServiceUrl+"/g11n/config",method:"GET",params:{returnOnlyData:true}}).success(function(K){J.resolve(K)}).error(function(M,K,N,L){console.log("Could not load G11n data from service /g11n/config");J.reject()});return J.promise};F.getGlobalization=function(J){var K=c.userContext.getValue(J);return K};F.getUserPreferences=function(){var J=c.userContext.getValue(c.constant.USER_NAME),K=G.defer();I({url:"${contextPath}/resources/cobis/web/container/preferences/getUserPreferences",method:"PUT",data:J}).success(function(N,L,O,M){K.resolve(N)}).error(function(N,L,O,M){K.reject(null)});return K.promise};F.saveUserPreferences=function(){var J=c.userContext.getValue(c.constant.USER_NAME),M=c.userContext.getValue(c.constant.CULTURE),K=c.userContext.getValue(c.constant.USER_AUTO_HIDE_MENU),L=G.defer();I({url:"${contextPath}/resources/cobis/web/container/preferences/saveUserPreferences",method:"PUT",data:[J,M,K,"N"]}).success(function(P,N,Q,O){L.resolve(P)}).error(function(P,N,Q,O){L.reject(null)});return L.promise};F.getConfigurationInfo=function(){var J=G.defer();I({url:"${contextPath}/resources/cobis/web/container/getConfigurationInfo",method:"GET",data:null}).success(function(M,K,N,L){J.resolve(M)}).error(function(M,K,N,L){J.reject(null)});return J.promise};F.setClientLocalizationInformation=function(){v()};return F}]);w.config(["$translateProvider","$translatePartialLoaderProvider","$locationProvider",function(L,I,G){var F,K,J,H=c.utils.isRunOnLiferay()?"/o/external-js-libs-1.0.0":"${contextPath}/cobis/web/scripts/lib";if(c.utils.isRunOnLiferay()){L.useSanitizeValueStrategy(null);w.translateProvider=L;F=window.Liferay.ThemeDisplay.getBCP47LanguageId()}else{w.translateProvider=L;if(D!=null){D.forEach(function(M){if(!I.isPartAvailable(M)){I.addPart(M)}})}else{if(!I.isPartAvailable(e)){I.addPart(e)}}w.translateProvider.useLoader("$translatePartialLoader",{urlTemplate:"${contextPath}/cobis/web/assets/languages/{part}-{lang}.js"});w.translateProvider.useMissingTranslationHandler("cobisMissingTranslationHandler");F=c.userContext.getValue(c.constant.CULTURE)}J=c.utils.isRunOnLiferay()?"kendo.messages-":"kendo.messages.";if(F){K=F.substring(0,2);if(!c.utils.isRunOnLiferay()){w.translateProvider.preferredLanguage(F)}d.getScript(H+"/kendo/cultures/kendo.culture."+K+".min.js",function(){});d.getScript(H+"/kendo/lang/"+J+K+".js",function(){});n.culture(K)}else{if(!c.utils.isRunOnLiferay()){w.translateProvider.preferredLanguage("es")}d.getScript(H+"/kendo/cultures/kendo.culture.es.min.js",function(){});d.getScript(H+"/kendo/lang/"+J+"es.js",function(){});n.culture("es")}w.translateProvider.useLocalStorage()}]).factory("PartLoadingErrorHandler",["$q",function(F){return function(G,H){console.log('La seccion "'+G+"/"+H+'" no fue cargada.');return F.when({})}}]);w.run([c.modules.CONTAINER+".preferencesService","$rootScope","$translate","$route","$location",function(I,G,H,K,J){if(c.utils.isRunOnLiferay()&&!c.utils.existsContextVariables()){var F={currencyDecimalPlaces:"2",currencyDecimalSeparator:".",currencyGroupSeparator:",",currencySymbol:"$",dateFormat:"dd/MM/yyyy",dateFormatPlaceholder:"dd/mm/aaaa"};I.loadLiferayGlobalization().then(function(L){g(L);u(J,G,I)},function(L){console.log("Init with default values...");console.error(L);g(F);u(J,G,I)})}else{u(J,G,I)}}]);w.factory("asyncLoader",["$q","$timeout",function(F,G){if(c.utils.isRunOnLiferay()){return function(K){var J=F.defer(),I,H;if(window[K.moduleId]!==null){H=window.Liferay.ThemeDisplay.getLanguageId()?window.Liferay.ThemeDisplay.getLanguageId():"es";d.getScript("/o/"+K.contextPath+"/languages/"+K.moduleId+"-"+H+".js",function(){I=d.extend({},window[K.moduleId+"_"+H.toUpperCase()]);G(function(){J.resolve(I)},2000)})}return J.promise}}else{return function(I){var H=F.defer();H.resolve(true);return H.promise}}}]);w.factory("cobisMissingTranslationHandler",["$log",function(F){return function(G,H){}}]);if(p&&i){w.factory("$exceptionHandler",function(){return function(F,G){window.external.LogAngularManagedError(F.message,G,F.stack)}})}w.config(["$logProvider",function(F){F.debugEnabled(false)}])}return w};c.constant={USER_NAME:"UserName",USER_FULLNAME:"Fullname",USER_ROLE:"userRole",USER_OFFICE:"userOffice",USER_FILIAL:"userFilial",USER_AUTO_HIDE_MENU:"userAutoHideMenu",CULTURES:"cultures",CULTURE:"culture",DATE_FORMAT:"dateFormat",DATE_FORMAT_PLACEHOLDER:"dateFormatPlaceholder",CURRENCY_SYMBOL:"currencySymbol",CURRENCY_GROUP_SEPARATOR:"currencyGroupSeparator",CURRENCY_DECIMAL_SEPARATOR:"currencyDecimalSeparator",CURRENCY_DECIMAL_PLACES:"currencyDecimalPlaces",LIST_FILES_MENU:"listFilesNamesMenu",TYPEMESSAGE:{ERROR:0,INFO:1,SUCCESS:2,CONFIRM:3},RUNNINGONCEN:"runningOnCen",LOGJSERRORONCEN:"logJsErrorOnCen",DEBUGGINGMODE:"debuggingMode",MODAL_MESSAGES_DELAY_TIME:400,CURRENT_LOG_LEVEL:"logLevel",DEFAULT_DELAY_TIME_SUCCESS_NOTIFICATION:10000,TIME_ZONE_RAW_OFFSET:"timeZoneRawOffset",CLIENT_LOCALIZATION_INFORMATION_SYNC:"clientLocalizationInformationSync",HOME_PAGE_URL:c.utils.isRunOnLiferay()?"":"${contextPath}/cobis/web/views/commons/container.html",USER_BLOCKED_MESSAGE:"K",TERMINAL_VALIDATION:"terminalValidation",DEVICE_SERVER_URL:"deviceServerUrl"};c.closingReason={NEW_TAB:"loadNewTab",REMOVE_TAB:"removeTab",LOGOUT:"logout",BROWSER:"browser",SESSION_TIMEOUT:"sessionTimeout"};c.translate=function(x,w){var y=c.utils.isRunOnLiferay()?l.element("#cobis-portlet-content").injector():l.element(document).injector(),e=y.get("$filter");return e("translate")(x,w)};c.getMessageManager=function(){var x=c.utils.isRunOnLiferay()?l.element("#cobis-portlet-content").injector():l.element(document.querySelector("html")).injector(),e=x.get("$filter"),w=x.get("cobisMessage");return w};a.setValue=function(e,w){window.sessionStorage.setItem(e,JSON.stringify(w))};a.getValue=function(e){return JSON.parse(window.sessionStorage.getItem(e))};a.removeValue=function(e){window.sessionStorage.removeItem(e)};a.clear=function(){var e=window.sessionStorage.getItem(c.constant.DEBUGGINGMODE);window.sessionStorage.clear();window.sessionStorage.setItem(c.constant.DEBUGGINGMODE,e)};c.CobisException=(function(){function e(w){this.messages=w}return e}());r=c.userContext.getValue(c.constant.RUNNINGONCEN);p=r==='"yes"'||r==="yes"?true:false;f=c.userContext.getValue(c.constant.LOGJSERRORONCEN);i=f==='"true"'||f==="true"?true:false;c.logging={logLevel:{INFO:"INFO",WARN:"WARN",DEBUG:"DEBUG"},enable:function(e){c.userContext.setValue(c.constant.CURRENT_LOG_LEVEL,e)},disable:function(){c.userContext.removeValue(c.constant.CURRENT_LOG_LEVEL)},getCurrentLogLevel:function(){var e=c.userContext.getValue(c.constant.CURRENT_LOG_LEVEL);return l.isUndefined(e)||e===null||e===""?undefined:e},getFormattedMessage:function(B,z,y){var w=new Date(),e="["+B+"]",x="["+w.toLocaleString()+"]",A="["+z+"]";return e+" "+x+" "+A+" "+y},getLoggerManager:function(e){if(p){return{log:function(x){if(i){var w=c.logging.getCurrentLogLevel();if(w!==undefined&&w!==c.logging.logLevel.WARN){window.external.LogMessage("LOG",e,x)}}},info:function(x){if(i){var w=c.logging.getCurrentLogLevel();if(w!==undefined&&w!==c.logging.logLevel.WARN){window.external.LogMessage("INFO",e,x)}}},warn:function(x){if(i){var w=c.logging.getCurrentLogLevel();if(w!==undefined&&(w===c.logging.logLevel.WARN||w===c.logging.logLevel.DEBUG)){window.external.LogMessage("WARN",e,x)}}},debug:function(x){if(i){var w=c.logging.getCurrentLogLevel();if(w!==undefined&&w===c.logging.logLevel.DEBUG){window.external.LogMessage("DEBUG",e,x)}}},error:function(x){if(i){var w=c.logging.getCurrentLogLevel();if(w!==undefined){window.external.LogMessage("ERROR",e,x)}}}}}else{return{log:function(x){var w=c.logging.getCurrentLogLevel();if(w!==undefined&&w!==c.logging.logLevel.WARN){console.log(c.logging.getFormattedMessage("LOG",e,x))}},info:function(x){var w=c.logging.getCurrentLogLevel();if(w!==undefined&&w!==c.logging.logLevel.WARN){console.info(c.logging.getFormattedMessage("INFO",e,x))}},warn:function(x){var w=c.logging.getCurrentLogLevel();if(w!==undefined&&(w===c.logging.logLevel.WARN||w===c.logging.logLevel.DEBUG)){console.warn(c.logging.getFormattedMessage("WARN",e,x))}},debug:function(x){var w=c.logging.getCurrentLogLevel();if(w!==undefined&&w===c.logging.logLevel.DEBUG){console.debug(c.logging.getFormattedMessage("DEBUG",e,x))}},error:function(x){var w=c.logging.getCurrentLogLevel();if(w!==undefined){console.error(c.logging.getFormattedMessage("ERROR",e,x))}}}}}};function b(C,A,D,w){var B=d.Deferred(),y,z,x,e;C=c.messageUtil.sanitize(C);A=A||c.translate("COMMONS.CONTAINER.TIT_MESSAGE_WINDOW");if(typeof Cordova!=="undefined"){navigator.notification.alert(C,function(E){B.resolve()},A,D)}else{y=d('<div class="cb-has-controlbar cb-messagebox" style="padding-left: 60px; padding-top: 28px" />').kendoWindow({actions:[],modal:true,title:A,width:"300px",resizable:false}).getKendoWindow();e=Math.floor(Math.random()*1000)+1;D=D||c.translate("COMMONS.BUTTONS.CMD_OK");z="";switch(w){case 0:z="glyphicon glyphicon-remove-circle text-info";break;case 1:z="glyphicon glyphicon-info-sign text-info";break;case 2:z="glyphicon glyphicon-ok-circle text-info";break}x='<span class="'+z+'" style="font-size: 32px; position: absolute; margin-left: -40px; margin-top: 20px;"></span>';y.content(x+C+'<div class="cb-form-controlbar"><button id="messages-alert-close-'+e+'" class="btn btn-primary">'+D+"</button></div>");if(p===true){setTimeout(function(){y.center().open()},c.constant.MODAL_MESSAGES_DELAY_TIME)}else{y.center().open()}setTimeout(function(){if(l.isDefined(d("#messages-alert-close-"+e)[0])){d("#messages-alert-close-"+e)[0].focus()}},1000);d("#messages-alert-close-"+e).on("click",function(){B.resolve();y.destroy()})}return B.promise()}function m(x){var e="(?:[^\"'>]|\"[^\"]*\"|'[^']*')*";var w=new RegExp("<(?:!--(?:(?:-*[^->])*--+|-?)|script\\b"+e+">[\\s\\S]*?<\/script\\s*|style\\b"+e+">[\\s\\S]*?</style\\s*|/?[a-z]"+e+")>","gi");var y;do{y=x;x=x.replace(w,"")}while(x!==y);return x.replace(/</g,"&lt;")}function h(x){var w=[{originalChar:"'",replaceChar:'"'}],e=x;w.forEach(function(y){e=e.replace(new RegExp(y.originalChar,"g"),y.replaceChar)});return e}c.messageUtil={sanitize:function(e){if(e!==undefined&&e!==null){e=h(e);e=m(e)}return e}};c.showMessageWindow={alert:function(w,x,e){return b(w,x,e,c.constant.TYPEMESSAGE.INFO)},alertError:function(w,x,e){x=x||(c.translate("COMMONS.MESSAGES.MSG_ERROR")+"!");return b(w,x,e,c.constant.TYPEMESSAGE.ERROR)},alertInfo:function(w,x,e){x=x||(c.translate("COMMONS.MESSAGES.MSG_INFO")+"!");return b(w,x,e,c.constant.TYPEMESSAGE.INFO)},alertSuccess:function(w,x,e){x=x||(c.translate("COMMONS.MESSAGES.MSG_SUCCES")+"!");return b(w,x,e,c.constant.TYPEMESSAGE.SUCCESS)},prompt:function(A,C,w,B){var e=d.Deferred(),x,z,y;w=w||"";B=B||[c.translate("COMMONS.BUTTONS.CMD_CANCEL"),c.translate("COMMONS.BUTTONS.CMD_OK")];C=C||c.translate("COMMONS.CONTAINER.TIT_MESSAGE_WINDOW");if(typeof Cordova!=="undefined"){navigator.notification.prompt(A,function(D){e.resolve({input:D.input1,buttonIndex:D.buttonIndex})},C,B,w)}else{x=d('<div class="cb-has-controlbar" />').kendoWindow({actions:[],modal:true,title:C,width:"300px",resizable:false,activate:function(){d("#messages-prompt-input-"+y).select()}}).getKendoWindow();y=Math.floor(Math.random()*1000)+1;z=[];d.each(B,function(E){var D=B.length===E+1?"btn-primary":"btn-default";z.push('<button class="messages-prompt-close-'+y+" btn "+D+'">'+this+"</button>")});x.content('<div class="form-group" style="margin:0;"><div class="control-label">'+A+'</div><input id="messages-prompt-input-'+y+'" type="text" class="form-control" value="'+w+'" /></div><div class="cb-form-controlbar btn-toolbar">'+z.join("")+"</div>");if(p===true){setTimeout(function(){x.center().open()},c.constant.MODAL_MESSAGES_DELAY_TIME)}else{x.center().open()}d(".messages-prompt-close-"+y).on("click",function(){e.resolve({input:d("#messages-prompt-input-"+y).val(),buttonIndex:d(this).index()});x.destroy()})}return e.promise()},confirm:function(A,C,B){var w=d.Deferred(),x,e,z,y;B=B||[c.translate("COMMONS.BUTTONS.CMD_CANCEL"),c.translate("COMMONS.BUTTONS.CMD_OK")];C=C||c.translate("COMMONS.CONTAINER.TIT_MESSAGE_WINDOW");if(typeof Cordova!=="undefined"){navigator.notification.confirm(A,function(D){w.resolve(D)},C,B)}else{x=d('<div class="cb-has-controlbar" style="padding-left: 60px;" />').kendoWindow({actions:[],modal:true,title:C,width:"300px",resizable:false}).getKendoWindow();z=Math.floor(Math.random()*1000)+1;y=[];d.each(B,function(D){e=B.length==D+1?"btn-primary":"btn-default";y.push('<button class="messages-prompt-close-'+z+" btn "+e+'">'+this+"</button>")});x.content('<span class="glyphicon glyphicon-info-sign text-info" style="font-size: 32px; position: absolute; margin-left: -40px; margin-top: 20px;"></span>'+A+'<div class="cb-form-controlbar btn-toolbar">'+y.join("")+"</div>");if(p===true){setTimeout(function(){x.center().open()},c.constant.MODAL_MESSAGES_DELAY_TIME)}else{x.center().open()}d(".messages-prompt-close-"+z).on("click",function(){w.resolve({buttonIndex:d(this).index()});x.destroy()})}return w.promise()},loading:function(e,x){var w="";if(l.isDefined(x)){if(x=="blank"){w=" cb-view-loading-preload"}else{if(x=="none"){w=" loading-section-div ng-scope"}else{w=""}}}if(e){d("div[id^='loader'].loading-div").show();d("body .cb-view-loading").remove();d("body").append('<div class="cb-view-loading'+w+'"><div class="cb-view-loading-icon"></div></div>')}else{d("div[id^='loader'].loading-div").hide();d("body .cb-view-loading").fadeOut(function(){d(this).remove()})}}};c.container={menu:{hide:function(){c.containerScope.currentNavOption=null;c.containerScope.$apply()},show:function(e){if(e==undefined||e==null){e=c.panelTypes.MENU}c.containerScope.currentNavOption=c.containerScope.navigation.navOptions[e];c.containerScope.$apply()}},lockScreen:function(){c.containerScope.lockScreen.setVisible()},tabs:{stopTabLoading:function(e){e.loading=false},setCurrentTab:function(e,w,z){var A=l.element(document).injector(),x=A.get("$sce"),D=false,y,C,B;if(typeof e=="object"){y=l.copy(e);if(z){y.url=y.url.replace("token","token="+z)}if(w||c.containerScope.shellTabs.length==0){c.containerScope.shellTabs.push(y)}else{if(!w){if(c.containerScope.currentTab.onTabClosing){D=true;B=this;c.containerScope.currentTab.onTabClosing(c.closingReason.NEW_TAB).then(function(){C=B.getCurrentTabIndex();if(C>=0){c.containerScope.shellTabs[C]=y;y.url=x.getTrustedResourceUrl(y.url);y.loading=true;y.guid=c.utils.getGuid();c.containerScope.currentTab=y;c.containerScope.$apply()}})}else{C=this.getCurrentTabIndex();if(C>=0){c.containerScope.shellTabs[C]=y}}}}}else{D=true;y=c.containerScope.shellTabs[e];c.containerScope.currentTab=y}if(!D){y.url=x.getTrustedResourceUrl(y.url);if(y.url.indexOf(".html")>-1){y.loading=true}y.guid=c.utils.getGuid();c.containerScope.currentTab=y}},removeTab:function(w,e,y){if(y==c.closingReason.LOGOUT&&w!=this.getCurrentTabIndex()){this.setCurrentTab(w)}if(c.containerScope.currentTab.onTabClosing){var x=this;c.containerScope.currentTab.onTabClosing(y||c.closingReason.REMOVE_TAB).then(function(){if(c.containerScope.shellTabs.length>1){if(w>0&&w==x.getCurrentTabIndex()){x.setCurrentTab(w-1)}else{if(w==0&&w==x.getCurrentTabIndex()){x.setCurrentTab(w+1)}}}c.containerScope.shellTabs.splice(w,1);c.containerScope.$apply();if(y==c.closingReason.LOGOUT){c.containerScope.onSelectionLogout()}})}else{if(c.containerScope.shellTabs.length>1){if(w>0&&w==this.getCurrentTabIndex()){this.setCurrentTab(w-1)}else{if(w==0&&w==this.getCurrentTabIndex()){this.setCurrentTab(w+1)}}}c.containerScope.shellTabs.splice(w,1);if(y==c.closingReason.LOGOUT){c.containerScope.onSelectionLogout()}}if(e===undefined||!e){setTimeout(function(){c.containerScope.$apply()},100)}},removeTabObject:function(w,x){var e;c.containerScope.shellTabs.forEach(function(z,y){if(w.guid===z.guid){e=y}});if(e!=undefined&&w.isFromDesigner!==undefined&&w.isFromDesigner!=false){c.container.tabs.removeTab(e,false,x)}else{if(e!=undefined){c.container.tabs.removeTab(e,true,x)}}},getCurrentTabIndex:function(){var e=-1,x,w;for(x=0,w=c.containerScope.shellTabs.length;x<w;x=x+1){if(c.containerScope.shellTabs[x]==c.containerScope.currentTab){e=x;return e}}return e},getCurrentTab:function(){if(l.isDefined(c.containerScope)&&c.containerScope!=null){return c.containerScope.currentTab}else{return null}},openNewTab:function(A,e,z,x,y){var w={id:A,url:e,name:z,isTranslated:x,parameters:y};this.openTab(w)},openTab:function(w){var e,x;if(w.parameters!==undefined){e=w.url+"?";for(x in w.parameters){if(w.parameters.hasOwnProperty(x)){e+=x+"="+w.parameters[x]+"&"}}w.url=e}c.containerScope.multipage.setCurrentTab(w,true);c.containerScope.$apply()},openCENTab:function(w,x){if(p){x.fromCEW="yes";window.external.LoadPageById(w,JSON.stringify(x),true)}else{var e=c.translate("COMMONS.TABS_SECTION.TIT_CEN_TAB_NOT_ALLOWED"),y=c.translate("COMMONS.TABS_SECTION.MSG_CEN_TAB_NOT_ALLOWED");c.showMessageWindow.alertError(y,e)}},changeCurrentTab:function(z,e,y,x){var w={id:z,url:e,name:y,isTranslated:x};c.containerScope.multipage.setCurrentTab(w,false);c.containerScope.$apply()},setCurrentTabByIndex:function(e){c.containerScope.multipage.setCurrentTab(e,false);c.containerScope.$apply()}}};if(p&&i){window.onerror=function(x,w,e){window.external.LogBaseError(x,w,e);return true}}function v(){var e={dateFormat:c.userContext.getValue(c.constant.DATE_FORMAT),dateFormatPlaceholder:c.userContext.getValue(c.constant.DATE_FORMAT_PLACEHOLDER),currency:{symbol:c.userContext.getValue(c.constant.CURRENCY_SYMBOL),groupSeparator:c.userContext.getValue(c.constant.CURRENCY_GROUP_SEPARATOR),decimalSeparator:c.userContext.getValue(c.constant.CURRENCY_DECIMAL_SEPARATOR),decimalPlaces:c.userContext.getValue(c.constant.CURRENCY_DECIMAL_PLACES)}};d.ajax({url:"${contextPath}/resources/cobis/web/container/setClientLocalizationInformation",headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify(e),type:"POST",dataType:"json"}).then(function(w){c.userContext.setValue(c.constant.CLIENT_LOCALIZATION_INFORMATION_SYNC,true)},function(w){c.userContext.setValue(c.constant.CLIENT_LOCALIZATION_INFORMATION_SYNC,null)})}var k=c.userContext.getValue(c.constant.CLIENT_LOCALIZATION_INFORMATION_SYNC);if(k===null&&c.userContext.getValue(c.constant.USER_NAME)!==null&&c.userContext.getValue(c.constant.USER_ROLE)!==null&&c.userContext.getValue(c.constant.USER_OFFICE)!==null){v()}d(document).on("keydown",function(x){if((x.which===8&&!d(x.target).is("input, textarea"))||(x.keyCode===37&&x.altKey)){x.preventDefault()}if((x.which||x.keyCode)>=112&&(x.which||x.keyCode)<=123){x.preventDefault()}var w=sessionStorage.getItem("debuggingMode");if(w!=="true"){if(x.keyCode===123){x.preventDefault()}}})}));