use cobis  
go

-- alter table an_label disable trigger
-- alter table an_page  disable trigger
-- alter table an_module_group  disable trigger
-- alter table an_module  disable trigger
-- alter table an_component  disable trigger
-- alter table an_zone  disable trigger
-- alter table an_page_zone  disable trigger
-- alter table an_role_module  disable trigger
-- alter table an_navigation_zone disable trigger
-- alter table an_role_navigation_zone disable trigger
-- alter table an_role_component disable trigger
-- alter table an_role_page disable trigger
-- go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

delete an_role_page from an_role_page, an_page, an_label where rp_pa_id = pa_id and pa_la_id = la_id and la_prod_name in ('M-ADM.RED','M-ADM.Ref','M-ADM.Seg','M-Adm.Prod','M-ADM.Prod')                                                                                  
delete an_module_group where mg_name like ('ADM.RED%') or mg_name like ('ADM.Ref%') or mg_name like ('ADMSEG%') or mg_name like ('Adm.Prod%')
delete an_page_zone from an_page_zone, an_label where pz_la_id = la_id and la_prod_name in ('M-ADM.RED','M-ADM.Ref','M-ADM.Seg','M-Adm.Prod','M-ADM.Prod')                                                                                  
delete an_role_module from an_role_module, an_module, an_label where rm_mo_id = mo_id and mo_la_id = la_id and la_prod_name in ('M-ADM.RED','M-ADM.Ref','M-ADM.Seg','M-Adm.Prod','M-ADM.Prod')                                                                                  
--delete an_navigation_zone from an_navigation_zone, an_label where nz_la_id = la_id and la_prod_name in ('M-ADM.RED','M-ADM.Ref','M-ADM.Seg','M-Adm.Prod','M-ADM.Prod')                                                                                  
delete an_role_component from an_role_component,an_component where rc_co_id = co_id and co_prod_name in ('M-ADM.RED','M-ADM.Ref','M-ADM.Seg','M-Adm.Prod','M-ADM.Prod')                                                                                  
delete an_module_dependency where md_mo_id in (select mo_id from an_module where mo_name like ('ADM.RED%') or mo_name like ('ADM.Ref%') or mo_name like ('ADMSEG%') or mo_name like ('Adm.Prod%'))
delete an_module from an_module, an_label where mo_la_id = la_id and la_prod_name in ('M-ADM.RED','M-ADM.Ref','M-ADM.Seg','M-Adm.Prod','M-ADM.Prod')                                                                                  
delete an_component where co_prod_name in ('M-ADM.RED','M-ADM.Ref','M-ADM.Seg','M-Adm.Prod','M-ADM.Prod')                                                                                  
delete an_page from an_page, an_label where pa_la_id = la_id and la_prod_name in ('M-ADM.RED','M-ADM.Ref','M-ADM.Seg','M-Adm.Prod','M-ADM.Prod')                                                                                  
delete an_label where la_prod_name in ('M-ADM.RED','M-ADM.Ref','M-ADM.Seg','M-Adm.Prod','M-ADM.Prod')
delete an_role_install where ri_prod_name in ('M-ADM.RED','M-ADM.Ref','M-ADM.Seg','M-Adm.Prod','M-ADM.Prod')
go

-- Insercion en tabla de roles instalados por producto
print 'Insercion en tabla de roles instalados por producto' 
declare @w_return int, @w_rol int
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
insert into an_role_install values ('M-ADM.RED', @w_rol)
insert into an_role_install values ('M-ADM.Ref', @w_rol)
insert into an_role_install values ('M-ADM.Seg', @w_rol)
insert into an_role_install values ('M-ADM.Prod', @w_rol)
go

print 'SCRIPT DE CATALOGACION DE ARCHIVOS DE RECURSOS'
go

/***************************************************************************/
/*        SCRIPT DE CATALOGACION DE ARCHIVOS DE RECURSOS                   */
/***************************************************************************/
print 'Modulo ADMSEG.Resources'
declare @w_return int, @w_rol int, @w_prod_name varchar(10),
        @w_module_group varchar(50), @w_zone varchar(50), @w_module varchar(50),
        @w_label_module varchar(50), @w_namespace_component varchar(255), @w_filename_module varchar(255),
        @w_version varchar(15), @w_localizacion varchar(255), @w_parent_module varchar(50),
        
        -- variables temporales
        @id_module_group   int, @id_label_module   int,
        @id_module         int, @id_parent_module  int

-- Datos del componente

select @w_prod_name            = 'M-ADM.Seg',
       @w_module_group         = 'ADMSEG.Resources',
       @w_zone                 = 'Zona 1',
       @w_module               = 'ADMSEG.Resources',
       @w_label_module         = 'ADMSEG.Resources',
       @w_namespace_component  = 'COBISCorp.tCOBIS.ADMSEG.Resources',
       @w_filename_module      = 'COBISCorp.tCOBIS.ADMSEG.Resources.dll',
       @w_version              = '4.0.0.1',
       @w_localizacion         = 'http://[servername]/Admin/ADMSEG/ADMSEG.application',
       @w_parent_module        = null

select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
select @id_label_module = la_id from an_label where la_label = @w_label_module
select @id_module = mo_id from an_module where mo_name = @w_module
select @id_parent_module = mo_id from an_module where mo_name = @w_parent_module
select @id_module_group = mg_id from an_module_group where mg_name = @w_module_group

if @id_module_group is null
begin
    select @id_module_group = isnull(max(mg_id),1) + 1 from an_module_group
    insert into an_module_group values (@id_module_group,@w_module_group,@w_version,@w_localizacion,'COBISExplorer')
end

if @id_label_module is null
begin
    select @id_label_module = isnull(max(la_id),1) + 1 from an_label
    insert into an_label values (@id_label_module,'ES_EC',@w_label_module,@w_prod_name)
end

--Module   
if @id_module is null
begin
    select @id_module = isnull(max(mo_id),1) + 1 from an_module
    if @w_filename_module is null select @w_filename_module = @w_namespace_component + '.dll'
    if @id_parent_module is null select @id_parent_module = 0
    insert into an_module values (@id_module,@id_module_group,@id_label_module,@w_module,@w_filename_module,@id_parent_module,null)
    if isnull(@id_parent_module,0) > 0 insert into an_module_dependency values (@id_module,@id_parent_module)
end
if not exists (select * from an_role_module where rm_mo_id = @id_module and rm_rol = @w_rol)
   insert into an_role_module values (@id_module,@w_rol)
go

print 'Modulo ADM.Ref.Resources'
declare @w_return int, @w_rol int, @w_prod_name varchar(10),
        @w_module_group varchar(50), @w_zone varchar(50), @w_module varchar(50),
        @w_label_module varchar(50), @w_namespace_component varchar(255), @w_filename_module varchar(255),
        @w_version varchar(15), @w_localizacion varchar(255), @w_parent_module varchar(50),
        
        -- variables temporales
        @id_module_group   int, @id_label_module   int,
        @id_module         int, @id_parent_module  int

-- Datos del componente

select @w_prod_name            = 'M-ADM.Ref',                                      
       @w_module_group         = 'ADM.Ref.Resources',                              
       @w_zone                 = 'Zona 1',                                         
       @w_module               = 'ADM.Ref.Resources',                              
       @w_label_module         = 'ADM.Ref.Resources',                              
       @w_namespace_component  = 'COBISCorp.tCOBIS.ADMREF.Resources',              
       @w_filename_module      = 'COBISCorp.tCOBIS.ADMREF.Resources.dll',          
       @w_version              = '4.0.0.1',                                        
       @w_localizacion         = 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application',
       @w_parent_module        = null                                              

select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
select @id_label_module = la_id from an_label where la_label = @w_label_module
select @id_module = mo_id from an_module where mo_name = @w_module
select @id_parent_module = mo_id from an_module where mo_name = @w_parent_module
select @id_module_group = mg_id from an_module_group where mg_name = @w_module_group

if @id_module_group is null
begin
    select @id_module_group = isnull(max(mg_id),1) + 1 from an_module_group
    insert into an_module_group values (@id_module_group,@w_module_group,@w_version,@w_localizacion,'COBISExplorer')
end

if @id_label_module is null
begin
    select @id_label_module = isnull(max(la_id),1) + 1 from an_label
    insert into an_label values (@id_label_module,'ES_EC',@w_label_module,@w_prod_name)
end

--Module   
if @id_module is null
begin
    select @id_module = isnull(max(mo_id),1) + 1 from an_module
    if @w_filename_module is null select @w_filename_module = @w_namespace_component + '.dll'
    if @id_parent_module is null select @id_parent_module = 0
    insert into an_module values (@id_module,@id_module_group,@id_label_module,@w_module,@w_filename_module,@id_parent_module,null)
    if isnull(@id_parent_module,0) > 0 insert into an_module_dependency values (@id_module,@id_parent_module)
end
if not exists (select * from an_role_module where rm_mo_id = @id_module and rm_rol = @w_rol)
   insert into an_role_module values (@id_module,@w_rol)
go

print 'Modulo Adm.Prod.Resources'
declare @w_return int, @w_rol int, @w_prod_name varchar(10),
        @w_module_group varchar(50), @w_zone varchar(50), @w_module varchar(50),
        @w_label_module varchar(50), @w_namespace_component varchar(255), @w_filename_module varchar(255),
        @w_version varchar(15), @w_localizacion varchar(255), @w_parent_module varchar(50),
        
        -- variables temporales
        @id_module_group   int, @id_label_module   int,
        @id_module         int, @id_parent_module  int

-- Datos del componente

select @w_prod_name            = 'M-ADM.Prod',                                       
       @w_module_group         = 'Adm.Prod.Resources',                               
       @w_zone                 = 'Zona 1',                                           
       @w_module               = 'Adm.Prod.Resources',                               
       @w_label_module         = 'ADMPRO.Resources',                                 
       @w_namespace_component  = 'COBISCorp.tCOBIS.ADMPRO.Resources',                
       @w_filename_module      = 'COBISCorp.tCOBIS.ADMPRO.Resources.dll',            
       @w_version              = '4.0.0.1',                                          
       @w_localizacion         = 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application',
       @w_parent_module        = null                                                

select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
select @id_label_module = la_id from an_label where la_label = @w_label_module
select @id_module = mo_id from an_module where mo_name = @w_module
select @id_parent_module = mo_id from an_module where mo_name = @w_parent_module
select @id_module_group = mg_id from an_module_group where mg_name = @w_module_group

if @id_module_group is null
begin
    select @id_module_group = isnull(max(mg_id),1) + 1 from an_module_group
    insert into an_module_group values (@id_module_group,@w_module_group,@w_version,@w_localizacion,'COBISExplorer')
end

if @id_label_module is null
begin
    select @id_label_module = isnull(max(la_id),1) + 1 from an_label
    insert into an_label values (@id_label_module,'ES_EC',@w_label_module,@w_prod_name)
end

--Module   
if @id_module is null
begin
    select @id_module = isnull(max(mo_id),1) + 1 from an_module
    if @w_filename_module is null select @w_filename_module = @w_namespace_component + '.dll'
    if @id_parent_module is null select @id_parent_module = 0
    insert into an_module values (@id_module,@id_module_group,@id_label_module,@w_module,@w_filename_module,@id_parent_module,null)
    if isnull(@id_parent_module,0) > 0 insert into an_module_dependency values (@id_module,@id_parent_module)
end
if not exists (select * from an_role_module where rm_mo_id = @id_module and rm_rol = @w_rol)
   insert into an_role_module values (@id_module,@w_rol)
go


print 'SCRIPT DE CATALOGACION DE SHAREDLIBRARY'
/***************************************************************************/
/*        SCRIPT DE CATALOGACION DE SHAREDLIBRARY                          */
/***************************************************************************/
print 'Modulo ADMSEG.SharedLibrary'
declare @w_return int, @w_rol int, @w_prod_name varchar(10),
        @w_module_group varchar(50), @w_zone varchar(50), @w_module varchar(50),
        @w_label_module varchar(50), @w_namespace_component varchar(255), @w_filename_module varchar(255),
        @w_version varchar(15), @w_localizacion varchar(255), @w_parent_module varchar(50),
        
        -- variables temporales
        @id_module_group   int, @id_label_module   int,
        @id_module         int, @id_parent_module  int

-- Datos del componente

select @w_prod_name            = 'M-ADM.Seg',                                    
       @w_module_group         = 'ADMSEG.SharedLibrary',                         
       @w_zone                 = 'Zona 1',                                       
       @w_module               = 'ADMSEG.SharedLibrary',                         
       @w_label_module         = 'ADMSEG.SharedLibrary',                         
       @w_namespace_component  = 'COBISCorp.tCOBIS.ADMSEG.SharedLibrary',        
       @w_filename_module      = 'COBISCorp.tCOBIS.ADMSEG.SharedLibrary.dll',    
       @w_version              = '4.0.0.1',                                      
       @w_localizacion         = 'http://[servername]/Admin/ADMSEG/ADMSEG.application',
       @w_parent_module        = 'ADMSEG.Resources'                              

select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
select @id_label_module = la_id from an_label where la_label = @w_label_module
select @id_module = mo_id from an_module where mo_name = @w_module
select @id_parent_module = mo_id from an_module where mo_name = @w_parent_module
select @id_module_group = mg_id from an_module_group where mg_name = @w_module_group

if @id_module_group is null
begin
    select @id_module_group = isnull(max(mg_id),1) + 1 from an_module_group
    insert into an_module_group values (@id_module_group,@w_module_group,@w_version,@w_localizacion,'COBISExplorer')
end

if @id_label_module is null
begin
    select @id_label_module = isnull(max(la_id),1) + 1 from an_label
    insert into an_label values (@id_label_module,'ES_EC',@w_label_module,@w_prod_name)
end

--Module   
if @id_module is null
begin
    select @id_module = isnull(max(mo_id),1) + 1 from an_module
    if @w_filename_module is null select @w_filename_module = @w_namespace_component + '.dll'
    if @id_parent_module is null select @id_parent_module = 0
    insert into an_module values (@id_module,@id_module_group,@id_label_module,@w_module,@w_filename_module,@id_parent_module,null)
    if isnull(@id_parent_module,0) > 0 insert into an_module_dependency values (@id_module,@id_parent_module)
end
if not exists (select * from an_role_module where rm_mo_id = @id_module and rm_rol = @w_rol)
   insert into an_role_module values (@id_module,@w_rol)
go

print 'Modulo ADM.RED.SharedLibrary'
declare @w_return int, @w_rol int, @w_prod_name varchar(10),
        @w_module_group varchar(50), @w_zone varchar(50), @w_module varchar(50),
        @w_label_module varchar(50), @w_namespace_component varchar(255), @w_filename_module varchar(255),
        @w_version varchar(15), @w_localizacion varchar(255), @w_parent_module varchar(50),
        
        -- variables temporales
        @id_module_group   int, @id_label_module   int,
        @id_module         int, @id_parent_module  int

-- Datos del componente

select @w_prod_name            = 'M-ADM.RED',                                      
       @w_module_group         = 'ADM.RED.SharedLibrary',                          
       @w_zone                 = 'Zona 1',                                         
       @w_module               = 'ADM.RED.SharedLibrary',                          
       @w_label_module         = 'ADM.RED.SharedLibrary',                          
       @w_namespace_component  = 'COBISCorp.tCOBIS.ADMRED.SharedLibrary',          
       @w_filename_module      = 'COBISCorp.tCOBIS.ADMRED.SharedLibrary.dll',      
       @w_version              = '4.0.0.1',                                        
       @w_localizacion         = 'http://[servername]/Admin/ADM.RED/ADM.RED.application',
       @w_parent_module        = 'ADM.RED.Resources'                               

select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
select @id_label_module = la_id from an_label where la_label = @w_label_module
select @id_module = mo_id from an_module where mo_name = @w_module
select @id_parent_module = mo_id from an_module where mo_name = @w_parent_module
select @id_module_group = mg_id from an_module_group where mg_name = @w_module_group

if @id_module_group is null
begin
    select @id_module_group = isnull(max(mg_id),1) + 1 from an_module_group
    insert into an_module_group values (@id_module_group,@w_module_group,@w_version,@w_localizacion,'COBISExplorer')
end

if @id_label_module is null
begin
    select @id_label_module = isnull(max(la_id),1) + 1 from an_label
    insert into an_label values (@id_label_module,'ES_EC',@w_label_module,@w_prod_name)
end

--Module   
if @id_module is null
begin
    select @id_module = isnull(max(mo_id),1) + 1 from an_module
    if @w_filename_module is null select @w_filename_module = @w_namespace_component + '.dll'
    if @id_parent_module is null select @id_parent_module = 0
    insert into an_module values (@id_module,@id_module_group,@id_label_module,@w_module,@w_filename_module,@id_parent_module,null)
    if isnull(@id_parent_module,0) > 0 insert into an_module_dependency values (@id_module,@id_parent_module)
end
if not exists (select * from an_role_module where rm_mo_id = @id_module and rm_rol = @w_rol)
   insert into an_role_module values (@id_module,@w_rol)
go

print 'Modulo ADM.Ref.SharedLibrary'
declare @w_return int, @w_rol int, @w_prod_name varchar(10),
        @w_module_group varchar(50), @w_zone varchar(50), @w_module varchar(50),
        @w_label_module varchar(50), @w_namespace_component varchar(255), @w_filename_module varchar(255),
        @w_version varchar(15), @w_localizacion varchar(255), @w_parent_module varchar(50),
        
        -- variables temporales
        @id_module_group   int, @id_label_module   int,
        @id_module         int, @id_parent_module  int

-- Datos del componente

select @w_prod_name            = 'M-ADM.Ref',                                      
       @w_module_group         = 'ADM.Ref.SharedLibrary',                          
       @w_zone                 = 'Zona 1',                                         
       @w_module               = 'ADM.Ref.SharedLibrary',                          
       @w_label_module         = 'ADM.Ref.SharedLibrary',                          
       @w_namespace_component  = 'COBISCorp.tCOBIS.ADMREF.SharedLibrary',          
       @w_filename_module      = 'COBISCorp.tCOBIS.ADMREF.SharedLibrary.dll',      
       @w_version              = '4.0.0.1',                                        
       @w_localizacion         = 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application',
       @w_parent_module        = 'ADM.Ref.Resources'                               

select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
select @id_label_module = la_id from an_label where la_label = @w_label_module
select @id_module = mo_id from an_module where mo_name = @w_module
select @id_parent_module = mo_id from an_module where mo_name = @w_parent_module
select @id_module_group = mg_id from an_module_group where mg_name = @w_module_group

if @id_module_group is null
begin
    select @id_module_group = isnull(max(mg_id),1) + 1 from an_module_group
    insert into an_module_group values (@id_module_group,@w_module_group,@w_version,@w_localizacion,'COBISExplorer')
end

if @id_label_module is null
begin
    select @id_label_module = isnull(max(la_id),1) + 1 from an_label
    insert into an_label values (@id_label_module,'ES_EC',@w_label_module,@w_prod_name)
end

--Module   
if @id_module is null
begin
    select @id_module = isnull(max(mo_id),1) + 1 from an_module
    if @w_filename_module is null select @w_filename_module = @w_namespace_component + '.dll'
    if @id_parent_module is null select @id_parent_module = 0
    insert into an_module values (@id_module,@id_module_group,@id_label_module,@w_module,@w_filename_module,@id_parent_module,null)
    if isnull(@id_parent_module,0) > 0 insert into an_module_dependency values (@id_module,@id_parent_module)
end
if not exists (select * from an_role_module where rm_mo_id = @id_module and rm_rol = @w_rol)
   insert into an_role_module values (@id_module,@w_rol)
go

print 'Modulo Adm.Prod.SharedLibrary'
declare @w_return int, @w_rol int, @w_prod_name varchar(10),
        @w_module_group varchar(50), @w_zone varchar(50), @w_module varchar(50),
        @w_label_module varchar(50), @w_namespace_component varchar(255), @w_filename_module varchar(255),
        @w_version varchar(15), @w_localizacion varchar(255), @w_parent_module varchar(50),
        
        -- variables temporales
        @id_module_group   int, @id_label_module   int,
        @id_module         int, @id_parent_module  int

-- Datos del componente

select @w_prod_name            = 'M-ADM.Prod',                                       
       @w_module_group         = 'Adm.Prod.SharedLibrary',                           
       @w_zone                 = 'Zona 1',                                           
       @w_module               = 'Adm.Prod.SharedLibrary',                           
       @w_label_module         = 'Adm.Prod.SharedLibrary',                           
       @w_namespace_component  = 'COBISCorp.tCOBIS.ADMPRO.SharedLibrary',            
       @w_filename_module      = 'COBISCorp.tCOBIS.ADMPRO.SharedLibrary.dll',        
       @w_version              = '4.0.0.1',                                          
       @w_localizacion         = 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application',
       @w_parent_module        = 'Adm.Prod.Resources'                                

select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
select @id_label_module = la_id from an_label where la_label = @w_label_module
select @id_module = mo_id from an_module where mo_name = @w_module
select @id_parent_module = mo_id from an_module where mo_name = @w_parent_module
select @id_module_group = mg_id from an_module_group where mg_name = @w_module_group

if @id_module_group is null
begin
    select @id_module_group = isnull(max(mg_id),1) + 1 from an_module_group
    insert into an_module_group values (@id_module_group,@w_module_group,@w_version,@w_localizacion,'COBISExplorer')
end

if @id_label_module is null
begin
    select @id_label_module = isnull(max(la_id),1) + 1 from an_label
    insert into an_label values (@id_label_module,'ES_EC',@w_label_module,@w_prod_name)
end

--Module   
if @id_module is null
begin
    select @id_module = isnull(max(mo_id),1) + 1 from an_module
    if @w_filename_module is null select @w_filename_module = @w_namespace_component + '.dll'
    if @id_parent_module is null select @id_parent_module = 0
    insert into an_module values (@id_module,@id_module_group,@id_label_module,@w_module,@w_filename_module,@id_parent_module,null)
    if isnull(@id_parent_module,0) > 0 insert into an_module_dependency values (@id_module,@id_parent_module)
end
if not exists (select * from an_role_module where rm_mo_id = @id_module and rm_rol = @w_rol)
   insert into an_role_module values (@id_module,@w_rol)
go


-- Registros para: AS.Definición de Sucursales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: AS.Definición de Sucursales'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from an_page where pa_name = 'AS.Definición de Sucursales') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Definición de Servidores (Sucursales)', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Administración del Sistema'                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Definición de Sucursales', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.RED', '', null, 1)                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Nodos                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
print 'Registros para: AS.Nodos'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_page where pa_name = 'AS.Nodos') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                    
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Nodos', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Definición de Sucursales'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Nodos', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.RED', '', null, 1)                                                                                                                                                                                                                                                                                                                                                                             
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.RED.FNodosClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
print 'Registros para: AS.ADM.RED.FNodosClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_page where pa_name = 'AS.ADM.RED.FNodosClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Insertar', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Nodos'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.RED.FNodosClass', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.RED', 'Operacion=0', null, 1)                                                                                                                                                                                                                                                                                                                                                    
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.RED.Node') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.RED.Node', '4.0.0.1', 'http://[servername]/Admin/ADM.RED/ADM.RED.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                             
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.RED.Node'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADM.RED.Node') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.RED.Node', 'COBISCorp.tCOBIS.ADMRED.Node.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                  
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.RED.Node'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.RED.FNodos', 'FNodosClass', 'COBISCorp.tCOBIS.ADMRED.Node', 'SV', '', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Insertar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Insertar', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Insertar'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.RED.FGNodosClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: AS.ADM.RED.FGNodosClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
if not exists (select 1 from an_page where pa_name = 'AS.ADM.RED.FGNodosClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Actualizar', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Nodos'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.RED.FGNodosClass', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.RED', 'Operacion=1', null, 1)                                                                                                                                                                                                                                                                                                                                                   
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.RED.Node') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.RED.Node', '4.0.0.1', 'http://[servername]/Admin/ADM.RED/ADM.RED.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                             
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.RED.Node'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADM.RED.Node') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.RED.Node', 'COBISCorp.tCOBIS.ADMRED.Node.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                  
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.RED.Node'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.RED.FGNodos', 'FGNodosClass', 'COBISCorp.tCOBIS.ADMRED.Node', 'SV', '', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Actualizar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Actualizar', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                                
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Actualizar'                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.RED.FGNodosClass1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
print 'Registros para: AS.ADM.RED.FGNodosClass1'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_page where pa_name = 'AS.ADM.RED.FGNodosClass1') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int, @w_co_name varchar(50), @w_co_class varchar(30)
select @w_co_name = 'ADM.RED.FGNodos'
select @w_co_class = 'FGNodosClass'
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Habilitar', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Nodos'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.RED.FGNodosClass1', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADM.RED', 'Operacion=4', null, 1)                                                                                                                                                                                                                                                                                                                                                  
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.RED.Node') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.RED.Node', '4.0.0.1', 'http://[servername]/Admin/ADM.RED/ADM.RED.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                             
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.RED.Node'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADM.RED.Node') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.RED.Node', 'COBISCorp.tCOBIS.ADMRED.Node.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                  
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.RED.Node'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    

--JHI
if not exists (select * from an_component where co_name = @w_co_name and co_class  = @w_co_class)
begin
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, @w_co_name, @w_co_class, 'COBISCorp.tCOBIS.ADMRED.Node', 'SV', '', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end
else select @w_co_id = co_id from an_component where co_name = @w_co_name and co_class  = @w_co_class
--JHI

if not exists (select 1 from an_label where la_label = 'Habilitar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Habilitar', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                                 
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Habilitar'                                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.RED.FGNodosClass2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
print 'Registros para: AS.ADM.RED.FGNodosClass2'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_page where pa_name = 'AS.ADM.RED.FGNodosClass2') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int, @w_co_name varchar(50), @w_co_class varchar(30)
select @w_co_name = 'ADM.RED.FGNodos'
select @w_co_class = 'FGNodosClass'
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Eliminar', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Nodos'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.RED.FGNodosClass2', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-ADM.RED', 'Operacion=2', null, 1)                                                                                                                                                                                                                                                                                                                                                  
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.RED.Node') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.RED.Node', '4.0.0.1', 'http://[servername]/Admin/ADM.RED/ADM.RED.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                             
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.RED.Node'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADM.RED.Node') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.RED.Node', 'COBISCorp.tCOBIS.ADMRED.Node.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                  
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.RED.Node'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    

--JHI
if not exists (select * from an_component where co_name = @w_co_name and co_class  = @w_co_class)
begin
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, @w_co_name, @w_co_class, 'COBISCorp.tCOBIS.ADMRED.Node', 'SV', '', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end
else select @w_co_id = co_id from an_component where co_name = @w_co_name and co_class  = @w_co_class
--JHI

if not exists (select 1 from an_label where la_label = 'Eliminar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Eliminar', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Eliminar'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.RED.FTerminalesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: AS.ADM.RED.FTerminalesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from an_page where pa_name = 'AS.ADM.RED.FTerminalesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Terminales', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Nodos'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.RED.FTerminalesClass', 'icono pagina', @w_pa_id_parent, 5, 'horizontal', 'Nemonic', 'M-ADM.RED', '', null, 1)                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.RED.Maintenance') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.RED.Maintenance', '4.0.0.1', 'http://[servername]/Admin/ADM.RED/ADM.RED.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                      
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.RED.Maintenance'                                                                                                                                                                                                                                                                                                                                                                                                                               
if not exists (select 1 from an_module where mo_name = 'ADM.RED.Maintenance') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.RED.Maintenance', 'COBISCorp.tCOBIS.ADMRED.Maintenance.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                    
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.RED.Maintenance'                                                                                                                                                                                                                                                                                                                                                                                                                                     
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.RED.FTerminales', 'FTerminalesClass', 'COBISCorp.tCOBIS.ADMRED.Maintenance', 'SV', '', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                               
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Terminales') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Terminales', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                                
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Terminales'                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.RED.FBaseDatosClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
print 'Registros para: AS.ADM.RED.FBaseDatosClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
if not exists (select 1 from an_page where pa_name = 'AS.ADM.RED.FBaseDatosClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                  
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Bases de Datos', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Nodos'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.RED.FBaseDatosClass', 'icono pagina', @w_pa_id_parent, 6, 'horizontal', 'Nemonic', 'M-ADM.RED', '', null, 1)                                                                                                                                                                                                                                                                                                                                                           
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.RED.Maintenance') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.RED.Maintenance', '4.0.0.1', 'http://[servername]/Admin/ADM.RED/ADM.RED.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                      
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.RED.Maintenance'                                                                                                                                                                                                                                                                                                                                                                                                                               
if not exists (select 1 from an_module where mo_name = 'ADM.RED.Maintenance') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.RED.Maintenance', 'COBISCorp.tCOBIS.ADMRED.Maintenance.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                    
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.RED.Maintenance'                                                                                                                                                                                                                                                                                                                                                                                                                                     
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.RED.FBaseDatos', 'FBaseDatosClass', 'COBISCorp.tCOBIS.ADMRED.Maintenance', 'SV', '', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                 
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Bases de Datos') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Bases de Datos', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                            
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Bases de Datos'                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Referencias                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
print 'Registros para: AS.Referencias'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
if not exists (select 1 from an_page where pa_name = 'AS.Referencias') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Referencias', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Definición de Sucursales'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Referencias', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.RED', '', null, 1)                                                                                                                                                                                                                                                                                                                                                                       
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.RED.FEquiposClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
print 'Registros para: AS.ADM.RED.FEquiposClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_page where pa_name = 'AS.ADM.RED.FEquiposClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Equipos', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Referencias'                                                                                                                                                                                                                                                                                                                                                                                                                                              
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.RED.FEquiposClass', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.RED', '', null, 1)                                                                                                                                                                                                                                                                                                                                                             
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.RED.Maintenance') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.RED.Maintenance', '4.0.0.1', 'http://[servername]/Admin/ADM.RED/ADM.RED.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                      
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.RED.Maintenance'                                                                                                                                                                                                                                                                                                                                                                                                                               
if not exists (select 1 from an_module where mo_name = 'ADM.RED.Maintenance') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.RED.Maintenance', 'COBISCorp.tCOBIS.ADMRED.Maintenance.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                    
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.RED.Maintenance'                                                                                                                                                                                                                                                                                                                                                                                                                                     
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.RED.FEquipos', 'FEquiposClass', 'COBISCorp.tCOBIS.ADMRED.Maintenance', 'SV', '', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                     
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Equipos') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Equipos', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Equipos'                                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.RED.FSistOperativosClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
print 'Registros para: AS.ADM.RED.FSistOperativosClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page where pa_name = 'AS.ADM.RED.FSistOperativosClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                             
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Sistemas Operativos', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Referencias'                                                                                                                                                                                                                                                                                                                                                                                                                                              
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.RED.FSistOperativosClass', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.RED', '', null, 1)                                                                                                                                                                                                                                                                                                                                                      
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.RED.Maintenance') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.RED.Maintenance', '4.0.0.1', 'http://[servername]/Admin/ADM.RED/ADM.RED.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                      
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.RED.Maintenance'                                                                                                                                                                                                                                                                                                                                                                                                                               
if not exists (select 1 from an_module where mo_name = 'ADM.RED.Maintenance') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.RED.Maintenance', 'COBISCorp.tCOBIS.ADMRED.Maintenance.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                    
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.RED.Maintenance'                                                                                                                                                                                                                                                                                                                                                                                                                                     
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.RED.FSistOperativos', 'FSistOperativosClass', 'COBISCorp.tCOBIS.ADMRED.Maintenance', 'SV', '', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                       
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Sistemas Operativos') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Sistemas Operativos', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                       
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Sistemas Operativos'                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Consultas                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: AS.Consultas'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'AS.Consultas') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consultas', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Definición de Sucursales'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Consultas', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADM.RED', '', null, 1)                                                                                                                                                                                                                                                                                                                                                                         
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.RED.FConsConfigNodosClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
print 'Registros para: AS.ADM.RED.FConsConfigNodosClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_page where pa_name = 'AS.ADM.RED.FConsConfigNodosClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                            
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Configuración de Nodos', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas'                                                                                                                                                                                                                                                                                                                                                                                                                                                
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.RED.FConsConfigNodosClass', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.RED', '', null, 1)                                                                                                                                                                                                                                                                                                                                                     
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.RED.Node') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.RED.Node', '4.0.0.1', 'http://[servername]/Admin/ADM.RED/ADM.RED.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                             
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.RED.Node'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADM.RED.Node') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.RED.Node', 'COBISCorp.tCOBIS.ADMRED.Node.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                  
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.RED.Node'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.RED.FConsConfigNodos', 'FConsConfigNodosClass', 'COBISCorp.tCOBIS.ADMRED.Node', 'SV', '', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                            
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Configuración de Nodos') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Configuración de Nodos', 'M-ADM.RED')                                                                                                                                                                                                                                                                                                                                                                                                                                    
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Configuración de Nodos'                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Definición de Productos                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
print 'Registros para: AS.Definición de Productos'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
if not exists (select 1 from an_page where pa_name = 'AS.Definición de Productos') begin                                                                                                                                                                                                                                                                                                                                                                                                                                  
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Definición de Productos Cobis', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Administración del Sistema'                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Definición de Productos', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.Prod', '', null, 1)                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Producto                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: AS.Producto'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from an_page where pa_name = 'AS.Producto') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Producto', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Definición de Productos'                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Producto', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.Prod', '', null, 1)                                                                                                                                                                                                                                                                                                                                                                         
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Adm.Prod.FGProductosMoneda                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
print 'Registros para: AS.Adm.Prod.FGProductosMoneda'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_page where pa_name = 'AS.Adm.Prod.FGProductosMoneda') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Producto - Moneda', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Producto'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Adm.Prod.FGProductosMoneda', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.Prod', 'Operacion=0', null, 1)                                                                                                                                                                                                                                                                                                                                            
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'Adm.Prod.Products') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'Adm.Prod.Products', '4.0.0.1', 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                      
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'Adm.Prod.Products'                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_module where mo_name = 'Adm.Prod.Products') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'Adm.Prod.Products', 'COBISCorp.tCOBIS.ADMPRO.Products.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Products'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'Adm.Prod.FGProductosMoneda', 'FGProductosMonedaClass', 'COBISCorp.tCOBIS.ADMPRO.Products', 'SV', '', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                    
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Producto - Moneda') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Producto - Moneda', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Producto - Moneda'                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Adm.Prod.FGProductosOficina                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
print 'Registros para: AS.Adm.Prod.FGProductosOficina'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
if not exists (select 1 from an_page where pa_name = 'AS.Adm.Prod.FGProductosOficina') begin                                                                                                                                                                                                                                                                                                                                                                                                                              
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Producto - Oficina', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Producto'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Adm.Prod.FGProductosOficina', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.Prod', '', null, 1)                                                                                                                                                                                                                                                                                                                                                      
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'Adm.Prod.Products') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'Adm.Prod.Products', '4.0.0.1', 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                      
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'Adm.Prod.Products'                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_module where mo_name = 'Adm.Prod.Products') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'Adm.Prod.Products', 'COBISCorp.tCOBIS.ADMPRO.Products.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Products'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'Adm.Prod.FGProductosOficina', 'FGProductosOficinaClass', 'COBISCorp.tCOBIS.ADMPRO.Products', 'SV', '', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                  
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Producto - Oficina') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Producto - Oficina', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                       
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Producto - Oficina'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Transacciones                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
print 'Registros para: AS.Transacciones'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_page where pa_name = 'AS.Transacciones') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Transacciones', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Definición de Productos'                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Transacciones', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.Prod', '', null, 1)                                                                                                                                                                                                                                                                                                                                                                    
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Adm.Prod.FGProcedimientos                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: AS.Adm.Prod.FGProcedimientos'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'AS.Adm.Prod.FGProcedimientos') begin                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Procedimientos', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Transacciones'                                                                                                                                                                                                                                                                                                                                                                                                                                            
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Adm.Prod.FGProcedimientos', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.Prod', '', null, 1)                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'Adm.Prod.Trans') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'Adm.Prod.Trans', '4.0.0.1', 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'Adm.Prod.Trans'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'Adm.Prod.Trans') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'Adm.Prod.Trans', 'COBISCorp.tCOBIS.ADMPRO.Transaction.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Trans'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'Adm.Prod.FGProcedimientos', 'FGProcedimientosClass', 'COBISCorp.tCOBIS.ADMPRO.Transaction', 'SV', '', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                   
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Procedimientos') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Procedimientos', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                           
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Procedimientos'                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Adm.Prod.FTransacciones                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
print 'Registros para: AS.Adm.Prod.FTransacciones'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
if not exists (select 1 from an_page where pa_name = 'AS.Adm.Prod.FTransacciones') begin                                                                                                                                                                                                                                                                                                                                                                                                                                  
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Insertar', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Transacciones'                                                                                                                                                                                                                                                                                                                                                                                                                                            
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Adm.Prod.FTransacciones', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.Prod', 'Operacion=0', null, 1)                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'Adm.Prod.Trans') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'Adm.Prod.Trans', '4.0.0.1', 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'Adm.Prod.Trans'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'Adm.Prod.Trans') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'Adm.Prod.Trans', 'COBISCorp.tCOBIS.ADMPRO.Transaction.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Trans'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'Adm.Prod.FTransacciones', 'FTransaccionesClass', 'COBISCorp.tCOBIS.ADMPRO.Transaction', 'SV', '', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                       
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Insertar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Insertar', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                                 
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Insertar'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Adm.Prod.FGTransaccionesAct                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
print 'Registros para: AS.Adm.Prod.FGTransaccionesAct'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
if not exists (select 1 from an_page where pa_name = 'AS.Adm.Prod.FGTransaccionesAct') begin                                                                                                                                                                                                                                                                                                                                                                                                                              
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Actualizar', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Transacciones'                                                                                                                                                                                                                                                                                                                                                                                                                                            
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Adm.Prod.FGTransaccionesAct', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADM.Prod', 'Operacion=1', null, 1)                                                                                                                                                                                                                                                                                                                                           
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'Adm.Prod.Trans') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'Adm.Prod.Trans', '4.0.0.1', 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'Adm.Prod.Trans'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'Adm.Prod.Trans') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'Adm.Prod.Trans', 'COBISCorp.tCOBIS.ADMPRO.Transaction.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Trans'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'Adm.Prod.FGTransacciones', 'FGTransaccionesClass', 'COBISCorp.tCOBIS.ADMPRO.Transaction', 'SV', '', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                     
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Actualizar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Actualizar', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                               
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Actualizar'                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Adm.Prod.FGTransaccionesElim                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
print 'Registros para: AS.Adm.Prod.FGTransaccionesElim'                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page where pa_name = 'AS.Adm.Prod.FGTransaccionesElim') begin                                                                                                                                                                                                                                                                                                                                                                                                                             
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int, @w_co_name varchar(50), @w_co_class varchar(30)
select @w_co_name = 'Adm.Prod.FGTransacciones'
select @w_co_class = 'FGTransaccionesClass'
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Eliminar', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Transacciones'                                                                                                                                                                                                                                                                                                                                                                                                                                            
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Adm.Prod.FGTransaccionesElim', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-ADM.Prod', 'Operacion=2', null, 1)                                                                                                                                                                                                                                                                                                                                          
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'Adm.Prod.Trans') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'Adm.Prod.Trans', '4.0.0.1', 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'Adm.Prod.Trans'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'Adm.Prod.Trans') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'Adm.Prod.Trans', 'COBISCorp.tCOBIS.ADMPRO.Transaction.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Trans'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    

--JHI
if not exists (select * from an_component where co_name = @w_co_name and co_class  = @w_co_class)
begin
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, @w_co_name, @w_co_class, 'COBISCorp.tCOBIS.ADMPRO.Transaction', 'SV', '', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                     
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end
else select @w_co_id = co_id from an_component where co_name = @w_co_name and co_class  = @w_co_class
--JHI

if not exists (select 1 from an_label where la_label = 'Eliminar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Eliminar', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                                 
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Eliminar'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Adm.Prod.FProductoTransaccion                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
print 'Registros para: AS.Adm.Prod.FProductoTransaccion'                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_page where pa_name = 'AS.Adm.Prod.FProductoTransaccion') begin                                                                                                                                                                                                                                                                                                                                                                                                                            
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Transacciones de un Producto', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Transacciones'                                                                                                                                                                                                                                                                                                                                                                                                                                            
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Adm.Prod.FProductoTransaccion', 'icono pagina', @w_pa_id_parent, 5, 'horizontal', 'Nemonic', 'M-ADM.Prod', '', null, 1)                                                                                                                                                                                                                                                                                                                                                    
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'Adm.Prod.Trans') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'Adm.Prod.Trans', '4.0.0.1', 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'Adm.Prod.Trans'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'Adm.Prod.Trans') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'Adm.Prod.Trans', 'COBISCorp.tCOBIS.ADMPRO.Transaction.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Trans'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'Adm.Prod.FProductoTransaccion', 'FProductoTransaccionClass', 'COBISCorp.tCOBIS.ADMPRO.Transaction', 'SV', '', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                           
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Transacciones de un Producto') begin                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Transacciones de un Producto', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                             
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Transacciones de un Producto'                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Consultas2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
print 'Registros para: AS.Consultas2'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_page where pa_name = 'AS.Consultas2') begin                                                                                                                                                                                                                                                                                                                                                                                                                                               
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consultas', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Definición de Productos'                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Consultas2', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADM.Prod', '', null, 1)                                                                                                                                                                                                                                                                                                                                                                       
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Adm.Prod.FConsGenProductos                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
print 'Registros para: AS.Adm.Prod.FConsGenProductos'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_page where pa_name = 'AS.Adm.Prod.FConsGenProductos') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consulta Genérica de Productos', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas2'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Adm.Prod.FConsGenProductos', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.Prod', '', null, 1)                                                                                                                                                                                                                                                                                                                                                       
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'Adm.Prod.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'Adm.Prod.Query', '4.0.0.1', 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'Adm.Prod.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'Adm.Prod.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'Adm.Prod.Query', 'COBISCorp.tCOBIS.ADMPRO.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'Adm.Prod.FConsGenProductos', 'FConsGenProductosClass', 'COBISCorp.tCOBIS.ADMPRO.Query', 'SV', '', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                       
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Consulta Genérica de Productos') begin                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consulta Genérica de Productos', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                           
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Consulta Genérica de Productos'                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Adm.Prod.FConsProdInstalado                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
print 'Registros para: AS.Adm.Prod.FConsProdInstalado'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
if not exists (select 1 from an_page where pa_name = 'AS.Adm.Prod.FConsProdInstalado') begin                                                                                                                                                                                                                                                                                                                                                                                                                              
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Productos Instalados', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas2'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Adm.Prod.FConsProdInstalado', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.Prod', '', null, 1)                                                                                                                                                                                                                                                                                                                                                      
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'Adm.Prod.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'Adm.Prod.Query', '4.0.0.1', 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'Adm.Prod.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'Adm.Prod.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'Adm.Prod.Query', 'COBISCorp.tCOBIS.ADMPRO.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'Adm.Prod.FConsProdInstalado', 'FConsProdInstaladoClass', 'COBISCorp.tCOBIS.ADMPRO.Query', 'SV', '', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                     
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Productos Instalados') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Productos Instalados', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                     
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Productos Instalados'                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Adm.Prod.FConsProdServidor                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
print 'Registros para: AS.Adm.Prod.FConsProdServidor'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_page where pa_name = 'AS.Adm.Prod.FConsProdServidor') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Productos por Servidor', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas2'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Adm.Prod.FConsProdServidor', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADM.Prod', '', null, 1)                                                                                                                                                                                                                                                                                                                                                       
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'Adm.Prod.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'Adm.Prod.Query', '4.0.0.1', 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'Adm.Prod.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'Adm.Prod.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'Adm.Prod.Query', 'COBISCorp.tCOBIS.ADMPRO.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'Adm.Prod.FConsProdServidor', 'FConsProdServidorClass', 'COBISCorp.tCOBIS.ADMPRO.Query', 'SV', '', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                       
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Productos por Servidor') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Productos por Servidor', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                   
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Productos por Servidor'                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Adm.Prod.FConsProdTransaccion                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
print 'Registros para: AS.Adm.Prod.FConsProdTransaccion'                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_page where pa_name = 'AS.Adm.Prod.FConsProdTransaccion') begin                                                                                                                                                                                                                                                                                                                                                                                                                            
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Productos por Transacción', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas2'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Adm.Prod.FConsProdTransaccion', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-ADM.Prod', '', null, 1)                                                                                                                                                                                                                                                                                                                                                    
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'Adm.Prod.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'Adm.Prod.Query', '4.0.0.1', 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'Adm.Prod.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'Adm.Prod.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'Adm.Prod.Query', 'COBISCorp.tCOBIS.ADMPRO.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'Adm.Prod.FConsProdTransaccion', 'FConsProdTransaccionClass', 'COBISCorp.tCOBIS.ADMPRO.Query', 'SV', '', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                 
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Productos por Transacción') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Productos por Transacción', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Productos por Transacción'                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Adm.Prod.FConsSerProducto                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: AS.Adm.Prod.FConsSerProducto'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'AS.Adm.Prod.FConsSerProducto') begin                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Servidores por Producto', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas2'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Adm.Prod.FConsSerProducto', 'icono pagina', @w_pa_id_parent, 5, 'horizontal', 'Nemonic', 'M-ADM.Prod', '', null, 1)                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'Adm.Prod.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'Adm.Prod.Query', '4.0.0.1', 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'Adm.Prod.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'Adm.Prod.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'Adm.Prod.Query', 'COBISCorp.tCOBIS.ADMPRO.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'Adm.Prod.FConsSerProducto', 'FConsSerProductoClass', 'COBISCorp.tCOBIS.ADMPRO.Query', 'SV', '', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                         
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Servidores por Producto') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Servidores por Producto', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Servidores por Producto'                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Adm.Prod.FConsTraProcedimiento                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
print 'Registros para: AS.Adm.Prod.FConsTraProcedimiento'                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_page where pa_name = 'AS.Adm.Prod.FConsTraProcedimiento') begin                                                                                                                                                                                                                                                                                                                                                                                                                           
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Transacciones por Procedimiento', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas2'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Adm.Prod.FConsTraProcedimiento', 'icono pagina', @w_pa_id_parent, 6, 'horizontal', 'Nemonic', 'M-ADM.Prod', '', null, 1)                                                                                                                                                                                                                                                                                                                                                   
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'Adm.Prod.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'Adm.Prod.Query', '4.0.0.1', 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'Adm.Prod.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'Adm.Prod.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'Adm.Prod.Query', 'COBISCorp.tCOBIS.ADMPRO.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'Adm.Prod.FConsTraProcedimiento', 'FConsTraProcedimientoClass', 'COBISCorp.tCOBIS.ADMPRO.Query', 'SV', '', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                               
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Transacciones por Procedimiento') begin                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Transacciones por Procedimiento', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                          
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Transacciones por Procedimiento'                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Adm.Prod.FConsTraProducto                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: AS.Adm.Prod.FConsTraProducto'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'AS.Adm.Prod.FConsTraProducto') begin                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Transacciones de Producto', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas2'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Adm.Prod.FConsTraProducto', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-ADM.Prod', '', null, 1)                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'Adm.Prod.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'Adm.Prod.Query', '4.0.0.1', 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'Adm.Prod.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'Adm.Prod.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'Adm.Prod.Query', 'COBISCorp.tCOBIS.ADMPRO.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'Adm.Prod.FConsTraProducto', 'FConsTraProductoClass', 'COBISCorp.tCOBIS.ADMPRO.Query', 'SV', '', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                         
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Transacciones de Producto') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Transacciones de Producto', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Transacciones de Producto'                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Varios                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
print 'Registros para: AS.Varios'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
if not exists (select 1 from an_page where pa_name = 'AS.Varios') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                   
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Varios', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Definición de Productos'                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Varios', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-ADM.Prod', '', null, 1)                                                                                                                                                                                                                                                                                                                                                                           
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Adm.Prod.FGServidoresDistribucion                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
print 'Registros para: AS.Adm.Prod.FGServidoresDistribucion'                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
if not exists (select 1 from an_page where pa_name = 'AS.Adm.Prod.FGServidoresDistribucion') begin                                                                                                                                                                                                                                                                                                                                                                                                                        
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Servidores de Distribucion', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Varios'                                                                                                                                                                                                                                                                                                                                                                                                                                                   
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Adm.Prod.FGServidoresDistribucion', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.Prod', '', null, 1)                                                                                                                                                                                                                                                                                                                                                
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'Adm.Prod.Others') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'Adm.Prod.Others', '4.0.0.1', 'http://[servername]/Admin/Adm.Prod/Adm.Prod.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                        
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'Adm.Prod.Others'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_module where mo_name = 'Adm.Prod.Others') begin                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'Adm.Prod.Others', 'COBISCorp.tCOBIS.ADMPRO.Others.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                             
end else select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Others'                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'Adm.Prod.FGServidoresDistribucion', 'FGServidoresDistribucionClass', 'COBISCorp.tCOBIS.ADMPRO.Others', 'SV', '', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                        
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Servidores de Distribucion') begin                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Servidores de Distribucion', 'M-ADM.Prod')                                                                                                                                                                                                                                                                                                                                                                                                                               
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Servidores de Distribucion'                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Definción de Referencias                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: AS.Definción de Referencias'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from an_page where pa_name = 'AS.Definción de Referencias') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Definición de Referencias', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Administración del Sistema'                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Definción de Referencias', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Parámetros                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
print 'Registros para: AS.Parámetros'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_page where pa_name = 'AS.Parámetros') begin                                                                                                                                                                                                                                                                                                                                                                                                                                               
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Parámetros', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Definción de Referencias'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Parámetros', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.Ref.FGFilialClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
print 'Registros para: AS.ADM.Ref.FGFilialClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FGFilialClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Filiales', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Parámetros'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FGFilialClass', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                             
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Office') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Office', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                           
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Office'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Office') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Office', 'COBISCorp.tCOBIS.ADMREF.Office.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                              
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Office'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FGFilial', 'FGFilialClass', 'COBISCorp.tCOBIS.ADMREF.Office', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Filiales') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Filiales', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Filiales'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Oficinas                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: AS.Oficinas'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from an_page where pa_name = 'AS.Oficinas') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Oficinas', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Parámetros'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Oficinas', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.Ref.FGOficinaClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
print 'Registros para: AS.ADM.Ref.FGOficinaClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FGOficinaClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Mantenimiento', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Oficinas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FGOficinaClass', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                            
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Office') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Office', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                           
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Office'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Office') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Office', 'COBISCorp.tCOBIS.ADMREF.Office.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                              
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Office'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FGOficina', 'FGOficinaClass', 'COBISCorp.tCOBIS.ADMREF.Office', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Mantenimiento') begin                                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Mantenimiento', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                             
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Mantenimiento'                                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.Ref.FCopiajerarquiaClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
print 'Registros para: AS.ADM.Ref.FCopiajerarquiaClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FCopiajerarquiaClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                             
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Copiar Jerarquía Departamental', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Oficinas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FCopiajerarquiaClass', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                      
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Depart') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Depart', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                           
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Depart'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Depart') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Depart', 'COBISCorp.tCOBIS.ADMREF.Depart.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                              
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Depart'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FCopiajerarquia', 'FCopiajerarquiaClass', 'COBISCorp.tCOBIS.ADMREF.Depart', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                            
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Copiar Jerarquía Departamental') begin                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Copiar Jerarquía Departamental', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                            
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Copiar Jerarquía Departamental'                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.Ref.FGDepartamentosClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
print 'Registros para: AS.ADM.Ref.FGDepartamentosClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FGDepartamentosClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                             
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Departamentos', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Parámetros'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FGDepartamentosClass', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                      
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Depart') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Depart', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                           
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Depart'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Depart') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Depart', 'COBISCorp.tCOBIS.ADMREF.Depart.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                              
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Depart'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FGDepartamentos', 'FGDepartamentosClass', 'COBISCorp.tCOBIS.ADMREF.Depart', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                            
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Departamentos') begin                                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Departamentos', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                             
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Departamentos'                                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.Ref.FParGeneralesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
print 'Registros para: AS.ADM.Ref.FParGeneralesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FParGeneralesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Parámetros Generales', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Parámetros'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FParGeneralesClass', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Config') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Config', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                           
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Config'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Config') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Config', 'COBISCorp.tCOBIS.ADMREF.Config.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                              
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Config'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FParGenerales', 'FParGeneralesClass', 'COBISCorp.tCOBIS.ADMREF.Config', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Parámetros Generales') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Parámetros Generales', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                      
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Parámetros Generales'                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

-- Registros para: AS.ADM.Ref.FSeguridadClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
print 'Registros para: AS.ADM.Ref.FSeguridadClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FSeguridadClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Autorización de Usuarios', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Parámetros'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FSeguridadClass', 'icono pagina', @w_pa_id_parent, 5, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Rates') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Rates', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                           
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Rates'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Rates') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Rates', 'COBISCorp.tCOBIS.ADMREF.Rates.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                              
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Rates'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FSeguridad', 'FSeguridadClass', 'COBISCorp.tCOBIS.ADMREF.Rates', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Autorización de Usuarios') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Autorización de Usuarios', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                      
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Autorización de Usuarios'                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
------------------------------------------------------------------------------------------------
-- JHI: SE COMENTA USO DE ESTA PANTALLA, YA QUE LA MISMA EXISTE EN EL MODULO DE TESORERIA COBIS
------------------------------------------------------------------------------------------------
-- Registros para: AS.ADM.Ref.FGTasasClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: AS.ADM.Ref.FGTasasClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FGTasasClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Tasas Referenciales', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Parámetros'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FGTasasClass', 'icono pagina', @w_pa_id_parent, 6, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Rates') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Rates', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                            
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Rates'                                                                                                                                                                                                                                                                                                                                                                                                                                     
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Rates') begin                                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Rates', 'COBISCorp.tCOBIS.ADMREF.Rates.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Rates'                                                                                                                                                                                                                                                                                                                                                                                                                                           
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FGTasas', 'FGTasasClass', 'COBISCorp.tCOBIS.ADMREF.Rates', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                             
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Tasas Referenciales') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Tasas Referenciales', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                       
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Tasas Referenciales'                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

------------------------------------------------------------------------------------------------
-- JHI: SE COMENTA USO DE ESTA PANTALLA, YA QUE LA MISMA EXISTE EN EL MODULO DE TESORERIA COBIS
------------------------------------------------------------------------------------------------
-- Registros para: AS.ADM.Ref.FMCaracTasasClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: AS.ADM.Ref.FMCaracTasasClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FMCaracTasasClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Características de Tasas', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Parámetros'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FMCaracTasasClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                         
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Rates') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Rates', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                            
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Rates'                                                                                                                                                                                                                                                                                                                                                                                                                                     
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Rates') begin                                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Rates', 'COBISCorp.tCOBIS.ADMREF.Rates.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Rates'                                                                                                                                                                                                                                                                                                                                                                                                                                           
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FMCaracTasas', 'FMCaracTasasClass', 'COBISCorp.tCOBIS.ADMREF.Rates', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                   
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Características de Tasas') begin                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Características de Tasas', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Características de Tasas'                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

------------------------------------------------------------------------------------------------
-- JHI: SE COMENTA USO DE ESTA PANTALLA, YA QUE LA MISMA EXISTE EN EL MODULO DE TESORERIA COBIS
------------------------------------------------------------------------------------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.Ref.FFManPzClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: AS.ADM.Ref.FFManPzClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FFManPzClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Pizarra', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Parámetros'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FFManPzClass', 'icono pagina', @w_pa_id_parent, 8, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null,1)                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Rates') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Rates', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                            
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Rates'                                                                                                                                                                                                                                                                                                                                                                                                                                     
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Rates') begin                                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Rates', 'COBISCorp.tCOBIS.ADMREF.Rates.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Rates'                                                                                                                                                                                                                                                                                                                                                                                                                                           
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FFManPz', 'FFManPzClass', 'COBISCorp.tCOBIS.ADMREF.Rates', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                             
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Pizarra') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Pizarra', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Pizarra'                                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
------------------------------------------------------------------------------------------------
-- JHI: SE COMENTA USO DE ESTA PANTALLA, YA QUE LA MISMA EXISTE EN EL MODULO DE TESORERIA COBIS
------------------------------------------------------------------------------------------------
-- Registros para: AS.ADM.Ref.FFMonedaClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
 print 'Registros para: AS.ADM.Ref.FFMonedaClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
 if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FFMonedaClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
 declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
 select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
 select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
 select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
 insert into an_label values (@w_la_id, @w_la_cod, 'Relación  Monedas/Dolar', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                   
 select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
 select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Parámetros'                                                                                                                                                                                                                                                                                                                                                                                                                                               
 insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FFMonedaClass', 'icono pagina', @w_pa_id_parent, 9, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null,1)                                                                                                                                                                                                                                                                                                                                                             
 insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
 if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Rates') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
 select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
 insert into an_module_group values (@w_mg_id, 'ADM.Ref.Rates', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                            
 end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Rates'                                                                                                                                                                                                                                                                                                                                                                                                                                     
 if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Rates') begin                                                                                                                                                                                                                                                                                                                                                                                                                                             
 select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Rates', 'COBISCorp.tCOBIS.ADMREF.Rates.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                
 end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Rates'                                                                                                                                                                                                                                                                                                                                                                                                                                           
 if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
 select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
 insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FFMoneda', 'FFMonedaClass', 'COBISCorp.tCOBIS.ADMREF.Rates', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                           
 insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
 if not exists (select 1 from an_label where la_label = 'Relación  Monedas/Dolar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
 select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
 insert into an_label values (@w_la_id, @w_la_cod, 'Relación  Monedas/Dolar', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                   
 end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
 else select @w_la_id = la_id from an_label where la_label = 'Relación  Monedas/Dolar'                                                                                                                                                                                                                                                                                                                                                                                                                                     
 select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
 if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
 if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
 insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
 end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
 end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
 go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Consultas-1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
print 'Registros para: AS.Consultas-1'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
if not exists (select 1 from an_page where pa_name = 'AS.Consultas-1') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consultas', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Parámetros'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Consultas-1', 'icono pagina', @w_pa_id_parent, 10, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                                       
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.Ref.FConsFilialesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
print 'Registros para: AS.ADM.Ref.FConsFilialesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FConsFilialesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Filiales', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas-1'                                                                                                                                                                                                                                                                                                                                                                                                                                              
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FConsFilialesClass', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Query', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                            
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                     
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Query', 'COBISCorp.tCOBIS.ADMREF.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                           
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FConsFiliales', 'FConsFilialesClass', 'COBISCorp.tCOBIS.ADMREF.Query', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                 
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Filiales') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Filiales', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Filiales'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.Ref.FConsOficinasClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
print 'Registros para: AS.ADM.Ref.FConsOficinasClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FConsOficinasClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Oficinas por Filial', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas-1'                                                                                                                                                                                                                                                                                                                                                                                                                                              
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FConsOficinasClass', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Query', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                            
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                     
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Query', 'COBISCorp.tCOBIS.ADMREF.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                           
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FConsOficinas', 'FConsOficinasClass', 'COBISCorp.tCOBIS.ADMREF.Query', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                 
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Oficinas por Filial') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Oficinas por Filial', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                       
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Oficinas por Filial'                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.Ref.FConsDepartamentosClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
print 'Registros para: AS.ADM.Ref.FConsDepartamentosClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FConsDepartamentosClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                          
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Departamentos por Oficina', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas-1'                                                                                                                                                                                                                                                                                                                                                                                                                                              
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FConsDepartamentosClass', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                   
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Query', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                            
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                     
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Query', 'COBISCorp.tCOBIS.ADMREF.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                           
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FConsDepartamentos', 'FConsDepartamentosClass', 'COBISCorp.tCOBIS.ADMREF.Query', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                       
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Departamentos por Oficina') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Departamentos por Oficina', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                 
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Departamentos por Oficina'                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.Ref.FConsJerDepClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: AS.ADM.Ref.FConsJerDepClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FConsJerDepClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Jerárquico de Departamentos', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas-1'                                                                                                                                                                                                                                                                                                                                                                                                                                              
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FConsJerDepClass', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Query', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                            
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                     
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Query', 'COBISCorp.tCOBIS.ADMREF.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                           
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FConsJerDep', 'FConsJerDepClass', 'COBISCorp.tCOBIS.ADMREF.Query', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                     
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Jerárquico de Departamentos') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Jerárquico de Departamentos', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                               
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Jerárquico de Departamentos'                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                        


/*                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-- Registros para: AS.ADM.Ref.FcondetofiClass 
print 'Registros de Opción de MENU: Consulta detallada de Oficinas'
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FcondetofiClass')
begin
   declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int, @wd_parent_module int
   select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
   select @w_la_cod = 'ES_EC'
   select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label
   insert into an_label values (@w_la_id, @w_la_cod, 'Consulta detallada de Oficinas', 'M-ADM.Ref')
   select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page
   select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas-1'
   insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id)
   values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FcondetofiClass', 'icono pagina', @w_pa_id_parent, 5, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null)
   insert into an_role_page values (@w_pa_id, @w_rol)
   if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end
   select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Query'

   if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)
   select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component
   insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.Fcondetofi', 'FcondetofiClass', 'COBISCorp.tCOBIS.ADMREF.Query', 'SV', '', 'M-ADM.Ref')
   insert into an_role_component values (@w_co_id, @w_rol)

   select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone
   if @w_pz_id is null select @w_pz_id = 1

   if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
      insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
   end
end
go
*/                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Catálogo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: AS.Catálogo'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from an_page where pa_name = 'AS.Catálogo') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Catálogo', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Definción de Referencias'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Catálogo', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.Ref.FMantCatalogoClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
print 'Registros para: AS.ADM.Ref.FMantCatalogoClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FMantCatalogoClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Mantenimiento de Datos', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Catálogo'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FMantCatalogoClass', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Catalog') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Catalog', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                          
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Catalog'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Catalog') begin                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Catalog', 'COBISCorp.tCOBIS.ADMREF.Catalog.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                            
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Catalog'                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FMantCatalogo', 'FMantCatalogoClass', 'COBISCorp.tCOBIS.ADMREF.Catalog', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                               
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Mantenimiento de Datos') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Mantenimiento de Datos', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                    
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Mantenimiento de Datos'                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.Ref.FDefaultsClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
print 'Registros para: AS.ADM.Ref.FDefaultsClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FDefaultsClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Defaults por Oficina', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Catálogo'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FDefaultsClass', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                            
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Config') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Config', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                           
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Config'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Config') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Config', 'COBISCorp.tCOBIS.ADMREF.Config.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                              
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Config'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FDefaults', 'FDefaultsClass', 'COBISCorp.tCOBIS.ADMREF.Config', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Defaults por Oficina') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Defaults por Oficina', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                      
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Defaults por Oficina'                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.Ref.FGTablasClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
print 'Registros para: AS.ADM.Ref.FGTablasClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FGTablasClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Mantenimiento de Tablas', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Catálogo'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FGTablasClass', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                             
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Catalog') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Catalog', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                          
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Catalog'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Catalog') begin                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Catalog', 'COBISCorp.tCOBIS.ADMREF.Catalog.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                            
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Catalog'                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FGTablas', 'FGTablasClass', 'COBISCorp.tCOBIS.ADMREF.Catalog', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                         
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Mantenimiento de Tablas') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Mantenimiento de Tablas', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                   
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Mantenimiento de Tablas'                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.Ref.FTabProductoClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: AS.ADM.Ref.FTabProductoClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FTabProductoClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Asignación de Tablas a Productos', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Catálogo'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FTabProductoClass', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                         
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Catalog') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Catalog', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                          
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Catalog'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Catalog') begin                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Catalog', 'COBISCorp.tCOBIS.ADMREF.Catalog.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                            
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Catalog'                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FTabProducto', 'FTabProductoClass', 'COBISCorp.tCOBIS.ADMREF.Catalog', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                 
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Asignación de Tablas a Productos') begin                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Asignación de Tablas a Productos', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                          
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Asignación de Tablas a Productos'                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

/*
MIGRACION DE SAYBASE A SQLSERVER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.Ref.FVigenciaTablasClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
print 'Registros para: AS.ADM.Ref.FVigenciaTablasClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FVigenciaTablasClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                             
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Vigencia de Tablas', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Catálogo'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FVigenciaTablasClass', 'icono pagina', @w_pa_id_parent, 5, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                      
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Catalog') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Catalog', '4.0.0.0', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                          
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Catalog'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Catalog') begin                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Catalog', 'COBISCorp.tCOBIS.ADMREF.Catalog.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                            
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Catalog'                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FVigenciaTablas', 'FVigenciaTablasClass', 'COBISCorp.tCOBIS.ADMREF.Catalog', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                           
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Vigencia de Tablas') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Vigencia de Tablas', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Vigencia de Tablas'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
*/                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADM.Ref.FGMenErrorClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
print 'Registros para: AS.ADM.Ref.FGMenErrorClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
if not exists (select 1 from an_page where pa_name = 'AS.ADM.Ref.FGMenErrorClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                  
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Mensajes de Error', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Catálogo'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADM.Ref.FGMenErrorClass', 'icono pagina', @w_pa_id_parent, 6, 'horizontal', 'Nemonic', 'M-ADM.Ref', '', null, 1)                                                                                                                                                                                                                                                                                                                                                           
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADM.Ref.Config') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADM.Ref.Config', '4.0.0.1', 'http://[servername]/Admin/ADM.Ref/ADM.Ref.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                           
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADM.Ref.Config'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module where mo_name = 'ADM.Ref.Config') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADM.Ref.Config', 'COBISCorp.tCOBIS.ADMREF.Config.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                              
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Config'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADM.Ref.FGMenError', 'FGMenErrorClass', 'COBISCorp.tCOBIS.ADMREF.Config', 'SV', '', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                      
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Mensajes de Error') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Mensajes de Error', 'M-ADM.Ref')                                                                                                                                                                                                                                                                                                                                                                                                                                         
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Mensajes de Error'                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Definición de Seguridades                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: AS.Definición de Seguridades'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'AS.Definición de Seguridades') begin                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Definición de Seguridades', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Administración del Sistema'                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Definición de Seguridades', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Funcionarios                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
print 'Registros para: AS.Funcionarios'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page where pa_name = 'AS.Funcionarios') begin                                                                                                                                                                                                                                                                                                                                                                                                                                             
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Funcionarios', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Definición de Seguridades'                                                                                                                                                                                                                                                                                                                                                                                                                                
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Funcionarios', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                                       
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FFuncionariosClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: AS.ADMSEG.FFuncionariosClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FFuncionariosClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Ingresar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Funcionarios'                                                                                                                                                                                                                                                                                                                                                                                                                                             
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FFuncionariosClass', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.Seg', 'VGModoFuncion1=1;Operacion=INSERTAR;ResourceProvider=210', null, 1)                                                                                                                                                                                                                                                                                                  
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Functional', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                          
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Functional', 'COBISCorp.tCOBIS.ADMSEG.Functional.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                       
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FFuncionarios', 'FFuncionariosClass', 'COBISCorp.tCOBIS.ADMSEG.Functional', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Ingresar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Ingresar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Ingresar'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FGFuncionariosClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
print 'Registros para: AS.ADMSEG.FGFuncionariosClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FGFuncionariosClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Actualizar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Funcionarios'                                                                                                                                                                                                                                                                                                                                                                                                                                             
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FGFuncionariosClass', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.Seg', 'VGModoFuncion2=1;Operacion=ACTUALIZAR;ResourceProvider=215', null, 1)                                                                                                                                                                                                                                                                                               
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Functional', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                          
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Functional', 'COBISCorp.tCOBIS.ADMSEG.Functional.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                       
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FGFuncionarios', 'FGFuncionariosClass', 'COBISCorp.tCOBIS.ADMSEG.Functional', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                            
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Actualizar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Actualizar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                 
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Actualizar'                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FGFuncionariosClassEliminar                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: AS.ADMSEG.FGFuncionariosClassEliminar'                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FGFuncionariosClassEliminar') begin                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int, @w_co_name varchar(50), @w_co_class varchar(30)
select @w_co_name = 'ADMSEG.FGFuncionarios'
select @w_co_class = 'FGFuncionariosClass'
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Eliminar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Funcionarios'                                                                                                                                                                                                                                                                                                                                                                                                                                             
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FGFuncionariosClassEliminar', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADM.Seg', 'VGModoFuncion2=2;Operacion=ELIMINAR;ResourceProvider=220', null, 1)                                                                                                                                                                                                                                                                                         
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Functional', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                          
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Functional', 'COBISCorp.tCOBIS.ADMSEG.Functional.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                       
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    

--JHI
if not exists (select * from an_component where co_name = @w_co_name and co_class  = @w_co_class)
begin
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, @w_co_name, @w_co_class, 'COBISCorp.tCOBIS.ADMSEG.Functional', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                            
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end
else select @w_co_id = co_id from an_component where co_name = @w_co_name and co_class  = @w_co_class
--JHI

if not exists (select 1 from an_label where la_label = 'Eliminar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Eliminar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Eliminar'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Oficiales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: AS.Oficiales'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'AS.Oficiales') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Oficiales', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Funcionarios'                                                                                                                                                                                                                                                                                                                                                                                                                                             
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Oficiales', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FTran2514Class                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
print 'Registros para: AS.ADMSEG.FTran2514Class'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FTran2514Class') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Mantenimiento', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Oficiales'                                                                                                                                                                                                                                                                                                                                                                                                                                                
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FTran2514Class', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Functional', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                          
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Functional', 'COBISCorp.tCOBIS.ADMSEG.Functional.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                       
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FTran2514', 'FTran2514Class', 'COBISCorp.tCOBIS.ADMSEG.Functional', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                      
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Mantenimiento') begin                                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Mantenimiento', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Mantenimiento'                                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FTran2517Class                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
print 'Registros para: AS.ADMSEG.FTran2517Class'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FTran2517Class') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Oficial Sustituto', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Oficiales'                                                                                                                                                                                                                                                                                                                                                                                                                                                
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FTran2517Class', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Functional', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                          
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Functional', 'COBISCorp.tCOBIS.ADMSEG.Functional.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                       
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FTran2517', 'FTran2517Class', 'COBISCorp.tCOBIS.ADMSEG.Functional', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                      
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Oficial Sustituto') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Oficial Sustituto', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                          
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Oficial Sustituto'                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FUsuarioLoginClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: AS.ADMSEG.FUsuarioLoginClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FUsuarioLoginClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Login en Nodos', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Funcionarios'                                                                                                                                                                                                                                                                                                                                                                                                                                             
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FUsuarioLoginClass', 'icono pagina', @w_pa_id_parent, 5, 'horizontal', 'Nemonic', 'M-ADM.Seg', 'VGModoLogin=0', null, 1)                                                                                                                                                                                                                                                                                                                                             
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Functional', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                          
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Functional', 'COBISCorp.tCOBIS.ADMSEG.Functional.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                       
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FUsuarioLogin', 'FUsuarioLoginClass', 'COBISCorp.tCOBIS.ADMSEG.Functional', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Login en Nodos') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Login en Nodos', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                             
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Login en Nodos'                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FRolesUsuarioClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: AS.ADMSEG.FRolesUsuarioClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FRolesUsuarioClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Roles de Funcionario', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Funcionarios'                                                                                                                                                                                                                                                                                                                                                                                                                                             
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FRolesUsuarioClass', 'icono pagina', @w_pa_id_parent, 6, 'horizontal', 'Nemonic', 'M-ADM.Seg', 'VGModoRolUsuario=0', null, 1)                                                                                                                                                                                                                                                                                                                                        
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Functional', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                          
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Functional', 'COBISCorp.tCOBIS.ADMSEG.Functional.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                       
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FRolesUsuario', 'FRolesUsuarioClass', 'COBISCorp.tCOBIS.ADMSEG.Functional', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Roles de Funcionario') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Roles de Funcionario', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                       
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Roles de Funcionario'                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FOperadorClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
print 'Registros para: AS.ADMSEG.FOperadorClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FOperadorClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Operadores de Batch', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Funcionarios'                                                                                                                                                                                                                                                                                                                                                                                                                                             
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FOperadorClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Functional', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                          
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Functional', 'COBISCorp.tCOBIS.ADMSEG.Functional.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                       
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FOperador', 'FOperadorClass', 'COBISCorp.tCOBIS.ADMSEG.Functional', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                      
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Operadores de Batch') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Operadores de Batch', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Operadores de Batch'                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FAsiCargosClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
print 'Registros para: AS.ADMSEG.FAsiCargosClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FAsiCargosClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Asignación de Cargos a Departamentos', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Funcionarios'                                                                                                                                                                                                                                                                                                                                                                                                                                             
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FAsiCargosClass', 'icono pagina', @w_pa_id_parent, 8, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                             
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Functional', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                          
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Functional', 'COBISCorp.tCOBIS.ADMSEG.Functional.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                       
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FAsiCargos', 'FAsiCargosClass', 'COBISCorp.tCOBIS.ADMSEG.Functional', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                    
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Asignación de Cargos a Departamentos') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Asignación de Cargos a Departamentos', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                       
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Asignación de Cargos a Departamentos'                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go   


-- Registros para: AS.ADMSEG.FDesbloqueoUsuarioClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
print 'Registros para: AS.ADMSEG.FDesbloqueoUsuarioClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FDesbloqueoUsuarioClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int, @w_co_name varchar(50), @w_co_class varchar(30)
select @w_co_name = 'ADMSEG.FDesbloqueoUsuario' --'ADMSEG.FGFuncionarios'
select @w_co_class = 'FDesbloqueoUsuarioClass'
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Desbloqueo de Funcionario', 'M-ADM.Seg')   
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Funcionarios'                                                                                                                                                                                                                                                                                                                                                                                                                                             
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FDesbloqueoUsuarioClass', 'icono pagina', @w_pa_id_parent, 9, 'horizontal', 'Nemonic', 'M-ADM.Seg', ' ', null, 1)                                                                                                                                                                                                                                                                                               
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Functional', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                          
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Functional', 'COBISCorp.tCOBIS.ADMSEG.Functional.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                       
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    

--JHI
if not exists (select * from an_component where co_name = @w_co_name and co_class  = @w_co_class)
begin
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, @w_co_name, @w_co_class, 'COBISCorp.tCOBIS.ADMSEG.Functional', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                            
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end
else select @w_co_id = co_id from an_component where co_name = @w_co_name and co_class  = @w_co_class
--JHI

if not exists (select 1 from an_label where la_label = 'Desbloqueo de Funcionario') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Desbloqueo de Funcionario', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                 
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Desbloqueo de Funcionario'                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            

-- Registros para: AS.ADMSEG.FComplejidadClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
print 'Registros para: AS.ADMSEG.FComplejidadClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FComplejidadClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int, @w_co_name varchar(50), @w_co_class varchar(30)
select @w_co_name = 'ADMSEG.FComplejidad' --'ADMSEG.FGFuncionarios'
select @w_co_class = 'FComplejidadClass'
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Complejidad de Password', 'M-ADM.Seg')   
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Funcionarios'                                                                                                                                                                                                                                                                                                                                                                                                                                             
insert into an_page (pa_id,pa_la_id,pa_name,pa_icon,pa_id_parent,pa_order,pa_splitter,pa_nemonic,pa_prod_name,pa_arguments,pa_he_id) 
values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FComplejidadClass', 'icono pagina', @w_pa_id_parent, 10, 'horizontal', 'Nemonic', 'M-ADM.Seg', ' ', null)                                                                                                                                                                                                                                                                                               
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Functional', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                          
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Functional') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Functional', 'COBISCorp.tCOBIS.ADMSEG.Functional.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                       
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Functional'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FComplejidad', 'FComplejidadClass', 'COBISCorp.tCOBIS.ADMSEG.Functional', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                      
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Complejidad de Password') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Complejidad de Password', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Complejidad de Password'                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go

-- Registros para: AS.Consultas3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
print 'Registros para: AS.Consultas3'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_page where pa_name = 'AS.Consultas3') begin                                                                                                                                                                                                                                                                                                                                                                                                                                               
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consultas', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Definición de Seguridades'                                                                                                                                                                                                                                                                                                                                                                                                                                
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Consultas3', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                                         
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go   

-- Registros para: AS.ADMSEG.FTranServicioClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: AS.ADMSEG.FTranServicioClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FTranServicioClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consulta de Transacciones de Servicio', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas3'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FTranServicioClass', 'icono pagina', @w_pa_id_parent, 9, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                               
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Query', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Query', 'COBISCorp.tCOBIS.ADMSEG.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                 
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.Ftrnserv', 'FTranServicioClass', 'COBISCorp.tCOBIS.ADMSEG.Query', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                             
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Consulta de Transacciones de Servicio') begin                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consulta de Transacciones de Servicio', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Consulta de Transacciones de Servicio'                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end    
go
 
-- Registros para: AS.ADMSEG.FConexClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
print 'Registros de Opción de MENU: Consulta de Conexiones'
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FConexClass')
begin
   declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int, @wd_parent_module int
   select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
   select @w_la_cod = 'ES_EC'
   select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label
   insert into an_label values (@w_la_id, @w_la_cod, 'Consulta de Conexiones', 'M-ADM.Seg')
   select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page
   select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas3'
   insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id)
   values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FConexClass', 'icono pagina', @w_pa_id_parent, 10, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null)
   insert into an_role_page values (@w_pa_id, @w_rol)
   if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end
   select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Query'

   if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)
   select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component
   insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FConex', 'FConexClass', 'COBISCorp.tCOBIS.ADMSEG.Query', 'SV', '', 'M-ADM.Seg')
   insert into an_role_component values (@w_co_id, @w_rol)

   select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone
   if @w_pz_id is null select @w_pz_id = 1

   if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
      insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
   end
end
go


-- Registros para: AS.ADMSEG.FConexFallidaClass   
declare @w_la_label varchar(255),@w_prod_name varchar(20),@w_rol_des varchar(255),@w_pa_parent varchar(255),@w_pa_name varchar(255),
		@w_orden int,@w_mo_name varchar(255),@w_co_name varchar(255),@w_co_class varchar(255),@w_co_namespace varchar(255)
select  @w_la_label 	= 'Consulta de Conexiones Fallidas',
		@w_prod_name 	= 'M-ADM.Seg',
		@w_rol_des 		= 'MENU POR PROCESOS',
		@w_pa_parent 	= 'AS.Consultas3',
		@w_pa_name 		= 'AS.ADMSEG.FConexFallidaClass',
		@w_orden 		= 12,
		@w_mo_name		= 'ADMSEG.Query',
		@w_co_name 		= 'ADMSEG.FConexFallida',
		@w_co_class 	= 'FConexFallidaClass',
		@w_co_namespace = 'COBISCorp.tCOBIS.ADMSEG.Query'
		
print 'Registros de Opción de MENU: ' + @w_la_label
if not exists (select 1 from an_page where pa_name = @w_pa_name)
begin
	declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int, @wd_parent_module int
	select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
	select @w_la_cod = 'ES_EC'
	select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label
	insert into an_label values (@w_la_id, @w_la_cod, @w_la_label, @w_prod_name)
	select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page
	select @w_pa_id_parent = pa_id from an_page where pa_name = @w_pa_parent
	insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id)
	values (@w_pa_id, @w_la_id, @w_pa_name, 'icono pagina', @w_pa_id_parent, @w_orden, 'horizontal', 'Nemonic', @w_prod_name, '', null)
	insert into an_role_page values (@w_pa_id, @w_rol)
	if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end
	select @w_mo_id = mo_id from an_module where mo_name = @w_mo_name

	if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)
	select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component
	insert into an_component values (@w_co_id, @w_mo_id, @w_co_name, @w_co_class, @w_co_namespace, 'SV', '', @w_prod_name)
	insert into an_role_component values (@w_co_id, @w_rol)

	select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone
	if @w_pz_id is null select @w_pz_id = 1

	if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
		insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
	end
end
go


-- Registros para: AS.Roles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
print 'Registros para: AS.Roles'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_page where pa_name = 'AS.Roles') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                    
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Roles', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Definición de Seguridades'                                                                                                                                                                                                                                                                                                                                                                                                                                
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Roles', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FRolesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: AS.ADMSEG.FRolesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FRolesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Ingresar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Roles'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FRolesClass', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.Seg', 'VGModoRoles=1;Operacion=INSERTAR;ResourceProvider=305', null, 1)                                                                                                                                                                                                                                                                                                            
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Role') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Role', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                                
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Role'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Role') begin                                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Role', 'COBISCorp.tCOBIS.ADMSEG.Role.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Role'                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FRoles', 'FRolesClass', 'COBISCorp.tCOBIS.ADMSEG.Role', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Ingresar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Ingresar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Ingresar'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FGRolesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
print 'Registros para: AS.ADMSEG.FGRolesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FGRolesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Actualizar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Roles'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FGRolesClass', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.Seg', 'VGModoRoles=2;Operacion=ACTUALIZAR;ResourceProvider=310', null, 1)                                                                                                                                                                                                                                                                                                         
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Role') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Role', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                                
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Role'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Role') begin                                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Role', 'COBISCorp.tCOBIS.ADMSEG.Role.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Role'                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FGRoles', 'FGRolesClass', 'COBISCorp.tCOBIS.ADMSEG.Role', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Actualizar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Actualizar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                 
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Actualizar'                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FGRolesClassEliminar                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
print 'Registros para: AS.ADMSEG.FGRolesClassEliminar'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FGRolesClassEliminar') begin                                                                                                                                                                                                                                                                                                                                                                                                                              
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int, @w_co_name varchar(50), @w_co_class varchar(30)
select @w_co_name = 'ADMSEG.FGRoles'
select @w_co_class = 'FGRolesClass'
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Eliminar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Roles'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FGRolesClassEliminar', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADM.Seg', 'VGModoRoles=3;Operacion=ELIMINAR;ResourceProvider=315', null, 1)                                                                                                                                                                                                                                                                                                  
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Role') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Role', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                                
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Role'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Role') begin                                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Role', 'COBISCorp.tCOBIS.ADMSEG.Role.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Role'                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    

--JHI
if not exists (select * from an_component where co_name = @w_co_name and co_class  = @w_co_class)
begin
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, @w_co_name, @w_co_class, 'COBISCorp.tCOBIS.ADMSEG.Role', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end
else select @w_co_id = co_id from an_component where co_name = @w_co_name and co_class  = @w_co_class
--JHI

if not exists (select 1 from an_label where la_label = 'Eliminar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Eliminar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Eliminar'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FCopiarolesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
print 'Registros para: AS.ADMSEG.FCopiarolesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FCopiarolesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                  
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Copiar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Roles'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FCopiarolesClass', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                            
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Role') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Role', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                                
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Role'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Role') begin                                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Role', 'COBISCorp.tCOBIS.ADMSEG.Role.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Role'                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FCopiaroles', 'FCopiarolesClass', 'COBISCorp.tCOBIS.ADMSEG.Role', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Copiar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Copiar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                     
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Copiar'                                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
-- Registros para: AS.ADMSEG.FProductosRolClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: AS.ADMSEG.FProductosRolClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FProductosRolClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Productos por Rol', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Roles'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FProductosRolClass', 'icono pagina', @w_pa_id_parent, 5, 'horizontal', 'Nemonic', 'M-ADM.Seg', 'VGModoProdRol=0', null, 1)                                                                                                                                                                                                                                                                                                                                           
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Role') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Role', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                                
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Role'                                                                                                                                                                                                                                                                                                                                                                                                                                       
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Role') begin                                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Role', 'COBISCorp.tCOBIS.ADMSEG.Role.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Role'                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FProductosRol', 'FProductosRolClass', 'COBISCorp.tCOBIS.ADMSEG.Role', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                    
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Productos por Rol') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Productos por Rol', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                          
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Productos por Rol'                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
             
declare @w_page_parent varchar(255), @w_pagina varchar(255), @w_pagina_compo varchar(255), @w_label  varchar(255),@w_componente varchar(255), @w_prodname varchar(255), @w_module varchar(255), @w_filename varchar(255), @w_clase varchar(255), @w_nivel integer
select @w_page_parent = 'AS.Roles',
 @w_pagina = 'AS.ADMSEG.FTransacxFuncionalidadClass',
 @w_pagina_compo = 'FTransacxFuncionalidadClass',
 @w_label = 'Transacciones por Funcionalidad',
 @w_componente = 'ADMSEG.FTransacFun',
 @w_prodname = 'M-ADM.Seg',
 @w_module = 'ADMSEG.Role',
 @w_filename = 'COBISCorp.tCOBIS.ADMSEG.Role.dll',
 @w_clase = 'COBISCorp.tCOBIS.ADMSEG.Role',
 @w_nivel = 6                    
                                                                                                                                                                                                                                                                                                                                                                                                                                           
-- Registros para: AS.ADMSEG.FTransacxFuncionalidadClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: AS.ADMSEG.FTransacxFuncionalidadClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = @w_pagina) begin                                                                                                                                                                                                                                                                                                                                                                                                                                
   declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
   select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
   select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
   select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
   insert into an_label values (@w_la_id, @w_la_cod, @w_label, @w_prodname)                                                                                                                                                                                                                                                                                                                                                                                                                                          
   select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
   select @w_pa_id_parent = pa_id from an_page where pa_name = @w_page_parent    
   insert into an_page values (@w_pa_id, @w_la_id, @w_pagina, 'icono pagina', @w_pa_id_parent, @w_nivel, 'horizontal', 'Nemonic', @w_prodname, '', null, 1)
   insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
   if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
   if not exists (select 1 from an_module_group where mg_name = @w_module) begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
      select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
      insert into an_module_group values (@w_mg_id, @w_module, '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                                
   end else select @w_mg_id = mg_id from an_module_group where mg_name = @w_module                                                                                                                                                                                                                                                                                                                                                                                                                                       
   if not exists (select 1 from an_module where mo_name = @w_module) begin                                                                                                                                                                                                                                                                                                                                                                                                                                               
      select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
      insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, @w_module, @w_filename, 0, null)                                                                                                                                                                                                                                                                                                                                                                                                   
   end else select @w_mo_id = mo_id from an_module where mo_name = @w_module                                                                                                                                                                                                                                                                                                                                                                                                                                            
   if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
   select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
   insert into an_component values (@w_co_id, @w_mo_id, @w_componente, @w_pagina_compo, @w_clase, 'SV', '', @w_prodname)                                                                                                                                                                                                                                                                                                                                                                    
   insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
   if not exists (select 1 from an_label where la_label = @w_label) begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
      select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
      insert into an_label values (@w_la_id, @w_la_cod, @w_label, @w_prodname)                                                                                                                                                                                                                                                                                                                                                                                                                                          
   end else select @w_la_id = la_id from an_label where la_label = @w_label                                                                                                                                                                                                                                                                                                                                                                                                                                          
   select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
   if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
   if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
      insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
   end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                 

-- Registros para: AS.ADMSEG.SecurityManagementView
print 'Registros para: AS.ADMSEG.SecurityManagementView'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.SecurityManagementView') begin                                                                                                                                                                                                                                                                                                                                                                                                                                
   declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
   select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
   select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
   select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
   insert into an_label values (@w_la_id, @w_la_cod, 'Autorización de Funcionalidades', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                          
   select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
   select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Roles'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
   insert into an_page (pa_id,pa_la_id,pa_name,pa_icon,pa_id_parent,pa_order,pa_splitter,pa_nemonic,pa_prod_name,pa_arguments,pa_he_id) 
   --values (@w_pa_id, @w_la_id, 'AS.ADMSEG.SecurityManagementView', 'icono pagina', @w_pa_id_parent, 5, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null)                                                                                                                                                                                                                                                                                                                                           
   values (@w_pa_id, @w_la_id, 'AS.ADMSEG.SecurityManagementView', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null)                                                                                                                                                                                                                                                                                                                                           
   insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
   if not exists (select 1 from an_zone where zo_id = 9) begin  insert into an_zone values (9, 'Zona Vista Unica', 1, 0, 0, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
   if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Role') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
   select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
   insert into an_module_group values (@w_mg_id, 'ADMSEG.Role', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                                
   end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Role'                                                                                                                                                                                                                                                                                                                                                                                                                                       

   if not exists (select 1 from an_module where mo_name = 'ADMSEG.Role.AutFunc') begin                                                                                                                                                                                                                                                                                                                                                                                                                                               
   select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
   insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Role.AutFunc', 'COBISCorp.eCOBIS.Admin.AdmSecurity.View.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                   
   end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Role.AutFunc'                                                                                                                                                                                                                                                                                                                                                                                                                                             
   if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
   select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
   insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.SecurityManagement', 'SecurityManagementViewBase', 'COBISCorp.eCOBIS.Admin.AdmSecurity.View', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                    
   insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
   if not exists (select 1 from an_label where la_label = 'Autorización de Funcionalidades') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
   select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
   insert into an_label values (@w_la_id, @w_la_cod, 'Autorización de Funcionalidades', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                          
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Autorización de Funcionalidades'                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go 
         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.Horarios                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: AS.Horarios'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from an_page where pa_name = 'AS.Horarios') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Horarios', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Definición de Seguridades'                                                                                                                                                                                                                                                                                                                                                                                                                                
insert into an_page values (@w_pa_id, @w_la_id, 'AS.Horarios', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                                           
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FDefHorariosClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: AS.ADMSEG.FDefHorariosClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FDefHorariosClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Ingresar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Horarios'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FDefHorariosClass', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.Seg', 'Operacion=INSERTAR;FDefHorarios="Definición de Tipos de Horarios (Insertar);ResourceProvider=405"', null, 1)                                                                                                                                                                                                                                                           
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Schedule') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Schedule', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                            
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Schedule'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Schedule') begin                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Schedule', 'COBISCorp.tCOBIS.ADMSEG.Schedule.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                           
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Schedule'                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FDefHorarios', 'FDefHorariosClass', 'COBISCorp.tCOBIS.ADMSEG.Schedule', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                  
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Ingresar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Ingresar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Ingresar'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FGTiposHorarioClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
print 'Registros para: AS.ADMSEG.FGTiposHorarioClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FGTiposHorarioClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Actualizar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Horarios'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FGTiposHorarioClass', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.Seg', 'VGModoHorarios=1;Operacion=ACTUALIZAR;ResourceProvider=410', null, 1)                                                                                                                                                                                                                                                                                               
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Schedule') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Schedule', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                            
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Schedule'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Schedule') begin                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Schedule', 'COBISCorp.tCOBIS.ADMSEG.Schedule.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                           
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Schedule'                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FGTiposHorario', 'FGTiposHorarioClass', 'COBISCorp.tCOBIS.ADMSEG.Schedule', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Actualizar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Actualizar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                 
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Actualizar'                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FGTiposHorarioClassEliminar                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: AS.ADMSEG.FGTiposHorarioClassEliminar'                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FGTiposHorarioClassEliminar') begin                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int, @w_co_name varchar(50), @w_co_class varchar(30)
select @w_co_name = 'ADMSEG.FGTiposHorario'
select @w_co_class = 'FGTiposHorarioClass'
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Eliminar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Horarios'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FGTiposHorarioClassEliminar', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADM.Seg', 'VGModoHorarios=2;Operacion=ELIMINAR;ResourceProvider=415', null, 1)                                                                                                                                                                                                                                                                                         
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Schedule') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Schedule', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                            
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Schedule'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Schedule') begin                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Schedule', 'COBISCorp.tCOBIS.ADMSEG.Schedule.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                           
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Schedule'                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    

--JHI
if not exists (select * from an_component where co_name = @w_co_name and co_class  = @w_co_class)
begin
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, @w_co_name, @w_co_class, 'COBISCorp.tCOBIS.ADMSEG.Schedule', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end
else select @w_co_id = co_id from an_component where co_name = @w_co_name and co_class  = @w_co_class
--JHI

if not exists (select 1 from an_label where la_label = 'Eliminar') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Eliminar', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Eliminar'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FDiasNacionalesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
print 'Registros para: AS.ADMSEG.FDiasNacionalesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FDiasNacionalesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                              
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Calendario (Feriados Nacionales)', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Horarios'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FDiasNacionalesClass', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Schedule') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Schedule', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                            
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Schedule'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Schedule') begin                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Schedule', 'COBISCorp.tCOBIS.ADMSEG.Schedule.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                           
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Schedule'                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FDiasNacionales', 'FDiasNacionalesClass', 'COBISCorp.tCOBIS.ADMSEG.Schedule', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                            
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Calendario (Feriados Nacionales)') begin                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Calendario (Feriados Nacionales)', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                           
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Calendario (Feriados Nacionales)'                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

/*
----------
-- Registros para: AS.ADMSEG.FDIASNALBCOCENTRALClass
print 'Registros para: AS.ADMSEG.FDIASNALBCOCENTRALClass'
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FDIASNALBCOCENTRALClass') begin
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
select @w_la_cod = 'ES_EC'
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label
insert into an_label values (@w_la_id, @w_la_cod, 'Calendario (BANCO CENTRAL)', 'M-ADM.Seg')
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Horarios'
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FDIASNALBCOCENTRALClass', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)
insert into an_role_page values (@w_pa_id, @w_rol)
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Schedule') begin
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group
insert into an_module_group values (@w_mg_id, 'ADMSEG.Schedule', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Schedule'
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Schedule') begin
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Schedule', 'COBISCorp.tCOBIS.ADMSEG.Schedule.dll', 0, null)
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Schedule'
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FDIASNALBCOCENTRAL', 'FDIASNALBCOCENTRALClass', 'COBISCorp.tCOBIS.ADMSEG.Schedule', 'SV', '', 'M-ADM.Seg')
insert into an_role_component values (@w_co_id, @w_rol)
if not exists (select 1 from an_label where la_label = 'Calendario (BANCO CENTRAL)') begin
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label
insert into an_label values (@w_la_id, @w_la_cod, 'Calendario (BANCO CENTRAL)', 'M-ADM.Seg')
end
else select @w_la_id = la_id from an_label where la_label = 'Calendario (BANCO CENTRAL)'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
end
go

*/
---------- 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FCalendarioClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
print 'Registros para: AS.ADMSEG.FCalendarioClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FCalendarioClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                  
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Calendario (Feriados Ciudades)', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Horarios'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FCalendarioClass', 'icono pagina', @w_pa_id_parent, 5, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                            
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Schedule') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Schedule', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                            
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Schedule'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Schedule') begin                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Schedule', 'COBISCorp.tCOBIS.ADMSEG.Schedule.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                           
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Schedule'                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FCalendario', 'FCalendarioClass', 'COBISCorp.tCOBIS.ADMSEG.Schedule', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                    
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Calendario (Feriados Ciudades)') begin                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Calendario (Feriados Ciudades)', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                           
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Calendario (Feriados Ciudades)'                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FConsRolUsuClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
print 'Registros para: AS.ADMSEG.FConsRolUsuClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FConsRolUsuClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                  
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Roles por Usuario', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas3'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FConsRolUsuClass', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                            
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Query', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Query', 'COBISCorp.tCOBIS.ADMSEG.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                 
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FConsRolUsu', 'FConsRolUsuClass', 'COBISCorp.tCOBIS.ADMSEG.Query', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                       
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Roles por Usuario') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Roles por Usuario', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                          
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Roles por Usuario'                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FConsHorUsuClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
print 'Registros para: AS.ADMSEG.FConsHorUsuClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FConsHorUsuClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                  
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Horarios por Funcionario', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas3'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FConsHorUsuClass', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                            
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Query', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Query', 'COBISCorp.tCOBIS.ADMSEG.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                 
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FConsHorUsu', 'FConsHorUsuClass', 'COBISCorp.tCOBIS.ADMSEG.Query', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                       
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Horarios por Funcionario') begin                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Horarios por Funcionario', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                   
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Horarios por Funcionario'                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FConsUsuRolClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
print 'Registros para: AS.ADMSEG.FConsUsuRolClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FConsUsuRolClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                  
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Usuarios por Rol', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas3'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FConsUsuRolClass', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                            
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Query', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Query', 'COBISCorp.tCOBIS.ADMSEG.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                 
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FConsUsuRol', 'FConsUsuRolClass', 'COBISCorp.tCOBIS.ADMSEG.Query', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                       
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Usuarios por Rol') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Usuarios por Rol', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                           
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Usuarios por Rol'                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FConsProductosRolClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
print 'Registros para: AS.ADMSEG.FConsProductosRolClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FConsProductosRolClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                            
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Productos por Rol', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas3'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FConsProductosRolClass', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                      
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Query', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Query', 'COBISCorp.tCOBIS.ADMSEG.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                 
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FConsProductosRol', 'FConsProductosRolClass', 'COBISCorp.tCOBIS.ADMSEG.Query', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                           
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Productos por Rol') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Productos por Rol', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                          
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Productos por Rol'                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FConsTranAutClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: AS.ADMSEG.FConsTranAutClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FConsTranAutClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Transacciones Autorizadas', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas3'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FConsTranAutClass', 'icono pagina', @w_pa_id_parent, 5, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                           
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Query', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Query', 'COBISCorp.tCOBIS.ADMSEG.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                 
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FConsTranAut', 'FConsTranAutClass', 'COBISCorp.tCOBIS.ADMSEG.Query', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                     
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Transacciones Autorizadas') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Transacciones Autorizadas', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Transacciones Autorizadas'                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FConsUsuNodosClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: AS.ADMSEG.FConsUsuNodosClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FConsUsuNodosClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Usuario por Nodo', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas3'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FConsUsuNodosClass', 'icono pagina', @w_pa_id_parent, 6, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Query', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Query', 'COBISCorp.tCOBIS.ADMSEG.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                 
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FConsUsuNodos', 'FConsUsuNodosClass', 'COBISCorp.tCOBIS.ADMSEG.Query', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                   
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Usuario por Nodo') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Usuario por Nodo', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                           
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Usuario por Nodo'                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FConsRolesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
print 'Registros para: AS.ADMSEG.FConsRolesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FConsRolesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Roles Existentes', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas3'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FConsRolesClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                             
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Query', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Query', 'COBISCorp.tCOBIS.ADMSEG.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                 
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FConsRoles', 'FConsRolesClass', 'COBISCorp.tCOBIS.ADMSEG.Query', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                         
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Roles Existentes') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Roles Existentes', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                           
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Roles Existentes'                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FConsHorarioClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: AS.ADMSEG.FConsHorarioClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FConsHorarioClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Horarios Existentes', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas3'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FConsHorarioClass', 'icono pagina', @w_pa_id_parent, 8, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                           
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Query', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Query', 'COBISCorp.tCOBIS.ADMSEG.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                 
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FConsHorario', 'FConsHorarioClass', 'COBISCorp.tCOBIS.ADMSEG.Query', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                     
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Horarios Existentes') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Horarios Existentes', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Horarios Existentes'                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: AS.ADMSEG.FContranClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: AS.ADMSEG.FContranClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
if not exists (select 1 from an_page where pa_name = 'AS.ADMSEG.FContranClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Usuarios por Tran. Autorizada', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'AS.Consultas3'                                                                                                                                                                                                                                                                                                                                                                                                                                               
insert into an_page values (@w_pa_id, @w_la_id, 'AS.ADMSEG.FContranClass', 'icono pagina', @w_pa_id_parent, 9, 'horizontal', 'Nemonic', 'M-ADM.Seg', '', null, 1)                                                                                                                                                                                                                                                                                                                                                               
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMSEG.Query', '4.0.0.1', 'http://[servername]/Admin/ADMSEG/ADMSEG.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADMSEG.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Query', 'COBISCorp.tCOBIS.ADMSEG.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                 
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMSEG.FContran', 'FContranClass', 'COBISCorp.tCOBIS.ADMSEG.Query', 'SV', '', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                             
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Usuarios por Tran. Autorizada') begin                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Usuarios por Tran. Autorizada', 'M-ADM.Seg')                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Usuarios por Tran. Autorizada'                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               


/*
-- Registros para Control de Ambito
declare @w_pa_name varchar(255),
   @w_pa_id_label integer,
   @w_cod_label integer,
   @w_label varchar(100),
   @w_cod_page integer,
   @w_cod_component integer

select @w_pa_name = 'AS.ADMSEG.FAmbitoClass'
select @w_pa_id_label = pa_la_id from an_page where pa_name = @w_pa_name

--BORRA LABEL
print 'Borrando en an_label'
delete from an_label where la_id = @w_pa_id_label and la_prod_name = 'M-ADM.Seg'

--BORRA PAGE
select @w_cod_page = pa_id from an_page where pa_name = @w_pa_name

print 'Borrando en an_page'
delete from an_page where pa_id = @w_cod_page

print 'Borrando en an_page_rol'
delete from an_role_page where rp_pa_id = @w_cod_page

--BORRA PAGE_ZONE
select @w_cod_component = pz_co_id from an_page_zone  where pz_pa_id = @w_cod_page

print 'Borrando en an_page_zone'
delete from an_page_zone where pz_pa_id = @w_cod_page

--BORRA COMPONENT
print 'Borrando en an_component'
delete from an_component where co_id = @w_cod_component

print 'Borrando en an_role_component'
delete from an_role_component where rc_co_id = @w_cod_component

  
declare  @w_la_label varchar(255),
   @w_prod_name varchar(20),
   @w_rol_des varchar(255),
   @w_pa_parent varchar(255),
   --@w_pa_name varchar(255),
   @w_orden int,
   @w_mo_name varchar(255),
   @w_co_name varchar(255),
   @w_co_class varchar(255),
   @w_co_namespace varchar(255)

   
 
select  @w_la_label    = 'Control de ámbito',
   @w_prod_name    = 'M-ADM.Seg',
   @w_rol_des       = 'MENU POR PROCESOS',
   @w_pa_parent    = 'AS.Definición de Seguridades',
   @w_pa_name       = 'AS.ADMSEG.FAmbitoClass',
   @w_orden       = 5,
   @w_mo_name      = 'ADMSEG.Query',
   @w_co_name       = 'ADMSEG.FAmbitoClass',
   @w_co_class    = 'FAmbitoClass',
   @w_co_namespace = 'COBISCorp.tCOBIS.ADMSEG.Query'
   
print 'Registros de Opción de MENU: ' + @w_la_label
if not exists (select 1 from an_page where pa_name = @w_pa_name)
   begin
      declare @w_rol int, 
         @w_la_cod varchar(10), 
         @w_la_id int,
         @w_pa_id  int,
         @w_pa_id_parent int,
         @w_mg_id int,
         @w_mo_id int,
         @w_co_id int,
         @w_pz_id int,
         @wd_parent_module int

      --OBTENIENDO EL ROL
      select @w_rol = ro_rol from   ad_rol where  ro_descripcion = @w_rol_des
      select @w_la_cod = 'ES_EC'
      
      --OBTENIENDO EL MAXIMO SECUENCIAL DE LABEL
      select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label
      
      --INSERTANDO EL LABEL
      print 'Insertando en an_label: ' + @w_la_label
      insert into an_label values (@w_la_id, @w_la_cod, @w_la_label, @w_prod_name)
      
      --SELECCIONANDO EL MAXIMO SECUENCIAL DE AN_PAGE
      select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page
      select @w_pa_id_parent = pa_id from an_page where pa_name = @w_pa_parent
      
      --INSERTANDO EN LA AN_PAGE
      print 'Insertando en an_page'
      insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id)
         values (@w_pa_id, @w_la_id, @w_pa_name, 'icono pagina', @w_pa_id_parent, @w_orden, 'horizontal', 'Nemonic', @w_prod_name, '', null)
      
      --INSERTANDO EN LA AN_ROLE_PAGE
      print 'Insertando en an_role_page'
      insert into an_role_page values (@w_pa_id, @w_rol)
      
      --INSERTANDO EN LA AN_ZONE
      if not exists (select 1 from an_zone where zo_id = 1) 
         begin
            print 'Insertando en an_zone'
            insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  
         end
         
      select @w_mo_id = mo_id from an_module where mo_name = @w_mo_name
      
      if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Query') 
         begin
            select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group
            
            --INSERTANDO EN LA AN_MODULE_GROUP
            insert into an_module_group 
               values (@w_mg_id, 'ADMSEG.Query', '4.0.0.1', 'http://192.168.64.157:81/ADMSEG/ADMSEG.application', 'COBISExplorer')
               
         end 
      else 
         select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Query'
         
      if not exists (select 1 from an_module where mo_name = 'ADMSEG.Query') 
         begin
            select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module
            
            --INSERTANDO EN LA AN_MODULE
            insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Query', 'COBISCorp.tCOBIS.ADMSEG.Query.dll', 0, null)
         end 
      else 
         select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Query'
      
      --INSERTANDO EN LA AN_ROLE_MODULE
      print 'Insertando en an_role_module'
      if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) 
         insert into an_role_module values (@w_mo_id, @w_rol)

      --OBTENIENDO EL MAXIMO SECUENCIAL DE AN_COMPONENT
      select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component

      --INSERTANDO EN LA AN_COMPONENT
      print 'Insertando en an_component'
      insert into an_component 
         values (@w_co_id, @w_mo_id, @w_co_name, @w_co_class, @w_co_namespace, 'SV', '', @w_prod_name)

      --INSERTANDO EN LA AN_ROLE_COMPONENT
      print 'Insertando en an_role_component'
      insert into an_role_component values (@w_co_id, @w_rol)

      --OBTENIENDO EL MAXIMO SECUENCIAL DE AN_PAGE_ZONE
      select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone
      
      if @w_pz_id is null 
         select @w_pz_id = 1

      --INSERTANDO EN LA AN_PAGE_ZONE
      if not exists (select 1 from an_page_zone 
                  where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) 
         begin
            print 'Insertando en an_page_zone'
            insert into an_page_zone 
               values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
         end
   end
go

-- Fin de Registros para Control de Ambito
*/


-- Registros para Consulta de Ambito
declare @w_pa_name varchar(255),
   @w_pa_id_label integer,
   @w_cod_label integer,
   @w_label varchar(100),
   @w_cod_page integer,
   @w_cod_component integer

select @w_pa_name = 'AS.ADMSEG.FConAmbitoClass'
select @w_pa_id_label = pa_la_id from an_page where pa_name = @w_pa_name

--BORRA LABEL
print 'Borrando en an_label'
delete from an_label where la_id = @w_pa_id_label and la_prod_name = 'M-ADM.Seg'

--BORRA PAGE
select @w_cod_page = pa_id from an_page where pa_name = @w_pa_name

print 'Borrando en an_page'
delete from an_page where pa_id = @w_cod_page

print 'Borrando en an_page_rol'
delete from an_role_page where rp_pa_id = @w_cod_page

--BORRA PAGE_ZONE
select @w_cod_component = pz_co_id from an_page_zone  where pz_pa_id = @w_cod_page

print 'Borrando en an_page_zone'
delete from an_page_zone where pz_pa_id = @w_cod_page

--BORRA COMPONENT
print 'Borrando en an_component'
delete from an_component where co_id = @w_cod_component

print 'Borrando en an_role_component'
delete from an_role_component where rc_co_id = @w_cod_component

declare  @w_la_label varchar(255),
   @w_prod_name varchar(20),
   @w_rol_des varchar(255),
   @w_pa_parent varchar(255),
   --@w_pa_name varchar(255),
   @w_orden int,
   @w_mo_name varchar(255),
   @w_co_name varchar(255),
   @w_co_class varchar(255),
   @w_co_namespace varchar(255)

select  @w_la_label    = 'Consulta de Rol por Usuario',
   @w_prod_name    = 'M-ADM.Seg',
   @w_rol_des       = 'MENU POR PROCESOS',
   @w_pa_parent    = 'AS.Consultas3',
   @w_pa_name       = 'AS.ADMSEG.FConAmbitoClass',
   @w_orden       = 5,
   @w_mo_name      = 'ADMSEG.Query',
   @w_co_name       = 'ADMSEG.FConAmbitoClass',
   @w_co_class    = 'FConAmbitoClass',
   @w_co_namespace = 'COBISCorp.tCOBIS.ADMSEG.Query'
   
print 'Registros de Opción de MENU: ' + @w_la_label
if not exists (select 1 from an_page where pa_name = @w_pa_name)
   begin
      declare @w_rol int, 
         @w_la_cod varchar(10), 
         @w_la_id int,
         @w_pa_id  int,
         @w_pa_id_parent int,
         @w_mg_id int,
         @w_mo_id int,
         @w_co_id int,
         @w_pz_id int,
         @wd_parent_module int

      --OBTENIENDO EL ROL
      select @w_rol = ro_rol from   ad_rol where  ro_descripcion = @w_rol_des
      select @w_la_cod = 'ES_EC'
      
      --OBTENIENDO EL MAXIMO SECUENCIAL DE LABEL
      select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label
      
      --INSERTANDO EL LABEL
      print 'Insertando en an_label: ' + @w_la_label
      insert into an_label values (@w_la_id, @w_la_cod, @w_la_label, @w_prod_name)
      
      --SELECCIONANDO EL MAXIMO SECUENCIAL DE AN_PAGE
      select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page
      select @w_pa_id_parent = pa_id from an_page where pa_name = @w_pa_parent
      
      --INSERTANDO EN LA AN_PAGE
      print 'Insertando en an_page'
      insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id)
         values (@w_pa_id, @w_la_id, @w_pa_name, 'icono pagina', @w_pa_id_parent, @w_orden, 'horizontal', 'Nemonic', @w_prod_name, '', null)
      
      --INSERTANDO EN LA AN_ROLE_PAGE
      print 'Insertando en an_role_page'
      insert into an_role_page values (@w_pa_id, @w_rol)
      
      --INSERTANDO EN LA AN_ZONE
      if not exists (select 1 from an_zone where zo_id = 1) 
         begin
            print 'Insertando en an_zone'
            insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  
         end
         
      select @w_mo_id = mo_id from an_module where mo_name = @w_mo_name
      
      if not exists (select 1 from an_module_group where mg_name = 'ADMSEG.Query') 
         begin
            select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group
            
            --INSERTANDO EN LA AN_MODULE_GROUP
            insert into an_module_group 
               values (@w_mg_id, 'ADMSEG.Query', '4.0.0.1', 'http://192.168.64.157:81/ADMSEG/ADMSEG.application', 'COBISExplorer')
               
         end 
      else 
         select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMSEG.Query'
         
      if not exists (select 1 from an_module where mo_name = 'ADMSEG.Query') 
         begin
            select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module
            
            --INSERTANDO EN LA AN_MODULE
            insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMSEG.Query', 'COBISCorp.tCOBIS.ADMSEG.Query.dll', 0, null)
         end 
      else 
         select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Query'
      
      --INSERTANDO EN LA AN_ROLE_MODULE
      print 'Insertando en an_role_module'
      if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) 
         insert into an_role_module values (@w_mo_id, @w_rol)

      --OBTENIENDO EL MAXIMO SECUENCIAL DE AN_COMPONENT
      select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component

      --INSERTANDO EN LA AN_COMPONENT
      print 'Insertando en an_component'
      insert into an_component 
         values (@w_co_id, @w_mo_id, @w_co_name, @w_co_class, @w_co_namespace, 'SV', '', @w_prod_name)

      --INSERTANDO EN LA AN_ROLE_COMPONENT
      print 'Insertando en an_role_component'
      insert into an_role_component values (@w_co_id, @w_rol)

      --OBTENIENDO EL MAXIMO SECUENCIAL DE AN_PAGE_ZONE
      select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone
      
      if @w_pz_id is null 
         select @w_pz_id = 1

      --INSERTANDO EN LA AN_PAGE_ZONE
      if not exists (select 1 from an_page_zone 
                  where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) 
         begin
            print 'Insertando en an_page_zone'
            insert into an_page_zone 
               values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
         end
   end
go

-- Fin de Registros para Consulta de Ambito


/*******************************************************************/
/*  ASIGNACION DE DEPENDENCIAS ENTRE FUNCIONALIDADES DE ADMIN SEG  */
/*******************************************************************/
print '***  ASIGNACION DE DEPENDENCIAS ENTRE FUNCIONALIDADES DE ADMIN SEG'
go

declare @w_parent_module varchar(100), @w_id_parent_module int, @w_mo_id int --JHI

select @w_parent_module  = 'ADMSEG.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from an_module 
where mo_name = @w_parent_module  

select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Functional'
if not exists (select 1 from an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end

select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Role'
if not exists (select 1 from an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end

select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Schedule'
if not exists (select 1 from an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end

select @w_mo_id = mo_id from an_module where mo_name = 'ADMSEG.Query'
if not exists (select 1 from an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
go

/*******************************************************************/
/*  ASIGNACION DE DEPENDENCIAS ENTRE FUNCIONALIDADES DE ADMIN RED  */
/*******************************************************************/
print '***  ASIGNACION DE DEPENDENCIAS ENTRE FUNCIONALIDADES DE ADMIN RED'
go

declare @w_parent_module varchar(100), @w_id_parent_module int, @w_mo_id int --JHI

select @w_parent_module  = 'ADM.RED.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from an_module 
where mo_name = @w_parent_module  

select @w_mo_id = mo_id from an_module where mo_name = 'ADM.RED.Maintenance'
if not exists (select 1 from an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end

select @w_mo_id = mo_id from an_module where mo_name = 'ADM.RED.Node'
if not exists (select 1 from an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
go

/*******************************************************************/
/*  ASIGNACION DE DEPENDENCIAS ENTRE FUNCIONALIDADES DE ADMIN REF  */
/*******************************************************************/
print '***  ASIGNACION DE DEPENDENCIAS ENTRE FUNCIONALIDADES DE ADMIN REF'
go

declare @w_parent_module varchar(100), @w_id_parent_module int, @w_mo_id int --JHI

select @w_parent_module  = 'ADM.Ref.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from an_module 
where mo_name = @w_parent_module  

select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Catalog'
if not exists (select 1 from an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end

select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Config'
if not exists (select 1 from an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end

select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Depart'
if not exists (select 1 from an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end

select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Office'
if not exists (select 1 from an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end

select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Rates'
if not exists (select 1 from an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end

select @w_mo_id = mo_id from an_module where mo_name = 'ADM.Ref.Query'
if not exists (select 1 from an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
go


/*******************************************************************/
/*  ASIGNACION DE DEPENDENCIAS ENTRE FUNCIONALIDADES DE ADMIN PROD */
/*******************************************************************/
print '***  ASIGNACION DE DEPENDENCIAS ENTRE FUNCIONALIDADES DE ADMIN PROD'
go

declare @w_parent_module varchar(100), @w_id_parent_module int, @w_mo_id int --JHI

select @w_parent_module  = 'Adm.Prod.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from an_module 
where mo_name = @w_parent_module  

select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Others'
if not exists (select 1 from an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end

select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Products'
if not exists (select 1 from an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end

select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Trans'
if not exists (select 1 from an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end

select @w_mo_id = mo_id from an_module where mo_name = 'Adm.Prod.Query'
if not exists (select 1 from an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
go

-- alter table an_label enable trigger
-- alter table an_page  enable trigger
-- alter table an_module_group  enable trigger
-- alter table an_module  enable trigger
-- alter table an_component  enable trigger
-- alter table an_zone  enable trigger
-- alter table an_page_zone  enable trigger
-- alter table an_role_module  enable trigger
-- alter table an_navigation_zone enable trigger
-- alter table an_role_navigation_zone enable trigger
-- alter table an_role_component enable trigger
-- alter table an_role_page enable trigger
-- go

/*******************************************************************/
/*  ASIGNACION DE TRANSACCIONES DESDE EL ROL ADMINISTRADOR GENERAL */
/*  AL ROL MENU POR PROCESOS                                       */
/*******************************************************************/
print '***  ad_tr_autorizada .....(Asignacion de transacciones a MENU POR PROCESOS)'
go

declare @w_rol_destino int, @w_rol_origen int

select @w_rol_origen = ro_rol
from ad_rol
where ro_descripcion = 'ADMINISTRADOR' and
      ro_filial = 1

select @w_rol_destino = ro_rol
from ad_rol
where ro_descripcion = 'MENU POR PROCESOS' and
      ro_filial = 1

print 'Asignacion de usuario admuser a rol MENU POR PROCESOS'
if not exists (select * from ad_usuario_rol where ur_login = 'admuser' and ur_rol = @w_rol_destino)
   insert into ad_usuario_rol (ur_login, ur_rol, ur_fecha_aut, ur_autorizante,
                                      ur_estado, ur_fecha_ult_mod, ur_tipo_horario)
                              values ('admuser', @w_rol_destino, getdate(), 1,
                                      'V', getdate(), 1)

print 'Eliminacion de transacciones autorizadas de Admin a rol MENU POR PROCESOS'
delete ad_tr_autorizada
where ta_rol = @w_rol_destino
and ta_producto = 1
and ta_transaccion in (select ta_transaccion from ad_tr_autorizada where ta_rol = @w_rol_origen)

print 'Asignacion de transacciones autorizadas de Admin desde el rol Administador al rol MENU POR PROCESOS'
insert into ad_tr_autorizada 
  select ta_producto, ta_tipo, ta_moneda, ta_transaccion, @w_rol_destino, getdate(), 
         1, ta_estado, getdate()
  from ad_tr_autorizada
  where ta_rol = @w_rol_origen
  and ta_producto = 1
  and ta_transaccion not in (
     select ta_transaccion from ad_tr_autorizada where ta_rol = @w_rol_destino and ta_producto = 1
  )
go

/***************************************************************************/
/*        SCRIPT DE CATALOGACION DE SHAREDLIBRARY                          */
/***************************************************************************/
print 'SCRIPT DE CATALOGACION DE SHAREDLIBRARY'
go

use cobis
go

print 'Componente FBloqueoFecClass'
declare @w_return int, @w_rol int, @w_prod_name varchar(10),
        @w_module_group varchar(50), @w_zone varchar(50), @w_module varchar(50),
        @w_label_module varchar(50), @w_namespace_component varchar(255), @w_name_component varchar(255),
        @w_class_component varchar(50),
        
        -- variables temporales
        @id_module         int, @id_component      int
        
-- Datos del componente

select @w_prod_name            = 'M-ADM.Seg',
       @w_module_group         = 'ADMSEG',
       @w_zone                 = 'Zona 1',
       @w_module               = 'ADMSEG.SharedLibrary',
       @w_label_module         = 'ADMSEG.SharedLibrary',
       @w_namespace_component  = 'COBISCorp.tCOBIS.ADMSEG.SharedLibrary',
       @w_name_component       = 'ADMSEG.FBloqueoFec',
       @w_class_component      = 'FBloqueoFecClass'

select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
select @id_component = co_id from an_component where co_name = @w_name_component and co_class = @w_class_component
select @id_module = mo_id from an_module where mo_name = @w_module

if @id_component is null
begin
    select @id_component = isnull(max(co_id),1) + 1 from an_component
    if @id_component is null select  @id_component = 1
    insert into an_component values(@id_component,@id_module,@w_name_component,@w_class_component,@w_namespace_component,'SV','',@w_prod_name)
end
if not exists (select * from an_role_component where rc_co_id = @id_component and rc_rol = @w_rol)
insert into an_role_component values (@id_component,@w_rol)
go

print 'Componente grid_valoresClass'
declare @w_return int, @w_rol int, @w_prod_name varchar(10),
        @w_module_group varchar(50), @w_zone varchar(50), @w_module varchar(50),
        @w_label_module varchar(50), @w_namespace_component varchar(255), @w_name_component varchar(255),
        @w_class_component varchar(50),
        
        -- variables temporales
        @id_module         int, @id_component      int
        
-- Datos del componente

select @w_prod_name            = 'M-ADM.Seg',                            
       @w_module_group         = 'ADMSEG',                               
       @w_zone                 = 'Zona 1',                               
       @w_module               = 'ADMSEG.SharedLibrary',                 
       @w_label_module         = 'ADMSEG.SharedLibrary',                 
       @w_namespace_component  = 'COBISCorp.tCOBIS.ADMSEG.SharedLibrary',
       @w_name_component       = 'ADMSEG.grid_valores',                  
       @w_class_component      = 'grid_valoresClass'                     

select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
select @id_component = co_id from an_component where co_name = @w_name_component and co_class = @w_class_component
select @id_module = mo_id from an_module where mo_name = @w_module

if @id_component is null
begin
    select @id_component = isnull(max(co_id),1) + 1 from an_component
    if @id_component is null select  @id_component = 1
    insert into an_component values(@id_component,@id_module,@w_name_component,@w_class_component,@w_namespace_component,'SV','',@w_prod_name)
end
if not exists (select * from an_role_component where rc_co_id = @id_component and rc_rol = @w_rol)
insert into an_role_component values (@id_component,@w_rol)
go

print 'Componente FImprimirClass'
declare @w_return int, @w_rol int, @w_prod_name varchar(10),
        @w_module_group varchar(50), @w_zone varchar(50), @w_module varchar(50),
        @w_label_module varchar(50), @w_namespace_component varchar(255), @w_name_component varchar(255),
        @w_class_component varchar(50),
        
        -- variables temporales
        @id_module         int, @id_component      int
        
-- Datos del componente

select @w_prod_name            = 'M-ADM.Seg',                            
       @w_module_group         = 'ADMSEG',                               
       @w_zone                 = 'Zona 1',                               
       @w_module               = 'ADMSEG.SharedLibrary',                 
       @w_label_module         = 'ADMSEG.SharedLibrary',                 
       @w_namespace_component  = 'COBISCorp.tCOBIS.ADMSEG.SharedLibrary',
       @w_name_component       = 'ADMSEG.FImprimir',                     
       @w_class_component      = 'FImprimirClass'                        

select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
select @id_component = co_id from an_component where co_name = @w_name_component and co_class = @w_class_component
select @id_module = mo_id from an_module where mo_name = @w_module

if @id_component is null
begin
    select @id_component = isnull(max(co_id),1) + 1 from an_component
    if @id_component is null select  @id_component = 1
    insert into an_component values(@id_component,@id_module,@w_name_component,@w_class_component,@w_namespace_component,'SV','',@w_prod_name)
end
if not exists (select * from an_role_component where rc_co_id = @id_component and rc_rol = @w_rol)
insert into an_role_component values (@id_component,@w_rol)
go

print 'Componente grid_valoresClass'
declare @w_return int, @w_rol int, @w_prod_name varchar(10),
        @w_module_group varchar(50), @w_zone varchar(50), @w_module varchar(50),
        @w_label_module varchar(50), @w_namespace_component varchar(255), @w_name_component varchar(255),
        @w_class_component varchar(50),
        
        -- variables temporales
        @id_module         int, @id_component      int
        
-- Datos del componente

select @w_prod_name            = 'M-ADM.RED',                            
       @w_module_group         = 'ADM.RED',                              
       @w_zone                 = 'Zona 1',                               
       @w_module               = 'ADM.RED.SharedLibrary',                
       @w_label_module         = 'ADM.RED.SharedLibrary',                
       @w_namespace_component  = 'COBISCorp.tCOBIS.ADMRED.SharedLibrary',
       @w_name_component       = 'ADM.RED.grid_valores',                 
       @w_class_component      = 'grid_valoresClass'                     

select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
select @id_component = co_id from an_component where co_name = @w_name_component and co_class = @w_class_component
select @id_module = mo_id from an_module where mo_name = @w_module

if @id_component is null
begin
    select @id_component = isnull(max(co_id),1) + 1 from an_component
    if @id_component is null select  @id_component = 1
    insert into an_component values(@id_component,@id_module,@w_name_component,@w_class_component,@w_namespace_component,'SV','',@w_prod_name)
end
if not exists (select * from an_role_component where rc_co_id = @id_component and rc_rol = @w_rol)
insert into an_role_component values (@id_component,@w_rol)
go

print 'Componente grid_valoresClass'
declare @w_return int, @w_rol int, @w_prod_name varchar(10),
        @w_module_group varchar(50), @w_zone varchar(50), @w_module varchar(50),
        @w_label_module varchar(50), @w_namespace_component varchar(255), @w_name_component varchar(255),
        @w_class_component varchar(50),
        
        -- variables temporales
        @id_module         int, @id_component      int
        
-- Datos del componente

select @w_prod_name            = 'M-ADM.Ref',                            
       @w_module_group         = 'ADM.Ref',                              
       @w_zone                 = 'Zona 1',                               
       @w_module               = 'ADM.Ref.SharedLibrary',                
       @w_label_module         = 'ADM.Ref.SharedLibrary',                
       @w_namespace_component  = 'COBISCorp.tCOBIS.ADMREF.SharedLibrary',
       @w_name_component       = 'ADM.Ref.grid_valores',                 
       @w_class_component      = 'grid_valoresClass'                     

select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
select @id_component = co_id from an_component where co_name = @w_name_component and co_class = @w_class_component
select @id_module = mo_id from an_module where mo_name = @w_module

if @id_component is null
begin
    select @id_component = isnull(max(co_id),1) + 1 from an_component
    if @id_component is null select  @id_component = 1
    insert into an_component values(@id_component,@id_module,@w_name_component,@w_class_component,@w_namespace_component,'SV','',@w_prod_name)
end
if not exists (select * from an_role_component where rc_co_id = @id_component and rc_rol = @w_rol)
insert into an_role_component values (@id_component,@w_rol)
go

print 'Componente FImprimirClass'
declare @w_return int, @w_rol int, @w_prod_name varchar(10),
        @w_module_group varchar(50), @w_zone varchar(50), @w_module varchar(50),
        @w_label_module varchar(50), @w_namespace_component varchar(255), @w_name_component varchar(255),
        @w_class_component varchar(50),
        
        -- variables temporales
        @id_module         int, @id_component      int
        
-- Datos del componente

select @w_prod_name            = 'M-ADM.Ref',                            
       @w_module_group         = 'ADM.Ref',                              
       @w_zone                 = 'Zona 1',                               
       @w_module               = 'ADM.Ref.SharedLibrary',                
       @w_label_module         = 'ADM.Ref.SharedLibrary',                
       @w_namespace_component  = 'COBISCorp.tCOBIS.ADMREF.SharedLibrary',
       @w_name_component       = 'ADM.Ref.FImprimir',                    
       @w_class_component      = 'FImprimirClass'                        

select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
select @id_component = co_id from an_component where co_name = @w_name_component and co_class = @w_class_component
select @id_module = mo_id from an_module where mo_name = @w_module

if @id_component is null
begin
    select @id_component = isnull(max(co_id),1) + 1 from an_component
    if @id_component is null select  @id_component = 1
    insert into an_component values(@id_component,@id_module,@w_name_component,@w_class_component,@w_namespace_component,'SV','',@w_prod_name)
end
if not exists (select * from an_role_component where rc_co_id = @id_component and rc_rol = @w_rol)
insert into an_role_component values (@id_component,@w_rol)
go

------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------
----Componente Para Vista de Reportes-----------------------------------------------------------------------------------------------------
declare @w_mo_id int,
        @w_mg_id int,
        @w_la_id int

select @w_mo_id = mo_id,
       @w_mg_id  = mo_mg_id,
       @w_la_id = mo_la_id  
from an_module, an_module_group
where mg_id  = mo_mg_id 
and mo_filename  = 'COBISCorp.eCOBIS.COBISExplorer.Container.WebPageContainer.dll'

delete from an_label
where la_id = @w_la_id

delete from an_module_group
where mg_id = @w_mg_id 

delete from an_module
where mo_id = @w_mo_id

select @w_mo_id = 0, @w_mg_id = 0, @w_la_id = 0

select @w_la_id = max(la_id) + 1 from an_label
select @w_mg_id = max(mg_id) + 1 from an_module_group
select @w_mo_id = max(mo_id) + 1 from an_module

insert into  an_label
values (@w_la_id,'ES_EC','NAVIGATIONPAGE','CEN')

insert into an_module_group
values (@w_mg_id , 'COBISCorp.eCOBIS.COBISExplorer.Container.NavigationPage', '4.0.0', 'Ninguno ', null)

insert into an_module
values (@w_mo_id,@w_mg_id,@w_la_id, 'COBISExplorer.Container.WebPageContainer', 'COBISCorp.eCOBIS.COBISExplorer.Container.WebPageContainer.dll', 0, null  )

go
