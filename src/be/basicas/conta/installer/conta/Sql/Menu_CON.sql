use cobis                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
go

delete cobis..an_role_page from cobis..an_role_page, cobis..an_page, cobis..an_label where rp_pa_id = pa_id and pa_la_id = la_id and la_prod_name in ('M-CON')                                                                                                                           
delete cobis..an_module_group where mg_name like ('CON%')
delete cobis..an_page_zone from cobis..an_page_zone, cobis..an_label where pz_la_id = la_id and la_prod_name in ('M-CON')                                                                                                                           
delete cobis..an_role_module from cobis..an_role_module, cobis..an_module, cobis..an_label where rm_mo_id = mo_id and mo_la_id = la_id and la_prod_name in ('M-CON')                                                                                                                           
--delete cobis..an_navigation_zone from cobis..an_navigation_zone, cobis..an_label where nz_la_id = la_id and la_prod_name in ('M-CON')                                                                                                                           
delete cobis..an_role_component from cobis..an_role_component,cobis..an_component where rc_co_id = co_id and co_prod_name in ('M-CON')                                                                                                                           
delete cobis..an_module_dependency where md_mo_id in (select mo_id from cobis..an_module where mo_name like 'CON%')
delete cobis..an_module from cobis..an_module, cobis..an_label where mo_la_id = la_id and la_prod_name in ('M-CON')                                                                                                                           
delete cobis..an_component where co_prod_name in ('M-CON')
delete cobis..an_page from cobis..an_page, cobis..an_label where pa_la_id = la_id and la_prod_name in ('M-CON')                                                                                                                           
delete cobis..an_label where la_prod_name in ('M-CON')          
delete cobis..an_role_install where ri_prod_name in ('M-CON')

go
 
-- Insercion en tabla de roles instalados por producto
print 'Insercion en tabla de roles instalados por producto' 
declare @w_return int, @w_rol int
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
insert into cobis..an_role_install values ('M-CON', @w_rol)


print 'SCRIPT DE CATALOGACION DE ARCHIVOS DE RECURSOS'

/***************************************************************************/
/*        SCRIPT DE CATALOGACION DE ARCHIVOS DE RECURSOS                   */
/***************************************************************************/

 --Create Module Group and Modules
 exec @w_return = sp_cen_catalogar
   @i_opcion               = 'MOD',                                   
   @i_role                 = @w_rol,        
   @i_prod_name            = 'M-CON',
   @i_module_group         = 'CON.resources',                        
   @i_zone                 = 'Zona 1',
   @i_module               = 'CON.resources',
   @i_label_module         = 'CON.resources',
   @i_filename_module      = 'COBISCorp.tCOBIS.CON.resources.dll',
   @i_version              = '4.0.0.1', 
   @i_localizacion         = 'http://[servername]/CONTA/CONTA.application',
   @i_namespace_component  = 'COBISCorp.tCOBIS.CON.resources'--,
   --@i_parent_module        = 'CON.Toolbar'


 if @w_return<> 0
    print 'Error crear Modulo Resources_Contabilidad'  


print 'SCRIPT DE CATALOGACION DE SHAREDLIBRARY'
/***************************************************************************/
/*        SCRIPT DE CATALOGACION DE SHAREDLIBRARY                          */
/***************************************************************************/


exec @w_return =sp_cen_catalogar
	@i_debug                = 'S',
	@i_opcion               = 'MOD',
	@i_role                 = @w_rol,
	@i_prod_name            = 'M-CON',
	@i_module_group         = 'CON.SharedLibrary',
	@i_zone                 = 'Zona 1',
	@i_module               = 'CON.SharedLibrary',
	@i_label_module         = 'CON.SharedLibrary',
	@i_namespace_component  = 'COBISCorp.tCOBIS.CON.SharedLibrary',
	@i_filename_module		= 'COBISCorp.tCOBIS.CON.SharedLibrary.dll',
	@i_version				= '4.0.0.1',
	@i_localizacion			= 'http://[servername]/CONTA/CONTA.application',
	@i_parent_module		= 'CON.resources'
	if @w_return <> 0
		print 'Error Creando MOD:CON.SharedLibrary'

go

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.Contabilidad                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: PI.Contabilidad'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_page where pa_name = 'PI.Contabilidad') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Contabilidad', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
--select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Operativo - CON'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.Contabilidad', 'icono pagina', 0, 1, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                              
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-- Registros para: PI.Empresas                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: PI.Empresas'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_page where pa_name = 'PI.Empresas') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Empresas', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Contabilidad'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.Empresas', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                              
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.CON.FBcoDefinicionClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
print 'Registros para: PI.CON.FBcoDefinicionClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FBcoDefinicionClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                  
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Definición', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Empresas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FBcoDefinicionClass', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                               
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.Company') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.Company', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                       
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.Company'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module where mo_name = 'CON.Company') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.Company', 'COBISCorp.tCOBIS.CON.Company.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                             
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.Company'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FBcoDefinicion', 'FBcoDefinicionClass', 'COBISCorp.tCOBIS.CON.Company', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Definición') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Definición', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                                    
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from cobis..an_label where la_label = 'Definición'                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end     
go

-- Registros para: PI.CON.FBcoOrganizacionClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: PI.CON.FBcoOrganizacionClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FBcoOrganizacionClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Nivel Jerárquico de Oficinas', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Empresas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FBcoOrganizacionClass', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                             
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.Company') begin                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.Company', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                       
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.Company'                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module where mo_name = 'CON.Company') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.Company', 'COBISCorp.tCOBIS.CON.Company.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                             
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.Company'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FBcoOrganizacion', 'FBcoOrganizacionClass', 'COBISCorp.tCOBIS.CON.Company', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Nivel Jerárquico de Oficinas') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Nivel Jerárquico de Oficinas', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                       
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from cobis..an_label where la_label = 'Nivel Jerárquico de Oficinas'                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.CON.FBcoOficinasClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
print 'Registros para: PI.CON.FBcoOficinasClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FBcoOficinasClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Oficinas de la Empresa', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Empresas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FBcoOficinasClass', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.Company') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.Company', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.Company'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.Company') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.Company', 'COBISCorp.tCOBIS.CON.Company.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.Company'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FBcoOficinas', 'FBcoOficinasClass', 'COBISCorp.tCOBIS.CON.Company', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                             
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Oficinas de la Empresa') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Oficinas de la Empresa', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from cobis..an_label where la_label = 'Oficinas de la Empresa'                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.CON.FBcoNivelDeptoClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
print 'Registros para: PI.CON.FBcoNivelDeptoClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FBcoNivelDeptoClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                  
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Nivel Jerárquico de Areas', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Empresas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FBcoNivelDeptoClass', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                               
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.Company') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.Company', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.Company'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.Company') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.Company', 'COBISCorp.tCOBIS.CON.Company.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.Company'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FBcoNivelDepto', 'FBcoNivelDeptoClass', 'COBISCorp.tCOBIS.CON.Company', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                         
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Nivel Jerárquico de Areas') begin                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Nivel Jerárquico de Areas', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                      
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from cobis..an_label where la_label = 'Nivel Jerárquico de Areas'                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.CON.FBcoAreasClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FBcoAreasClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FBcoAreasClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Areas de la Empresa', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Empresas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FBcoAreasClass', 'icono pagina', @w_pa_id_parent, 5, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.Company') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.Company', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.Company'                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from cobis..an_module where mo_name = 'CON.Company') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.Company', 'COBISCorp.tCOBIS.CON.Company.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.Company'                                                                                                                                                                                                                                                                                                                                                                                                                                                
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FBcoAreas', 'FBcoAreasClass', 'COBISCorp.tCOBIS.CON.Company', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Areas de la Empresa') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Areas de la Empresa', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                           
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from cobis..an_label where la_label = 'Areas de la Empresa'                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.CON.FBcoPeriodosClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
print 'Registros para: PI.CON.FBcoPeriodosClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FBcoPeriodosClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Períodos Contables', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Empresas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FBcoPeriodosClass', 'icono pagina', @w_pa_id_parent, 6, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.Company') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.Company', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.Company'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.Company') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.Company', 'COBISCorp.tCOBIS.CON.Company.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.Company'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FBcoPeriodos', 'FBcoPeriodosClass', 'COBISCorp.tCOBIS.CON.Company', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                             
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Períodos Contables') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Períodos Contables', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                            
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from cobis..an_label where la_label = 'Períodos Contables'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.CON.FRelacionClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FRelacionClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FRelacionClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Relación Oficinas Admin-Contabilidad', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Empresas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FRelacionClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.Company') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.Company', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.Company'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.Company') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.Company', 'COBISCorp.tCOBIS.CON.Company.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.Company'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FRelacion', 'FRelacionClass', 'COBISCorp.tCOBIS.CON.Company', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Relación Oficinas Admin-Contabilidad') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Relación Oficinas Admin-Contabilidad', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Relación Oficinas Admin-Contabilidad'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.PlanCuentas                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: PI.PlanCuentas'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_page where pa_name = 'PI.PlanCuentas') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Plan de Cuentas', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Contabilidad'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.PlanCuentas', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                              
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

-- Registros para: PI.CON.FTPNivelesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FTPNivelesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FTPNivelesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Niveles de Cuenta', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.PlanCuentas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FTPNivelesClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.ChartAccounts', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.ChartAccounts', 'COBISCorp.tCOBIS.CON.ChartAccounts.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FTPNiveles', 'FTPNivelesClass', 'COBISCorp.tCOBIS.CON.ChartAccounts', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Niveles de Cuenta') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Niveles de Cuenta', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Niveles de Cuenta'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FTPCuentasClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FTPCuentasClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FTPCuentasClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Mantenimiento Plan de Cuentas', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.PlanCuentas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FTPCuentasClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.ChartAccounts', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.ChartAccounts', 'COBISCorp.tCOBIS.CON.ChartAccounts.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FTPCuentas', 'FTPCuentasClass', 'COBISCorp.tCOBIS.CON.ChartAccounts', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Mantenimiento Plan de Cuentas') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Mantenimiento Plan de Cuentas', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Mantenimiento Plan de Cuentas'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go


-- Registros para: PI.CON.FTPDinamicaClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FTPDinamicaClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FTPDinamicaClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Dinámica de Cuentas', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.PlanCuentas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FTPDinamicaClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.ChartAccounts', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.ChartAccounts', 'COBISCorp.tCOBIS.CON.ChartAccounts.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FTPDinamica', 'FTPDinamicaClass', 'COBISCorp.tCOBIS.CON.ChartAccounts', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Dinámica de Cuentas') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Dinámica de Cuentas', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Dinámica de Cuentas'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FPGCuentasClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
print 'Registros para: PI.CON.FPGCuentasClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FPGCuentasClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Asociación de Cuentas por Oficina - Area', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.PlanCuentas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FPGCuentasClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.ChartAccounts', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.ChartAccounts', 'COBISCorp.tCOBIS.CON.ChartAccounts.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FPGCuentas', 'FPGCuentasClass', 'COBISCorp.tCOBIS.CON.ChartAccounts', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Asociación de Cuentas por Oficina - Area') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Asociación de Cuentas por Oficina - Area', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Asociación de Cuentas por Oficina - Area'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FCtaProcesoClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FCtaProcesoClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FCtaProcesoClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Asociación de Cuentas a Procesos', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.PlanCuentas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FCtaProcesoClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.ChartAccounts', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.ChartAccounts', 'COBISCorp.tCOBIS.CON.ChartAccounts.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FCtaProceso', 'FCtaProcesoClass', 'COBISCorp.tCOBIS.CON.ChartAccounts', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Asociación de Cuentas a Procesos') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Asociación de Cuentas a Procesos', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Asociación de Cuentas a Procesos'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go


-- Registros para: PI.CON.FCtaTercerosClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FCtaTercerosClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FCtaTercerosClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Asociación de Cuentas Cancelación de Terceros', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.PlanCuentas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FCtaTercerosClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.ChartAccounts', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.ChartAccounts', 'COBISCorp.tCOBIS.CON.ChartAccounts.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FCtaTerceros', 'FCtaTercerosClass', 'COBISCorp.tCOBIS.CON.ChartAccounts', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Asociación de Cuentas Cancelación de Terceros') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Asociación de Cuentas Cancelación de Terceros', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Asociación de Cuentas Cancelación de Terceros'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FTPBuscaCuentaClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FTPBuscaCuentaClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FTPBuscaCuentaClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta del Plan de Cuentas', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.PlanCuentas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FTPBuscaCuentaClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.ChartAccounts', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.ChartAccounts', 'COBISCorp.tCOBIS.CON.ChartAccounts.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FTPBuscaCuenta', 'FTPBuscaCuentaClass', 'COBISCorp.tCOBIS.CON.ChartAccounts', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta del Plan de Cuentas') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta del Plan de Cuentas', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta del Plan de Cuentas'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FPGBuscarCuentasClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FPGBuscarCuentasClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FPGBuscarCuentasClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Cuentas por Oficina-Area', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.PlanCuentas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FPGBuscarCuentasClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.ChartAccounts', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.ChartAccounts', 'COBISCorp.tCOBIS.CON.ChartAccounts.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FPGBuscarCuentas', 'FPGBuscarCuentasClass', 'COBISCorp.tCOBIS.CON.ChartAccounts', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta de Cuentas por Oficina-Area') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Cuentas por Oficina-Area', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta de Cuentas por Oficina-Area'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FModificaPlanClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FModificaPlanClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FModificaPlanClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Modific del Plan de Cuentas', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.PlanCuentas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FModificaPlanClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.ChartAccounts', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.ChartAccounts', 'COBISCorp.tCOBIS.CON.ChartAccounts.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FModificaPlan', 'FModificaPlanClass', 'COBISCorp.tCOBIS.CON.ChartAccounts', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta de Modific del Plan de Cuentas') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Modific del Plan de Cuentas', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta de Modific del Plan de Cuentas'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FModctaTercerClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FModctaTercerClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FModctaTercerClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta Modificaciones Cuentas de Terceros', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.PlanCuentas'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FModctaTercerClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.ChartAccounts', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.ChartAccounts') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.ChartAccounts', 'COBISCorp.tCOBIS.CON.ChartAccounts.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.ChartAccounts'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FModctaTercer', 'FModctaTercerClass', 'COBISCorp.tCOBIS.CON.ChartAccounts', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta Modificaciones Cuentas de Terceros') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta Modificaciones Cuentas de Terceros', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta Modificaciones Cuentas de Terceros'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go


-- Registros para: PI.ConsolidaComp                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: PI.ConsolidaComp'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_page where pa_name = 'PI.ConsolidaComp') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consolidación de Compañías', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Contabilidad'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.ConsolidaComp', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                              
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               


-- Registros para: PI.CON.FConsolidacionClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FConsolidacionClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FConsolidacionClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Asociación de Cuentas entre Compañías', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsolidaComp'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FConsolidacionClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.ConsolidationCompanies') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.ConsolidationCompanies', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.ConsolidationCompanies'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.ConsolidationCompanies') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.ConsolidationCompanies', 'COBISCorp.tCOBIS.CON.ConsolidationCompanies.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.ConsolidationCompanies'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FConsolidacion', 'FConsolidacionClass', 'COBISCorp.tCOBIS.CON.ConsolidationCompanies', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Asociación de Cuentas entre Compañías') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Asociación de Cuentas entre Compañías', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Asociación de Cuentas entre Compañías'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.TablaTrib                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: PI.TablaTrib '                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_page where pa_name = 'PI.TablaTrib ') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Tablas Tributarias', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Contabilidad'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.TablaTrib', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                              
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               


-- Registros para: PI.CON.FRetenIndComClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FRetenIndComClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FRetenIndComClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Provisión Industria y Comercio', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.TablaTrib'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FRetenIndComClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.TaxTables') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.TaxTables', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.TaxTables'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.TaxTables') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.TaxTables', 'COBISCorp.tCOBIS.CON.TaxTables.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.TaxTables'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FRetenIndCom', 'FRetenIndComClass', 'COBISCorp.tCOBIS.CON.TaxTables', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Provisión Industria y Comercio') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Provisión Industria y Comercio', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Provisión Industria y Comercio'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FAsoofidepartClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FAsoofidepartClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FAsoofidepartClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Parametrización Declaraciones de Impuestos', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.TablaTrib'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FAsoofidepartClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.TaxTables') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.TaxTables', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.TaxTables'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.TaxTables') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.TaxTables', 'COBISCorp.tCOBIS.CON.TaxTables.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.TaxTables'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FAsoofidepart', 'FAsoofidepartClass', 'COBISCorp.tCOBIS.CON.TaxTables', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Parametrización Declaraciones de Impuestos') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Parametrización Declaraciones de Impuestos', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Parametrización Declaraciones de Impuestos'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FREGFISCClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FREGFISCClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FREGFISCClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Regímenes Fiscales', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.TablaTrib'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FREGFISCClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.TaxTables') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.TaxTables', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.TaxTables'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.TaxTables') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.TaxTables', 'COBISCorp.tCOBIS.CON.TaxTables.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.TaxTables'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FREGFISC', 'FREGFISCClass', 'COBISCorp.tCOBIS.CON.TaxTables', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Regímenes Fiscales') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Regímenes Fiscales', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Regímenes Fiscales'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.InterfazCont                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: PI.InterfazCont '                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_page where pa_name = 'PI.InterfazCont') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Interfaz Contable', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Contabilidad'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.InterfazCont', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                              
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

-- Registros para: PI.CON.FParametroClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FParametroClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FParametroClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Parámetros Contables', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.InterfazCont'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FParametroClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.AccountingInterface', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.AccountingInterface', 'COBISCorp.tCOBIS.CON.AccountingInterface.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FParametro', 'FParametroClass', 'COBISCorp.tCOBIS.CON.AccountingInterface', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Parámetros Contables') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Parámetros Contables', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Parámetros Contables'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FPerfilRelacionClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FPerfilRelacionClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FPerfilRelacionClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Relación Parámetros Subcadena Contable', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.InterfazCont'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FPerfilRelacionClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.AccountingInterface', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.AccountingInterface', 'COBISCorp.tCOBIS.CON.AccountingInterface.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FPerfilRelacion', 'FPerfilRelacionClass', 'COBISCorp.tCOBIS.CON.AccountingInterface', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Relación Parámetros Subcadena Contable') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Relación Parámetros Subcadena Contable', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Relación Parámetros Subcadena Contable'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FCodValClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FCodValClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FCodValClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Códigos de Valor Contable', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.InterfazCont'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FCodValClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.AccountingInterface', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.AccountingInterface', 'COBISCorp.tCOBIS.CON.AccountingInterface.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FCodVal', 'FCodValClass', 'COBISCorp.tCOBIS.CON.AccountingInterface', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Códigos de Valor Contable') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Códigos de Valor Contable', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Códigos de Valor Contable'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FTipAreaClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FTipAreaClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FTipAreaClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Tipos de Areas', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.InterfazCont'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FTipAreaClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.AccountingInterface', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.AccountingInterface', 'COBISCorp.tCOBIS.CON.AccountingInterface.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FTipArea', 'FTipAreaClass', 'COBISCorp.tCOBIS.CON.AccountingInterface', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Tipos de Areas') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Tipos de Areas', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Tipos de Areas'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FPerfilClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: PI.CON.FPerfilClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FPerfilClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Perfiles Contables', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.InterfazCont'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FPerfilClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.AccountingInterface', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.AccountingInterface', 'COBISCorp.tCOBIS.CON.AccountingInterface.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FPerfil', 'FPerfilClass', 'COBISCorp.tCOBIS.CON.AccountingInterface', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Perfiles Contables') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Perfiles Contables', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Perfiles Contables'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FconsultaInterfazClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: PI.CON.FconsultaInterfazClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FconsultaInterfazClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Rev. Comprobantes Interfaz Contable', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.InterfazCont'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FconsultaInterfazClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.AccountingInterface', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.AccountingInterface', 'COBISCorp.tCOBIS.CON.AccountingInterface.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FconsultaInterfaz', 'FconsultaInterfazClass', 'COBISCorp.tCOBIS.CON.AccountingInterface', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Rev. Comprobantes Interfaz Contable') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Rev. Comprobantes Interfaz Contable', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Rev. Comprobantes Interfaz Contable'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go



-- Registros para: PI.CON.FConsPefilClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: PI.CON.FConsPefilClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FConsPefilClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Manual Transaccional', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.InterfazCont'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FConsPefilClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.AccountingInterface', '4.0.0.0', 'http://[servername]/CON.AccountingInterface.installer/CON.AccountingInterface.installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.AccountingInterface', 'COBISCorp.tCOBIS.CON.AccountingInterface.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FConsPefil', 'FConsPefilClass', 'COBISCorp.tCOBIS.CON.AccountingInterface', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Manual Transaccional') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Manual Transaccional', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Manual Transaccional'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go


-- Registros para: PI.CON.FModifiPerfilClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: PI.CON.FModifiPerfilClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FModifiPerfilClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Modific Perfiles', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.InterfazCont'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FModifiPerfilClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.AccountingInterface', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.AccountingInterface', 'COBISCorp.tCOBIS.CON.AccountingInterface.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FModifiPerfil', 'FModifiPerfilClass', 'COBISCorp.tCOBIS.CON.AccountingInterface', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta de Modific Perfiles') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Modific Perfiles', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta de Modific Perfiles'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FCbProductoClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: PI.CON.FCbProductoClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FCbProductoClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Contabilización Productos', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.InterfazCont'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FCbProductoClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.AccountingInterface', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.AccountingInterface') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.AccountingInterface', 'COBISCorp.tCOBIS.CON.AccountingInterface.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.AccountingInterface'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FCbProducto', 'FCbProductoClass', 'COBISCorp.tCOBIS.CON.AccountingInterface', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Contabilización Productos') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Contabilización Productos', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Contabilización Productos'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go


-- Registros para: PI.Transaccion                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: PI.Transaccion'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_page where pa_name = 'PI.Transaccion') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Transacciones', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Contabilidad'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.Transaccion', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                              
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

-- Registros para: PI.CON.FCotizacionesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FCotizacionesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FCotizacionesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Cotizaciones', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Transaccion'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FCotizacionesClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.Transactions') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.Transactions', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.Transactions'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.Transactions') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.Transactions', 'COBISCorp.tCOBIS.CON.Transactions.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.Transactions'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FCotizaciones', 'FCotizacionesClass', 'COBISCorp.tCOBIS.CON.Transactions', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Cotizaciones') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Cotizaciones', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Cotizaciones'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FSeguridadClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
print 'Registros para: PI.CON.FSeguridadClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FSeguridadClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Seguridad en Ingreso/Consulta de Datos', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Transaccion'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FSeguridadClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.Transactions') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.Transactions', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.Transactions'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.Transactions') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.Transactions', 'COBISCorp.tCOBIS.CON.Transactions.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.Transactions'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FSeguridad', 'FSeguridadClass', 'COBISCorp.tCOBIS.CON.Transactions', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Seguridad en Ingreso/Consulta de Datos') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Seguridad en Ingreso/Consulta de Datos', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Seguridad en Ingreso/Consulta de Datos'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FComprobanteTipoClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
print 'Registros para: PI.CON.FComprobanteTipoClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FComprobanteTipoClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Ingreso Comprobantes Tipo', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Transaccion'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FComprobanteTipoClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.Transactions') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.Transactions', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.Transactions'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.Transactions') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.Transactions', 'COBISCorp.tCOBIS.CON.Transactions.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.Transactions'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FComprobanteTipo', 'FComprobanteTipoClass', 'COBISCorp.tCOBIS.CON.Transactions', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Ingreso Comprobantes Tipo') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Ingreso Comprobantes Tipo', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Ingreso Comprobantes Tipo'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FComprobanteClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: PI.CON.FComprobanteClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FComprobanteClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Ingreso Comprobantes Contables', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Transaccion'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FComprobanteClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.Transactions') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.Transactions', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.Transactions'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.Transactions') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.Transactions', 'COBISCorp.tCOBIS.CON.Transactions.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.Transactions'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FComprobante', 'FComprobanteClass', 'COBISCorp.tCOBIS.CON.Transactions', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Ingreso Comprobantes Contables') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Ingreso Comprobantes Contables', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Ingreso Comprobantes Contables'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FConsultaComprobtClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: PI.CON.FConsultaComprobtClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FConsultaComprobtClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Aprobar-Anular Comprobantes', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Transaccion'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FConsultaComprobtClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.Transactions') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.Transactions', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.Transactions'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.Transactions') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.Transactions', 'COBISCorp.tCOBIS.CON.Transactions.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.Transactions'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FConsultaComprobt', 'FConsultaComprobtClass', 'COBISCorp.tCOBIS.CON.Transactions', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Aprobar-Anular Comprobantes') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Aprobar-Anular Comprobantes', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Aprobar-Anular Comprobantes'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FNitpadecClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: PI.CON.FNitpadecClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FNitpadecClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Nits Oficinas Pago Declaraciones', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Transaccion'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FNitpadecClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.Transactions') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.Transactions', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.Transactions'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.Transactions') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.Transactions', 'COBISCorp.tCOBIS.CON.Transactions.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.Transactions'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FNitpadec', 'FNitpadecClass', 'COBISCorp.tCOBIS.CON.Transactions', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Nits Oficinas Pago Declaraciones') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Nits Oficinas Pago Declaraciones', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Nits Oficinas Pago Declaraciones'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FCtrlcpdClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: PI.CON.FCtrlcpdClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FCtrlcpdClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Control Comprob. Pago Declaraciones', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Transaccion'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FCtrlcpdClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.Transactions') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.Transactions', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.Transactions'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.Transactions') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.Transactions', 'COBISCorp.tCOBIS.CON.Transactions.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.Transactions'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FCtrlcpd', 'FCtrlcpdClass', 'COBISCorp.tCOBIS.CON.Transactions', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Control Comprob. Pago Declaraciones') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Control Comprob. Pago Declaraciones', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Control Comprob. Pago Declaraciones'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.ConsultaLin                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: PI.ConsultaLin'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_page where pa_name = 'PI.ConsultaLin') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consultas en Línea', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Contabilidad'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.ConsultaLin', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                              
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

-- Registros para: PI.CON.FSaldosContables2Class                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FSaldosContables2Class'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FSaldosContables2Class') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta Saldos Contables por Fecha', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaLin'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FSaldosContables2Class', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.OnlineConsultations', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.OnlineConsultations', 'COBISCorp.tCOBIS.CON.OnlineConsultations.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FSaldosContables2', 'FSaldosContables2Class', 'COBISCorp.tCOBIS.CON.OnlineConsultations', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta Saldos Contables por Fecha') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta Saldos Contables por Fecha', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta Saldos Contables por Fecha'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FSaldosContables3Class                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FSaldosContables3Class'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FSaldosContables3Class') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Plan de Cuentas con Saldos', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaLin'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FSaldosContables3Class', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.OnlineConsultations', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.OnlineConsultations', 'COBISCorp.tCOBIS.CON.OnlineConsultations.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FSaldosContables3', 'FSaldosContables3Class', 'COBISCorp.tCOBIS.CON.OnlineConsultations', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta de Plan de Cuentas con Saldos') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Plan de Cuentas con Saldos', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta de Plan de Cuentas con Saldos'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FSaldosContables4Class                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FSaldosContables4Class'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FSaldosContables4Class') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Saldos Consolidados', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaLin'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FSaldosContables4Class', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.OnlineConsultations', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.OnlineConsultations', 'COBISCorp.tCOBIS.CON.OnlineConsultations.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FSaldosContables4', 'FSaldosContables4Class', 'COBISCorp.tCOBIS.CON.OnlineConsultations', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta de Saldos Consolidados') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Saldos Consolidados', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta de Saldos Consolidados'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FSaldosContablesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FSaldosContablesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FSaldosContablesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta Saldos Contables por Período', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaLin'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FSaldosContablesClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.OnlineConsultations', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.OnlineConsultations', 'COBISCorp.tCOBIS.CON.OnlineConsultations.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FSaldosContables', 'FSaldosContablesClass', 'COBISCorp.tCOBIS.CON.OnlineConsultations', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta Saldos Contables por Período') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta Saldos Contables por Período', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta Saldos Contables por Período'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FTranCuentaClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FTranCuentaClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FTranCuentaClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta Estado de Cuenta', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaLin'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FTranCuentaClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.OnlineConsultations', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.OnlineConsultations', 'COBISCorp.tCOBIS.CON.OnlineConsultations.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FTranCuenta', 'FTranCuentaClass', 'COBISCorp.tCOBIS.CON.OnlineConsultations', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta Estado de Cuenta') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta Estado de Cuenta', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta Estado de Cuenta'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go
-- Registros para: PI.CON.FTranCuentaHClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FTranCuentaHClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FTranCuentaHClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta Estado de Cuenta Histórico', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaLin'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FTranCuentaHClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.OnlineConsultations', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.OnlineConsultations', 'COBISCorp.tCOBIS.CON.OnlineConsultations.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FTranCuentaH', 'FTranCuentaHClass', 'COBISCorp.tCOBIS.CON.OnlineConsultations', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta Estado de Cuenta Histórico') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta Estado de Cuenta Histórico', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta Estado de Cuenta Histórico'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FCompBuscaClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FCompBuscaClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FCompBuscaClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Comprobantes Contables', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaLin'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FCompBuscaClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.OnlineConsultations', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.OnlineConsultations', 'COBISCorp.tCOBIS.CON.OnlineConsultations.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FCompBusca', 'FCompBuscaClass', 'COBISCorp.tCOBIS.CON.OnlineConsultations', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta Estado de Cuenta') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Comprobantes Contables', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta de Comprobantes Contables'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FConsultaPuentesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FConsultaPuentesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FConsultaPuentesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Cuentas Puente', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaLin'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FConsultaPuentesClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.OnlineConsultations', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.OnlineConsultations', 'COBISCorp.tCOBIS.CON.OnlineConsultations.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FConsultaPuentes', 'FConsultaPuentesClass', 'COBISCorp.tCOBIS.CON.OnlineConsultations', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta de Cuentas Puente') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Cuentas Puente', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta de Cuentas Puente'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FEstadoFinancClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FEstadoFinancClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FEstadoFinancClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta Estados Finan. No Mayorizados', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaLin'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FEstadoFinancClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.OnlineConsultations', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.OnlineConsultations', 'COBISCorp.tCOBIS.CON.OnlineConsultations.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FEstadoFinanc', 'FEstadoFinancClass', 'COBISCorp.tCOBIS.CON.OnlineConsultations', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta Estados Finan. No Mayorizados') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta Estados Finan. No Mayorizados', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta Estados Finan. No Mayorizados'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

/*
-- Registros para: PI.CON.FReadFileClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FReadFileClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FReadFileClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta Reportes Generados en Batch', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaLin'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FReadFileClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.OnlineConsultations', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.OnlineConsultations') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.OnlineConsultations', 'COBISCorp.tCOBIS.CON.OnlineConsultations.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.OnlineConsultations'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FReadFile', 'FReadFileClass', 'COBISCorp.tCOBIS.CON.OnlineConsultations', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta Reportes Generados en Batch') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta Reportes Generados en Batch', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta Reportes Generados en Batch'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go
*/

--FVA
print 'Registros para: PI.ConsultasExcel'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_page where pa_name = 'PI.ConsultasExcel') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consultas Excel', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Contabilidad'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.ConsultasExcel', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                              
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go  

-- Registros para: PI.CON.FExcelDeclaracionesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FExcelDeclaracionesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FExcelDeclaracionesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Declaraciones', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultasExcel'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FExcelDeclaracionesClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.ExcelQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.ExcelQuery', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.ExcelQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.ExcelQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.ExcelQuery', 'COBISCorp.tCOBIS.CON.ExcelQuery.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.ExcelQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FExcelDeclaraciones', 'FExcelDeclaracionesClass', 'COBISCorp.tCOBIS.CON.ExcelQuery', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Declaraciones') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Declaraciones', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Declaraciones'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go


-- Registros para: PI.CON.FExcelAnexosClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FExcelAnexosClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FExcelAnexosClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Anexos', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultasExcel'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FExcelAnexosClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.ExcelQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.ExcelQuery', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.ExcelQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.ExcelQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.ExcelQuery', 'COBISCorp.tCOBIS.CON.ExcelQuery.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.ExcelQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FExcelAnexos', 'FExcelAnexosClass', 'COBISCorp.tCOBIS.CON.ExcelQuery', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Anexos') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Anexos', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Anexos'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go


-- Registros para: PI.CON.FProvisionesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FProvisionesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FProvisionesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Provisiones', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultasExcel'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FProvisionesClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.ExcelQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.ExcelQuery', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.ExcelQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.ExcelQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.ExcelQuery', 'COBISCorp.tCOBIS.CON.ExcelQuery.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.ExcelQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FProvisiones', 'FProvisionesClass', 'COBISCorp.tCOBIS.CON.ExcelQuery', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Provisiones') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Provisiones', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Provisiones'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go
--FVA

-- Registros para: PI.ConsultaAux                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: PI.ConsultaAux'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_page where pa_name = 'PI.ConsultaAux') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Auxiliares', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Contabilidad'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.ConsultaAux', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                              
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

-- Registros para: PI.CON.FBusquedaAuxiliaresClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FBusquedaAuxiliaresClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FBusquedaAuxiliaresClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Auxiliares', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaAux'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FBusquedaAuxiliaresClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.AuxiliaryQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.AuxiliaryQuery', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.AuxiliaryQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.AuxiliaryQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.AuxiliaryQuery', 'COBISCorp.tCOBIS.CON.AuxiliaryQuery.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.AuxiliaryQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FBusquedaAuxiliares', 'FBusquedaAuxiliaresClass', 'COBISCorp.tCOBIS.CON.AuxiliaryQuery', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta de Auxiliares') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Auxiliares', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta de Auxiliares'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FBusquedaAuxiliaresHClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FBusquedaAuxiliaresHClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FBusquedaAuxiliaresHClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Auxiliares Históricos', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaAux'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FBusquedaAuxiliaresHClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.AuxiliaryQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.AuxiliaryQuery', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.AuxiliaryQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.AuxiliaryQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.AuxiliaryQuery', 'COBISCorp.tCOBIS.CON.AuxiliaryQuery.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.AuxiliaryQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FBusquedaAuxiliaresH', 'FBusquedaAuxiliaresHClass', 'COBISCorp.tCOBIS.CON.AuxiliaryQuery', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta de Auxiliares Históricos') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta de Auxiliares Históricos', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta de Auxiliares Históricos'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FConsultaCuentaClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FConsultaCuentaClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FConsultaCuentaClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta por Cuenta', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaAux'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FConsultaCuentaClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.AuxiliaryQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.AuxiliaryQuery', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.AuxiliaryQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.AuxiliaryQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.AuxiliaryQuery', 'COBISCorp.tCOBIS.CON.AuxiliaryQuery.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.AuxiliaryQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FConsultaCuenta', 'FConsultaCuentaClass', 'COBISCorp.tCOBIS.CON.AuxiliaryQuery', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta por Cuenta') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta por Cuenta', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta por Cuenta'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FConsultaCuentaHClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FConsultaCuentaHClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FConsultaCuentaHClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta por Cuenta Históricos', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaAux'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FConsultaCuentaHClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.AuxiliaryQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.AuxiliaryQuery', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.AuxiliaryQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.AuxiliaryQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.AuxiliaryQuery', 'COBISCorp.tCOBIS.CON.AuxiliaryQuery.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.AuxiliaryQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FConsultaCuentaH', 'FConsultaCuentaHClass', 'COBISCorp.tCOBIS.CON.AuxiliaryQuery', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta por Cuenta Históricos') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta por Cuenta Históricos', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta por Cuenta Históricos'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FConsultaTerceroClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FConsultaTerceroClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FConsultaTerceroClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta por Tercero', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaAux'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FConsultaTerceroClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.AuxiliaryQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.AuxiliaryQuery', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.AuxiliaryQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.AuxiliaryQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.AuxiliaryQuery', 'COBISCorp.tCOBIS.CON.AuxiliaryQuery.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.AuxiliaryQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FConsultaTercero', 'FConsultaTerceroClass', 'COBISCorp.tCOBIS.CON.AuxiliaryQuery', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta por Tercero') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta por Tercero', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta por Tercero'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FConsultaTerceroHClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FConsultaTerceroHClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FConsultaTerceroHClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta por Tercero Histórico', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaAux'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FConsultaTerceroHClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.AuxiliaryQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.AuxiliaryQuery', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.AuxiliaryQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.AuxiliaryQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.AuxiliaryQuery', 'COBISCorp.tCOBIS.CON.AuxiliaryQuery.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.AuxiliaryQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FConsultaTerceroH', 'FConsultaTerceroHClass', 'COBISCorp.tCOBIS.CON.AuxiliaryQuery', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta por Tercero Histórico') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta por Tercero Histórico', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta por Tercero Histórico'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FTerceroBuscaClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FTerceroBuscaClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FTerceroBuscaClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta Transacciones de Terceros', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.ConsultaAux'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FTerceroBuscaClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.AuxiliaryQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.AuxiliaryQuery', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.AuxiliaryQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.AuxiliaryQuery') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.AuxiliaryQuery', 'COBISCorp.tCOBIS.CON.AuxiliaryQuery.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.AuxiliaryQuery'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FTerceroBusca', 'FTerceroBuscaClass', 'COBISCorp.tCOBIS.CON.AuxiliaryQuery', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Consulta Transacciones de Terceros') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Consulta Transacciones de Terceros', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Consulta Transacciones de Terceros'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go


-- Registros para: PI.Reporte                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
print 'Registros para: PI.Reporte'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_page where pa_name = 'PI.Reporte') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Reportes', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Contabilidad'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.Reporte', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                              
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

-- Registros para: PI.CON.FLibMayorClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FLibMayorClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FLibMayorClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Libro Mayor', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Reporte'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FLibMayorClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.Reports') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.Reports', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.Reports'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.Reports') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.Reports', 'COBISCorp.tCOBIS.CON.Reports.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.Reports'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FLibMayor', 'FLibMayorClass', 'COBISCorp.tCOBIS.CON.Reports', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Libro Mayor') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Libro Mayor', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Libro Mayor'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go

-- Registros para: PI.CON.FLibDiaClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.CON.FLibDiaClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_page where pa_name = 'PI.CON.FLibDiaClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int,
        @w_parent_module varchar(100), @w_id_parent_module int --JHI
select @w_rol = ro_rol from   cobis..ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_parent_module  = 'CON.SharedLibrary'     --JHI
select @w_id_parent_module = mo_id       --JHI
from cobis..an_module 
where mo_name = @w_parent_module  
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Libro Diario', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   cobis..an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from cobis..an_page where pa_name = 'PI.Reporte'                                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into cobis..an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.CON.FLibDiaClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-CON', '', null)                                                                                                                                                                                                                                                                                                                                                                    
insert into cobis..an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into cobis..an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from cobis..an_module_group where mg_name = 'CON.Reports') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   cobis..an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into cobis..an_module_group values (@w_mg_id, 'CON.Reports', '4.0.0.1', 'http://[servername]/CONTA/CONTA.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from cobis..an_module_group where mg_name = 'CON.Reports'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from cobis..an_module where mo_name = 'CON.Reports') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   cobis..an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into cobis..an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'CON.Reports', 'COBISCorp.tCOBIS.CON.Reports.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                     
end else select @w_mo_id = mo_id from cobis..an_module where mo_name = 'CON.Reports'                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from cobis..an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into cobis..an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   cobis..an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into cobis..an_component values (@w_co_id, @w_mo_id, 'CON.FLibDia', 'FLibDiaClass', 'COBISCorp.tCOBIS.CON.Reports', 'SV', '', 'M-CON')                                                                                                                                                                                                                                                                                                                                                                                   
insert into cobis..an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from cobis..an_label where la_label = 'Libro Diario') begin                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_la_id = isnull(max(la_id), 0) + 1 from   cobis..an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into cobis..an_label values (@w_la_id, @w_la_cod, 'Libro Diario', 'M-CON')
end
else select @w_la_id = la_id from cobis..an_label where la_label = 'Libro Diario'
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   cobis..an_page_zone
if @w_pz_id is null select @w_pz_id = 1
if not exists (select 1 from cobis..an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin
insert into cobis..an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)
end
if not exists (select 1 from cobis..an_module_dependency where md_mo_id = @w_mo_id and md_dependency_id = @w_id_parent_module)
begin
insert into cobis..an_module_dependency values (@w_mo_id ,@w_id_parent_module)    --JHI
end
end  

go
