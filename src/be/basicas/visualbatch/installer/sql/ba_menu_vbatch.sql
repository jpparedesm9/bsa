/********************************************************************************************/ 
/*   Script para creacion de páginas y version de componentes y ubicacion de instaladores   */ 
/*   de la base de datos cobis - VBatch                                                     */                                                                                                                                                                  
/********************************************************************************************/ 
  

use cobis                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
go

delete an_role_page from an_role_page, an_page, an_label where rp_pa_id = pa_id and pa_la_id = la_id and la_prod_name in ('M-ADMVBA')                                                                                                                        
delete an_module_group where mg_name like ('ADMVBA%')
delete an_page_zone from an_page_zone, an_label where pz_la_id = la_id and la_prod_name in ('M-ADMVBA')                                                                                                                        
delete an_role_module from an_role_module, an_module, an_label where rm_mo_id = mo_id and mo_la_id = la_id and la_prod_name in ('M-ADMVBA')                                                                                                                        
--delete an_navigation_zone from an_navigation_zone, an_label where nz_la_id = la_id and la_prod_name in ('M-ADMVBA')                                                                                                                        
delete an_role_component from an_role_component,an_component where rc_co_id = co_id and co_prod_name in ('M-ADMVBA') 
delete an_module_dependency where md_mo_id in (select mo_id from an_module where mo_name like ('ADMVBA%'))
delete an_module from an_module, an_label where mo_la_id = la_id and la_prod_name in ('M-ADMVBA')                                                                                                                        
delete an_component where co_prod_name in ('M-ADMVBA')                                                                                                                        
delete an_page from an_page, an_label where pa_la_id = la_id and la_prod_name in ('M-ADMVBA')                                                                                                                        
delete an_label where la_prod_name in ('M-ADMVBA')
delete an_role_install where ri_prod_name in ('M-ADMVBA')
go

-- Insercion en tabla de roles instalados por producto
print 'Insercion en tabla de roles instalados por producto' 
declare @w_rol int, @w_return int
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'
insert into an_role_install values ('M-ADMVBA', @w_rol)

print 'SCRIPT DE CATALOGACION DE ARCHIVOS DE RECURSOS'
/***************************************************************************/
/*        SCRIPT DE CATALOGACION DE ARCHIVOS DE RECURSOS                   */
/***************************************************************************/

exec @w_return =sp_cen_catalogar
	@i_opcion               = 'MOD',
	@i_role                 = @w_rol,
	@i_prod_name            = 'M-ADMVBA',
	@i_module_group         = 'ADMVBA.Aux',
	@i_zone                 = 'Zona 1',
	@i_module               = 'ADMVBA.Aux',
	@i_label_module         = 'ADMVBA.Aux',
	@i_namespace_component  = 'COBISCorp.tCOBIS.ADMVBA.Aux',
	@i_filename_module      = 'COBISCorp.tCOBIS.ADMVBA.Aux.dll',
	@i_version              = '4.0.0.1',
    @i_localizacion         = 'http://[servername]/VBatch/ADMVBA.Aux.Installer/ADMVBA.Aux.Installer.application',
    @i_parent_module	    = null

	if @w_return <> 0
		print 'Error Creando MOD:ADMVBA.Aux'


exec @w_return		= sp_cen_catalogar
	@i_opcion               = 'MOD',                                   
	@i_role                 = @w_rol,        
	@i_prod_name            = 'M-ADMVBA',
	@i_module_group         = 'ADMVBA.Resources',                        
	@i_zone                 = 'Zona 1',
	@i_module               = 'ADMVBA.Resources',
	@i_label_module         = 'ADMVBA.Resources',
	@i_filename_module      = 'COBISCorp.tCOBIS.ADMVBA.Resources.dll',
	@i_version              = '4.0.0.1', 
	@i_localizacion         = 'http://[servername]/VBatch/ADMVBA.Resources.Installer/ADMVBA.Resources.Installer.application',
	@i_parent_module        = 'ADMVBA.Aux'

 if @w_return<> 0
    print 'Error craendo ADMVBA.Resources'

exec @w_return =sp_cen_catalogar
	@i_opcion               = 'MOD',
	@i_role                 = @w_rol,
	@i_prod_name            = 'M-ADMVBA',
	@i_module_group         = 'ADMVBA.SharedLibrary',
	@i_zone                 = 'Zona 1',
	@i_module               = 'ADMVBA.SharedLibrary',
	@i_label_module         = 'ADMVBA.SharedLibrary',
	@i_namespace_component  = 'COBISCorp.tCOBIS.ADMVBA.SharedLibrary',
	@i_filename_module      = 'COBISCorp.tCOBIS.ADMVBA.SharedLibrary.dll',
	@i_version             = '4.0.0.1',
    @i_localizacion        = 'http://[servername]/VBatch/ADMVBA.SharedLibrary.Installer/ADMVBA.SharedLibrary.Installer.application',
	@i_parent_module       = 'ADMVBA.Resources'
	
	if @w_return <> 0
		print 'Error Creando MOD:ADMVBA.SharedLibrary'

go
																																																																																																																															  
-- Registros para: PI.Operativo - Visual Batch                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: PI.Operativo - Visual Batch'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from an_page where pa_name = 'PI.Operativo - Visual Batch') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Visual Batch', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Procesos Internos'                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.Operativo - Visual Batch', 'icono pagina', @w_pa_id_parent, 17, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.Mantenimiento                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
print 'Registros para: PI.Mantenimiento'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_page where pa_name = 'PI.Mantenimiento') begin                                                                                                                                                                                                                                                                                                                                                                                                                                            
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Mantenimiento', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Operativo - Visual Batch'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.Mantenimiento', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                                      
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.ADMVBA.FPathProcClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
print 'Registros para: PI.ADMVBA.FPathProcClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_page where pa_name = 'PI.ADMVBA.FPathProcClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Path por Producto', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Mantenimiento'                                                                                                                                                                                                                                                                                                                                                                                                                                            
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.ADMVBA.FPathProcClass', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMVBA.Administration') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMVBA.Administration', '4.0.0.1', 'http://[servername]/VBatch/ADMVBA.Administration.Installer/ADMVBA.Administration.Installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                    
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMVBA.Administration'                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_module where mo_name = 'ADMVBA.Administration') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMVBA.Administration', 'COBISCorp.tCOBIS.ADMVBA.Administration.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMVBA.Administration'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMVBA.FPathProc', 'FPathProcClass', 'COBISCorp.tCOBIS.ADMVBA.Administration', 'SV', '', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                  
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Path por Producto') begin                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Path por Producto', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                          
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Path por Producto'                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.ADMVBA.FManteniClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: PI.ADMVBA.FManteniClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
if not exists (select 1 from an_page where pa_name = 'PI.ADMVBA.FManteniClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Programas', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Mantenimiento'                                                                                                                                                                                                                                                                                                                                                                                                                                            
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.ADMVBA.FManteniClass', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                               
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMVBA.Administration') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMVBA.Administration', '4.0.0.1', 'http://[servername]/VBatch/ADMVBA.Administration.Installer/ADMVBA.Administration.Installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                    
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMVBA.Administration'                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_module where mo_name = 'ADMVBA.Administration') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMVBA.Administration', 'COBISCorp.tCOBIS.ADMVBA.Administration.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMVBA.Administration'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMVBA.FManteni', 'FManteniClass', 'COBISCorp.tCOBIS.ADMVBA.Administration', 'SV', '', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                    
insert into an_role_component values (@w_co_id, @w_rol)
if not exists (select 1 from an_label where la_label = 'Programas') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Programas', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Programas'                                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.ADMVBA.FLotesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.ADMVBA.FLotesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_page where pa_name = 'PI.ADMVBA.FLotesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Lotes de Programas', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Mantenimiento'                                                                                                                                                                                                                                                                                                                                                                                                                                            
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.ADMVBA.FLotesClass', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                                 
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMVBA.Administration') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMVBA.Administration', '4.0.0.1', 'http://[servername]/VBatch/ADMVBA.Administration.Installer/ADMVBA.Administration.Installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                    
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMVBA.Administration'                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_module where mo_name = 'ADMVBA.Administration') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMVBA.Administration', 'COBISCorp.tCOBIS.ADMVBA.Administration.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMVBA.Administration'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMVBA.FLotes', 'FLotesClass', 'COBISCorp.tCOBIS.ADMVBA.Administration', 'SV', '', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Lotes de Programas') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Lotes de Programas', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                         
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Lotes de Programas'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.ADMVBA.FFCierreClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: PI.ADMVBA.FFCierreClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
if not exists (select 1 from an_page where pa_name = 'PI.ADMVBA.FFCierreClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Actualización Fechas de Cierre', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Mantenimiento'                                                                                                                                                                                                                                                                                                                                                                                                                                            
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.ADMVBA.FFCierreClass', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                               
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMVBA.Administration') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMVBA.Administration', '4.0.0.1', 'http://[servername]/VBatch/ADMVBA.Administration.Installer/ADMVBA.Administration.Installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                    
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMVBA.Administration'                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_module where mo_name = 'ADMVBA.Administration') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMVBA.Administration', 'COBISCorp.tCOBIS.ADMVBA.Administration.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMVBA.Administration'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMVBA.FFCierre', 'FFCierreClass', 'COBISCorp.tCOBIS.ADMVBA.Administration', 'SV', '', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                    
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Actualización Fechas de Cierre') begin                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Actualización Fechas de Cierre', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                             
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Actualización Fechas de Cierre'                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end 
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.ADMVBA.FAutorizacionClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: PI.ADMVBA.FAutorizacionClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'PI.ADMVBA.FAutorizacionClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Autorización Fecha de Proceso', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Mantenimiento'                                                                                                                                                                                                                                                                                                                                                                                                                                            
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.ADMVBA.FAutorizacionClass', 'icono pagina', @w_pa_id_parent, 5, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMVBA.Administration') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMVBA.Administration', '4.0.0.1', 'http://[servername]/VBatch/ADMVBA.Administration.Installer/ADMVBA.Administration.Installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                    
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMVBA.Administration'                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_module where mo_name = 'ADMVBA.Administration') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMVBA.Administration', 'COBISCorp.tCOBIS.ADMVBA.Administration.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMVBA.Administration'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMVBA.FAutorizacion', 'FAutorizacionClass', 'COBISCorp.tCOBIS.ADMVBA.Administration', 'SV', '', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Autorización Fecha de Proceso') begin                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Autorización Fecha de Proceso', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                             
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Autorización Fecha de Proceso'                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.ADMVBA.FAutBatchClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
print 'Registros para: PI.ADMVBA.FAutBatchClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_page where pa_name = 'PI.ADMVBA.FAutBatchClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Autorización de Procesos por Login', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Mantenimiento'                                                                                                                                                                                                                                                                                                                                                                                                                                            
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.ADMVBA.FAutBatchClass', 'icono pagina', @w_pa_id_parent, 6, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMVBA.Security') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMVBA.Security', '4.0.0.1', 'http://[servername]/VBatch/ADMVBA.Security.Installer/ADMVBA.Security.Installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                      
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMVBA.Security'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_module where mo_name = 'ADMVBA.Security') begin                                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMVBA.Security', 'COBISCorp.tCOBIS.ADMVBA.Security.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                           
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMVBA.Security'                                                                                                                                                                                                                                                                                                                                                                                                                                         
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMVBA.FAutBatch', 'FAutBatchClass', 'COBISCorp.tCOBIS.ADMVBA.Security', 'SV', '', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Autorización de Procesos por Login') begin                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Autorización de Procesos por Login', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                         
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Autorización de Procesos por Login'                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end 
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

----------------------------------------------------------
-- JHI: SE COMENTA USO DE ESTA PANTALLA, YA QUE NO APLICA
----------------------------------------------------------
-- Registros para: PI.ADMVBA.FSeguridadClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
-- print 'Registros para: PI.ADMVBA.FSeguridadClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
-- if not exists (select 1 from an_page where pa_name = 'PI.ADMVBA.FSeguridadClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
-- declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
-- select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
-- select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
-- select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
-- insert into an_label values (@w_la_id, @w_la_cod, 'Acceso a la Lectura de  Reportes', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                           
-- select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
-- select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Mantenimiento'                                                                                                                                                                                                                                                                                                                                                                                                                                            
-- insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.ADMVBA.FSeguridadClass', 'icono pagina', @w_pa_id_parent, 7, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                             
-- insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
-- if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
-- if not exists (select 1 from an_module_group where mg_name = 'ADMVBA.Security') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
-- select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
-- insert into an_module_group values (@w_mg_id, 'ADMVBA.Security', '4.0.0.1', 'http://[servername]/VBatch/ADMVBA.Security.Installer/ADMVBA.Security.Installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                      
-- end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMVBA.Security'                                                                                                                                                                                                                                                                                                                                                                                                                                   
-- if not exists (select 1 from an_module where mo_name = 'ADMVBA.Security') begin                                                                                                                                                                                                                                                                                                                                                                                                                                           
-- select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
-- insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMVBA.Security', 'COBISCorp.tCOBIS.ADMVBA.Security.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                           
-- end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMVBA.Security'                                                                                                                                                                                                                                                                                                                                                                                                                                         
-- if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
-- select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
-- insert into an_component values (@w_co_id, @w_mo_id, 'ADMVBA.FSeguridad', 'FSeguridadClass', 'COBISCorp.tCOBIS.ADMVBA.Security', 'SV', '', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                      
-- insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
-- if not exists (select 1 from an_label where la_label = 'Acceso a la Lectura de Reportes') begin                                                                                                                                                                                                                                                                                                                                                                                                                           
-- select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
-- insert into an_label values (@w_la_id, @w_la_cod, 'Acceso a la Lectura de Reportes', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                            
-- end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- else select @w_la_id = la_id from an_label where la_label = 'Acceso a la Lectura de Reportes'                                                                                                                                                                                                                                                                                                                                                                                                                             
-- select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
-- if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
-- if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
-- insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
-- end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
--insert into an_transaction_component values (@w_co_id, 1574, null)
--insert into an_operation_component values (@w_co_id, 'INSERTA', @w_la_id, 'Incerción de Parametros', 'BUTTON')
--insert into an_operation_component values (@w_co_id, 'MODIFICA', @w_la_id, 'Modificación de Parametros', 'BUTTON')
--insert into an_operation_component values (@w_co_id, 'ELIMINA', @w_la_id, 'Eliminación de Parametros', 'BUTTON')
--insert into an_operation_component values (@w_co_id, 'BUSCAR', @w_la_id, 'Busqueda de Parametros', 'BUTTON')
--insert into an_transaction_component values (@w_co_id, 8061, 'INSERTA')
--insert into an_transaction_component values (@w_co_id, 8062, 'MODIFICA')
--insert into an_transaction_component values (@w_co_id, 8063, 'ELIMINA')
--insert into an_transaction_component values (@w_co_id, 8065, 'BUSCAR')
-- go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

----------------------------------------------------------
-- JHI: SE COMENTA USO DE ESTA PANTALLA, YA QUE NO APLICA
----------------------------------------------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.ADMVBA.FImpresorasClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
-- print 'Registros para: PI.ADMVBA.FImpresorasClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-- if not exists (select 1 from an_page where pa_name = 'PI.ADMVBA.FImpresorasClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                  
-- declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
-- select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
-- select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
-- select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
-- insert into an_label values (@w_la_id, @w_la_cod, 'Definición de Impresoras', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                   
-- select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
-- select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Mantenimiento'                                                                                                                                                                                                                                                                                                                                                                                                                                            
-- insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.ADMVBA.FImpresorasClass', 'icono pagina', @w_pa_id_parent, 8, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                            
-- insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
-- if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
-- if not exists (select 1 from an_module_group where mg_name = 'ADMVBA.Administration') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
-- select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
-- insert into an_module_group values (@w_mg_id, 'ADMVBA.Administration', '4.0.0.1', 'http://[servername]/VBatch/ADMVBA.Administration.Installer/ADMVBA.Administration.Installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                    
-- end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMVBA.Administration'                                                                                                                                                                                                                                                                                                                                                                                                                             
-- if not exists (select 1 from an_module where mo_name = 'ADMVBA.Administration') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
-- select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
-- insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMVBA.Administration', 'COBISCorp.tCOBIS.ADMVBA.Administration.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                               
-- end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMVBA.Administration'                                                                                                                                                                                                                                                                                                                                                                                                                                   
-- if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
-- select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
-- insert into an_component values (@w_co_id, @w_mo_id, 'ADMVBA.FImpresoras', 'FImpresorasClass', 'COBISCorp.tCOBIS.ADMVBA.Administration', 'SV', '', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                              
-- insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
-- if not exists (select 1 from an_label where la_label = 'Definición de Impresoras') begin                                                                                                                                                                                                                                                                                                                                                                                                                                  
-- select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
-- insert into an_label values (@w_la_id, @w_la_cod, 'Definición de Impresoras', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                   
-- end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- else select @w_la_id = la_id from an_label where la_label = 'Definición de Impresoras'                                                                                                                                                                                                                                                                                                                                                                                                                                    
-- select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
-- if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
-- if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
-- insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
-- end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
--insert into an_operation_component values (@w_co_id, 'IMPRIME', @w_la_id, 'Impreción de Parametros', 'BUTTON')
--insert into an_transaction_component values (@w_co_id, 8001, 'IMPRIME')
-- go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.ADMVBA.frmFTPClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
print 'Registros para: PI.ADMVBA.frmFTPClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_page where pa_name = 'PI.ADMVBA.frmFTPClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                       
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Conexión a FTP/SFTP', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Mantenimiento'                                                                                                                                                                                                                                                                                                                                                                                                                                            
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.ADMVBA.frmFTPClass', 'icono pagina', @w_pa_id_parent, 9, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                                 
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMVBA.Administration') begin                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMVBA.Administration', '4.0.0.1', 'http://[servername]/VBatch/ADMVBA.Administration.Installer/ADMVBA.Administration.Installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                    
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMVBA.Administration'                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_module where mo_name = 'ADMVBA.Administration') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMVBA.Administration', 'COBISCorp.tCOBIS.ADMVBA.Administration.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                               
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMVBA.Administration'                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMVBA.frmFTP', 'frmFTPClass', 'COBISCorp.tCOBIS.ADMVBA.Administration', 'SV', '', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Conexión a FTP/SFTP') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Conexión a FTP/SFTP', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                                   
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Conexión a FTP/SFTP'                                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.Ejecución                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: PI.Ejecución'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'PI.Ejecución') begin                                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Ejecución', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Operativo - Visual Batch'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.Ejecución', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.ADMVBA.FAprobacionParamClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
print 'Registros para: PI.ADMVBA.FAprobacionParamClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page where pa_name = 'PI.ADMVBA.FAprobacionParamClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                             
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Aprobación de Parámetros', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Ejecución'                                                                                                                                                                                                                                                                                                                                                                                                                                                
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.ADMVBA.FAprobacionParamClass', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                       
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMVBA.Execution') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMVBA.Execution', '4.0.0.1', 'http://[servername]/VBatch/ADMVBA.Execution.Installer/ADMVBA.Execution.Installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMVBA.Execution'                                                                                                                                                                                                                                                                                                                                                                                                                                  
if not exists (select 1 from an_module where mo_name = 'ADMVBA.Execution') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMVBA.Execution', 'COBISCorp.tCOBIS.ADMVBA.Execution.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMVBA.Execution'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMVBA.FAprobacionParam', 'FAprobacionParamClass', 'COBISCorp.tCOBIS.ADMVBA.Execution', 'SV', '', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                         
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Aprobación de Parámetros') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Aprobación de Parámetros', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Aprobación de Parámetros'                                                                                                                                                                                                                                                                                                                                                                                                                                   
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.ADMVBA.FEjecLotesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
print 'Registros para: PI.ADMVBA.FEjecLotesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
if not exists (select 1 from an_page where pa_name = 'PI.ADMVBA.FEjecLotesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                   
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Ejecución de Lotes', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                         
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Ejecución'                                                                                                                                                                                                                                                                                                                                                                                                                                                
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.ADMVBA.FEjecLotesClass', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                             
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMVBA.Execution') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMVBA.Execution', '4.0.0.1', 'http://[servername]/VBatch/ADMVBA.Execution.Installer/ADMVBA.Execution.Installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                   
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMVBA.Execution'                                                                                                                                                                                                                                                                                                                                                                                                                                  
if not exists (select 1 from an_module where mo_name = 'ADMVBA.Execution') begin                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMVBA.Execution', 'COBISCorp.tCOBIS.ADMVBA.Execution.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                         
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMVBA.Execution'                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMVBA.FEjecLotes', 'FEjecLotesClass', 'COBISCorp.tCOBIS.ADMVBA.Execution', 'SV', '', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                     
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Ejecución de Lotes') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Ejecución de Lotes', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                         
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Ejecución de Lotes'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

----------------------------------------------------------
-- JHI: SE COMENTA USO DE ESTA PANTALLA, YA QUE NO APLICA
----------------------------------------------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-- Registros para: PI.ADMVBA.FReportesClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
-- print 'Registros para: PI.ADMVBA.FReportesClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
-- if not exists (select 1 from an_page where pa_name = 'PI.ADMVBA.FReportesClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
-- declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
-- select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
-- select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
-- select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
-- insert into an_label values (@w_la_id, @w_la_cod, 'Consulta e Impresión de Reportes', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                           
-- select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
-- select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Ejecución'                                                                                                                                                                                                                                                                                                                                                                                                                                                
-- insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) values (@w_pa_id, @w_la_id, 'PI.ADMVBA.FReportesClass', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                              
-- insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
-- if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
-- if not exists (select 1 from an_module_group where mg_name = 'ADMVBA.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
-- select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
-- insert into an_module_group values (@w_mg_id, 'ADMVBA.Query', '4.0.0.1', 'http://[servername]/VBatch/ADMVBA.Query.Installer/ADMVBA.Query.Installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                               
-- end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMVBA.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                      
-- if not exists (select 1 from an_module where mo_name = 'ADMVBA.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
-- insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMVBA.Query', 'COBISCorp.tCOBIS.ADMVBA.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                 
-- end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMVBA.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                            
-- if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
-- select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
-- insert into an_component values (@w_co_id, @w_mo_id, 'ADMVBA.FReportes', 'FReportesClass', 'COBISCorp.tCOBIS.ADMVBA.Query', 'SV', '', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                           
-- insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
-- if not exists (select 1 from an_label where la_label = 'Consulta e Impresión de Reportes') begin                                                                                                                                                                                                                                                                                                                                                                                                                          
-- select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
-- insert into an_label values (@w_la_id, @w_la_cod, 'Consulta e Impresión de Reportes', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                           
-- end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- else select @w_la_id = la_id from an_label where la_label = 'Consulta e Impresión de Reportes'                                                                                                                                                                                                                                                                                                                                                                                                                            
-- select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
-- if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
-- if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
-- insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
-- end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
--insert into an_transaction_component values (@w_co_id, 8008, null)
--insert into an_transaction_component values (@w_co_id, 8073, null)
--insert into an_transaction_component values (@w_co_id, 15030, null)
-- go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.Consultas-5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
print 'Registros para: PI.Consultas-5'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
if not exists (select 1 from an_page where pa_name = 'PI.Consultas-5') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consultas', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                                  
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Operativo - Visual Batch'                                                                                                                                                                                                                                                                                                                                                                                                                                 
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.Consultas-5', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                                        
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.ADMVBA.FConsTiemClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
print 'Registros para: PI.ADMVBA.FConsTiemClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
if not exists (select 1 from an_page where pa_name = 'PI.ADMVBA.FConsTiemClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                    
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consulta de Tiempos por Lotes', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Consultas-5'                                                                                                                                                                                                                                                                                                                                                                                                                                              
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.ADMVBA.FConsTiemClass', 'icono pagina', @w_pa_id_parent, 1, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                              
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMVBA.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMVBA.Query', '4.0.0.1', 'http://[servername]/VBatch/ADMVBA.Query.Installer/ADMVBA.Query.Installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                               
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMVBA.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADMVBA.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMVBA.Query', 'COBISCorp.tCOBIS.ADMVBA.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                 
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMVBA.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMVBA.FConsTiem', 'FConsTiemClass', 'COBISCorp.tCOBIS.ADMVBA.Query', 'SV', '', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                           
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Consulta de Tiempos por Lotes') begin                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consulta de Tiempos por Lotes', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Consulta de Tiempos por Lotes'                                                                                                                                                                                                                                                                                                                                                                                                                               
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.ADMVBA.FConsTiemExcClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
print 'Registros para: PI.ADMVBA.FConsTiemExcClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
if not exists (select 1 from an_page where pa_name = 'PI.ADMVBA.FConsTiemExcClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                 
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consulta de Tiempos Excedentes', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                             
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Consultas-5'                                                                                                                                                                                                                                                                                                                                                                                                                                              
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.ADMVBA.FConsTiemExcClass', 'icono pagina', @w_pa_id_parent, 2, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                           
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMVBA.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMVBA.Query', '4.0.0.1', 'http://[servername]/VBatch/ADMVBA.Query.Installer/ADMVBA.Query.Installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                               
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMVBA.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADMVBA.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMVBA.Query', 'COBISCorp.tCOBIS.ADMVBA.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                 
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMVBA.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMVBA.FConsTiemExc', 'FConsTiemExcClass', 'COBISCorp.tCOBIS.ADMVBA.Query', 'SV', '', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                     
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Consulta de Tiempos Excedentes') begin                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consulta de Tiempos Excedentes', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                             
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Consulta de Tiempos Excedentes'                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.ADMVBA.FErroresClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
print 'Registros para: PI.ADMVBA.FErroresClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
if not exists (select 1 from an_page where pa_name = 'PI.ADMVBA.FErroresClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consulta de Errores de Ejecución', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                           
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Consultas-5'                                                                                                                                                                                                                                                                                                                                                                                                                                              
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.ADMVBA.FErroresClass', 'icono pagina', @w_pa_id_parent, 3, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                               
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMVBA.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMVBA.Query', '4.0.0.1', 'http://[servername]/VBatch/ADMVBA.Query.Installer/ADMVBA.Query.Installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                               
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMVBA.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADMVBA.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMVBA.Query', 'COBISCorp.tCOBIS.ADMVBA.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                 
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMVBA.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMVBA.FErrores', 'FErroresClass', 'COBISCorp.tCOBIS.ADMVBA.Query', 'SV', '', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                             
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Consulta de Errores de Ejecución') begin                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consulta de Errores de Ejecución', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                           
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Consulta de Errores de Ejecución'                                                                                                                                                                                                                                                                                                                                                                                                                            
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
-- Registros para: PI.ADMVBA.FBuscaEstatusClass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
print 'Registros para: PI.ADMVBA.FBuscaEstatusClass'                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
if not exists (select 1 from an_page where pa_name = 'PI.ADMVBA.FBuscaEstatusClass') begin                                                                                                                                                                                                                                                                                                                                                                                                                                
declare @w_rol int, @w_la_cod varchar(10), @w_la_id int, @w_pa_id  int, @w_pa_id_parent int, @w_mg_id int, @w_mo_id int, @w_co_id int, @w_pz_id int                                                                                                                                                                                                                                                                                                                                                                              
select @w_rol = ro_rol from   ad_rol where  ro_descripcion = 'MENU POR PROCESOS'                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_la_cod = 'ES_EC'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consulta de Ejecución', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                      
select @w_pa_id  = isnull(max(pa_id), 0) + 1 from   an_page                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
select @w_pa_id_parent = pa_id from an_page where pa_name = 'PI.Consultas-5'                                                                                                                                                                                                                                                                                                                                                                                                                                              
insert into an_page (pa_id, pa_la_id, pa_name, pa_icon, pa_id_parent, pa_order, pa_splitter, pa_nemonic, pa_prod_name, pa_arguments, pa_he_id) 
values (@w_pa_id, @w_la_id, 'PI.ADMVBA.FBuscaEstatusClass', 'icono pagina', @w_pa_id_parent, 4, 'horizontal', 'Nemonic', 'M-ADMVBA', '', null)                                                                                                                                                                                                                                                                                                                                                          
insert into an_role_page values (@w_pa_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
if not exists (select 1 from an_zone where zo_id = 1) begin  insert into an_zone values (1, 'Zona 1', 1, 1, 1, 1)  end                                                                                                                                                                                                                                                                                                                                                                                                    
if not exists (select 1 from an_module_group where mg_name = 'ADMVBA.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                        
select @w_mg_id  = isnull(max(mg_id), 0) + 1 from   an_module_group                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
insert into an_module_group values (@w_mg_id, 'ADMVBA.Query', '4.0.0.1', 'http://[servername]/VBatch/ADMVBA.Query.Installer/ADMVBA.Query.Installer.application', 'COBISExplorer')                                                                                                                                                                                                                                                                                                                                               
end else select @w_mg_id = mg_id from an_module_group where mg_name = 'ADMVBA.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                      
if not exists (select 1 from an_module where mo_name = 'ADMVBA.Query') begin                                                                                                                                                                                                                                                                                                                                                                                                                                              
select @w_mo_id  = isnull(max(mo_id), 0) + 1 from   an_module                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_module values (@w_mo_id, @w_mg_id, @w_la_id, 'ADMVBA.Query', 'COBISCorp.tCOBIS.ADMVBA.Query.dll', 0, null)                                                                                                                                                                                                                                                                                                                                                                                                 
end else select @w_mo_id = mo_id from an_module where mo_name = 'ADMVBA.Query'                                                                                                                                                                                                                                                                                                                                                                                                                                            
if not exists (select 1 from an_role_module where rm_mo_id = @w_mo_id and rm_rol = @w_rol) insert into an_role_module values (@w_mo_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                    
select @w_co_id  = isnull(max(co_id), 0) + 1 from   an_component                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
insert into an_component values (@w_co_id, @w_mo_id, 'ADMVBA.FBuscaEstatus', 'FBuscaEstatusClass', 'COBISCorp.tCOBIS.ADMVBA.Query', 'SV', '', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                   
insert into an_role_component values (@w_co_id, @w_rol)                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
if not exists (select 1 from an_label where la_label = 'Consulta de Ejecución') begin                                                                                                                                                                                                                                                                                                                                                                                                                                     
select @w_la_id = isnull(max(la_id), 0) + 1 from   an_label                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
insert into an_label values (@w_la_id, @w_la_cod, 'Consulta de Ejecución', 'M-ADMVBA')                                                                                                                                                                                                                                                                                                                                                                                                                                      
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
else select @w_la_id = la_id from an_label where la_label = 'Consulta de Ejecución'                                                                                                                                                                                                                                                                                                                                                                                                                                       
select @w_pz_id = isnull(max(pz_id), 0) + 1 from   an_page_zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
if @w_pz_id is null select @w_pz_id = 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
if not exists (select 1 from an_page_zone where pz_pa_id = @w_pa_id and pz_co_id = @w_co_id) begin                                                                                                                                                                                                                                                                                                                                                                                                                        
insert into an_page_zone values (@w_pz_id, 1, @w_la_id, @w_pa_id, @w_co_id, 1, 100, 100,'Ninguno','horizontal',0,1,null)                                                                                                                                                                                                                                                                                                                                                                                                  
end                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end
go                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

/*******************************************************************/
/*  ASIGNACION DE DEPENDENCIAS ENTRE FUNCIONALIDADES DE VISUALBATCH*/
/*******************************************************************/
print '***  ASIGNACION DE DEPENDENCIAS ENTRE FUNCIONALIDADES DE VISUALBATCH'
go

declare @w_aux integer, @w_res integer, @w_sha integer, @w_adm integer, @w_sec integer, @w_exe integer, @w_que integer

select @w_aux = mo_id from an_module where mo_name like 'ADMVBA.Aux%'
select @w_res = mo_id from an_module where mo_name like 'ADMVBA.Resources%'
select @w_sha = mo_id from an_module where mo_name like 'ADMVBA.SharedLibrary%'
select @w_adm = mo_id from an_module where mo_name like 'ADMVBA.Administration%'
select @w_sec = mo_id from an_module where mo_name like 'ADMVBA.Security%'
select @w_exe = mo_id from an_module where mo_name like 'ADMVBA.Execution%'
select @w_que = mo_id from an_module where mo_name like 'ADMVBA.Query%'

insert into an_module_dependency values (@w_adm,@w_que)
insert into an_module_dependency values (@w_adm,@w_sha)
insert into an_module_dependency values (@w_que,@w_exe)
insert into an_module_dependency values (@w_que,@w_sec)
insert into an_module_dependency values (@w_exe,@w_sec)
insert into an_module_dependency values (@w_exe,@w_sha)
insert into an_module_dependency values (@w_sec,@w_sha)
--insert into an_module_dependency values (@w_sha,@w_res) --> Se creó al ejecutar: sp_cen_catalogar
--insert into an_module_dependency values (@w_res,@w_aux) --> Se creó al ejecutar: sp_cen_catalogar

go


/***************************************************************************/
/*        SCRIPT DE CATALOGACION DE SHAREDLIBRARY                          */
/***************************************************************************/
print 'SCRIPT DE CATALOGACION DE SHAREDLIBRARY'
go

use cobis
go

declare @w_return int,
	    @w_rol int

select @w_rol = ro_rol from ad_rol where ro_descripcion = 'MENU POR PROCESOS'

exec @w_return = sp_cen_catalogar
	@i_opcion               = 'COMP',
	@i_role                 = @w_rol,
	@i_prod_name            = 'M-ADMVBA',
	@i_module_group         = 'ADMVBA',
	@i_zone                 = 'Zona 1',
	@i_module               = 'ADMVBA.SharedLibrary',
	@i_label_module         = 'ADMVBA.SharedLibrary',
	@i_namespace_component  = 'COBISCorp.tCOBIS.ADMVBA.SharedLibrary',
	@i_name_component       = 'ADMVBA.grid_valores',
	@i_class_component      = 'grid_valoresClass'
    
	if @w_return <> 0
		print 'Error Creando COMP:grid_valoresClass'

exec @w_return = sp_cen_catalogar
	@i_opcion               = 'COMP',
	@i_role                 = @w_rol,
	@i_prod_name            = 'M-ADMVBA',
	@i_module_group         = 'ADMVBA.Aux',
	@i_zone                 = 'Zona 1',
	@i_module               = 'ADMVBA.Aux',
	@i_label_module         = 'ADMVBA.Aux',
	@i_namespace_component  = 'COBISCorp.tCOBIS.ADMVBA.Aux',
	@i_name_component       = 'ADMVBA.FImprimirClass',
	@i_class_component      = 'FImprimirClass'
    
	if @w_return <> 0
		print 'Error Creando COMP:grid_valoresClass'


exec @w_return = sp_cen_catalogar
	@i_opcion               = 'COMP',
	@i_role                 = @w_rol,
	@i_prod_name            = 'M-ADMVBA',
	@i_module_group         = 'ADMVBA.Aux',
	@i_zone                 = 'Zona 1',
	@i_module               = 'ADMVBA.Aux',
	@i_label_module         = 'ADMVBA.Aux',
	@i_namespace_component  = 'COBISCorp.tCOBIS.ADMVBA.Aux',
	@i_name_component       = 'ADMVBA.FPropiedadesClass',
	@i_class_component      = 'FPropiedadesClass'
    
	if @w_return <> 0
		print 'Error Creando COMP:grid_valoresClass'


--QUERY
--------------------------------------------------------------------------------------
-- PJA: 12 MAYO 2011
-- Funcionalidad esquema de almacenamiento para el registro de errores que se 
-- presenten durante la ejecución de los procesos batch. 
--------------------------------------------------------------------------------------

exec @w_return = sp_cen_catalogar
	@i_debug                = 'S',
	@i_opcion               = 'COMP',
	@i_role                 = @w_rol,
	@i_prod_name            = 'M-ADMVBA',
	@i_module_group         = 'ADMVBA',
	@i_zone                 = 'Zona 1',
	@i_module               = 'ADMVBA.Query',
	@i_label_module         = 'ADMVBA.Query',
	@i_namespace_component  = 'COBISCorp.tCOBIS.ADMVBA.Query',
	@i_name_component       = 'ADMVBA.FErrProc',
	@i_class_component      = 'FErrProcClass'
	if @w_return <> 0
		print 'Error Creando COMP:FErrProcClass'

--SECURITY

--------------------------------------------------------------------------------------
-- PJA: 12 MAYO 2011
-- Funcionalidad esquema de almacenamiento para el registro de errores que se 
-- presenten durante la ejecución de los procesos batch. 
--------------------------------------------------------------------------------------

--exec @w_return = sp_cen_catalogar
--	@i_debug                = 'S',
--	@i_opcion               = 'COMP',
--	@i_role                 = @w_rol,
--	@i_prod_name            = 'M-ADMVBA',
--	@i_module_group         = 'ADMVBA',
--	@i_zone                 = 'Zona 1',
--	@i_module               = 'ADMVBA.Security',
--	@i_label_module         = 'ADMVBA.Security',
--	@i_namespace_component  = 'COBISCorp.tCOBIS.ADMVBA.Security',
--	@i_name_component       = 'ADMVBA.FSeguridadVB',
--	@i_class_component      = 'FSeguridadVBClass'
--	if @w_return <> 0
--		print 'Error Creando COMP:FSeguridadVBClass'

--MENU

--------------------------------------------------------------------------------------
-- PJA: 12 MAYO 2011
-- Funcionalidad esquema de almacenamiento para el registro de errores que se 
-- presenten durante la ejecución de los procesos batch. 
--------------------------------------------------------------------------------------

--************************INSERCION DE LA PAGINA:  AUTORIZACION PARA LA LECTURA DE  REPORTES ***********************
-- exec @w_return = sp_cen_catalogar
--	@i_debug                = 'S',
-- 	@i_opcion               = 'PAGE',
-- 	@i_role                 = @w_rol,
-- 	@i_prod_name            = 'M-ADMVBA',
-- 	@i_module_group         = 'ADMVBA',
-- 	@i_zone                 = 'Zona 1',
-- 	@i_module               = 'ADMVBA.Security',
-- 	@i_label_module         = 'ADMVBA.Security',
-- 	@i_namespace_component  = 'COBISCorp.tCOBIS.ADMVBA.Security',
-- 	@i_page                 = 'ADMVBA.FSeguridadVBClass',
-- 	@i_label_page           = 'Autorización para la Lectura de Reportes',
-- 	@i_parent_page          = 'PI.Mantenimiento'
-- 	if @w_return <> 0
-- 		print 'Error Creando PAGE: Autorizacion para la Lectura de  Reportes'
--Create an_page_zone
--exec @w_return = sp_cen_catalogar
--	@i_debug                = 'S',
--	@i_opcion               = 'PAGZONE',
--	@i_role                 = @w_rol,
--	@i_prod_name            = 'M-ADMVBA',
--	@i_module_group         = 'ADMVBA',
--	@i_zone                 = 'Zona 1',
--	@i_module               = 'ADMVBA.Security',
--	@i_label_module         = 'ADMVBA.Security',
--	@i_namespace_component  = 'COBISCorp.tCOBIS.ADMVBA.Security',
--	@i_page                 = 'ADMVBA.FSeguridadVBClass',
--	@i_label_page           = 'Autorización para la Lectura de Reportes',
--	@i_parent_page          = 'PI.Mantenimiento',
--	@i_name_component       = 'ADMVBA.FSeguridadVB',
--	@i_class_component      = 'FSeguridadVBClass'
--	if @w_return <> 0
--		print 'Error Creando PAGZONE:Autorizacion para la Lectura de  Reportes'


--************** INSERCION DE LA PAGINA:  CONSULTA DE ERRORES DE PROCESAMIENTO ********
--------------------------------------------------------------------------------------
-- PJA: 12 MAYO 2011
-- Funcionalidad esquema de almacenamiento para el registro de errores que se 
-- presenten durante la ejecución de los procesos batch. 
--------------------------------------------------------------------------------------

exec @w_return = sp_cen_catalogar
	@i_debug                = 'S',
	@i_opcion               = 'PAGE',
	@i_role                 = @w_rol,
	@i_prod_name            = 'M-ADMVBA',
	@i_module_group         = 'ADMVBA',
	@i_zone                 = 'Zona 1',
	@i_module               = 'ADMVBA.Query',
	@i_label_module         = 'ADMVBA.Query',
	@i_namespace_component  = 'COBISCorp.tCOBIS.ADMVBA.Query',
	@i_page                 = 'ADMVBA.FErrProcClass',
	@i_label_page           = 'Consulta de Errores de Procesamiento',
	@i_parent_page          = 'PI.Consultas-5'
	if @w_return <> 0
		print 'Error Creando PAGE:Consulta de Errores de Procesamiento'
--Create an_page_zone
exec @w_return = sp_cen_catalogar
	@i_debug                = 'S',
	@i_opcion               = 'PAGZONE',
	@i_role                 = @w_rol,
	@i_prod_name            = 'M-ADMVBA',
	@i_module_group         = 'ADMVBA',
	@i_zone                 = 'Zona 1',
	@i_module               = 'ADMVBA.Query',
	@i_label_module         = 'ADMVBA.Query',
	@i_namespace_component  = 'COBISCorp.tCOBIS.ADMVBA.Query',
	@i_page                 = 'ADMVBA.FErrProcClass',
	@i_label_page           = 'Consulta de Errores de Procesamiento',
	@i_parent_page          = 'ADMVBA.Consultas',
	@i_name_component       = 'ADMVBA.FErrProc',
	@i_class_component      = 'FErrProcClass'
	if @w_return <> 0
		print 'Error Creando PAGZONE:Consulta de Errores de Procesamiento'
go


/***************************************************************************/
/*  ASIGNACION DE TRANSACCIONES DESDE EL ROL OPERADOR DE BATCH COBIS       */
/*  AL ROL MENU POR PROCESOS                                               */
/***************************************************************************/
print '***  ad_tr_autorizada .....(Asignacion de transacciones a MENU POR PROCESOS)'
go

declare @w_rol_destino int, @w_rol_origen int

select @w_rol_origen = ro_rol
from ad_rol
where ro_descripcion = 'OPERADOR DE BATCH COBIS' and
      ro_filial = 1

select @w_rol_destino = ro_rol
from ad_rol
where ro_descripcion = 'MENU POR PROCESOS' and
      ro_filial = 1

print 'Eliminacion de transacciones autorizadas de Vbatch a rol MENU POR PROCESOS'
delete ad_tr_autorizada
where ta_rol = @w_rol_destino
and ta_transaccion in (select ta_transaccion from ad_tr_autorizada where ta_rol = @w_rol_origen)

print 'Asignacion de transacciones autorizadas de Contabilidad desde el rol Operador de Batch al rol MENU POR PROCESOS'
insert into ad_tr_autorizada 
  select ta_producto, ta_tipo, ta_moneda, ta_transaccion, @w_rol_destino, getdate(), 
         1, ta_estado, getdate()
  from ad_tr_autorizada
  where ta_rol = @w_rol_origen
  and ta_transaccion not in (
     select ta_transaccion from ad_tr_autorizada where ta_rol = @w_rol_destino
  )
go

/***************************************************************************/
/*  ASIGNACION DE TRANSACCIONES DESDE EL ROL SUPERVISOR DE BATCH COBIS     */
/*  AL ROL MENU POR PROCESOS                                               */
/***************************************************************************/
print '***  ad_tr_autorizada .....(Asignacion de transacciones a MENU POR PROCESOS)'
go

declare @w_rol_destino int, @w_rol_origen int

select @w_rol_origen = ro_rol
from ad_rol
where ro_descripcion = 'SUPERVISOR DE BATCH COBIS' and
      ro_filial = 1

select @w_rol_destino = ro_rol
from ad_rol
where ro_descripcion = 'MENU POR PROCESOS' and
      ro_filial = 1

print 'Eliminacion de transacciones autorizadas de Vbatch a rol MENU POR PROCESOS'
delete ad_tr_autorizada
where ta_rol = @w_rol_destino
and ta_transaccion in (select ta_transaccion from ad_tr_autorizada where ta_rol = @w_rol_origen)

print 'Asignacion de transacciones autorizadas de Contabilidad desde el rol Supervisor de Batch al rol MENU POR PROCESOS'
insert into ad_tr_autorizada 
  select ta_producto, ta_tipo, ta_moneda, ta_transaccion, @w_rol_destino, getdate(), 
         1, ta_estado, getdate()
  from ad_tr_autorizada
  where ta_rol = @w_rol_origen
  and ta_transaccion not in (
     select ta_transaccion from ad_tr_autorizada where ta_rol = @w_rol_destino
  )
go

/***************************************************************************/
/*  ASIGNACION DE TRANSACCIONES DESDE EL ROL SUPERVISOR DE BATCH COBIS     */
/*  AL ROL MENU POR PROCESOS                                               */
/***************************************************************************/
print '***  ad_tr_autorizada .....(Asignacion de transacciones a MENU POR PROCESOS)'
go

declare @w_rol_destino int, @w_rol_origen int

select @w_rol_origen = ro_rol
from ad_rol
where ro_descripcion = 'LECTURA DE REPORTES DE BATCH COBIS' and
      ro_filial = 1

select @w_rol_destino = ro_rol
from ad_rol
where ro_descripcion = 'MENU POR PROCESOS' and
      ro_filial = 1

print 'Eliminacion de transacciones autorizadas de Vbatch a rol MENU POR PROCESOS'
delete ad_tr_autorizada
where ta_rol = @w_rol_destino
and ta_transaccion in (select ta_transaccion from ad_tr_autorizada where ta_rol = @w_rol_origen)

print 'Asignacion de transacciones autorizadas de Contabilidad desde el rol Lectura de Batch al rol MENU POR PROCESOS'
insert into ad_tr_autorizada 
  select ta_producto, ta_tipo, ta_moneda, ta_transaccion, @w_rol_destino, getdate(), 
         1, ta_estado, getdate()
  from ad_tr_autorizada
  where ta_rol = @w_rol_origen
  and ta_transaccion not in (
     select ta_transaccion from ad_tr_autorizada where ta_rol = @w_rol_destino
  )
go

